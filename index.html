<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fraudshield Pro - Fraud Detection & Case Management</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.1.0/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- Three.js for 3D Visualization -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.min.js"></script>
    <style>
      :root {
        --primary: #000000;
        --secondary: #333333;
        --accent: #555555;
        --dark: #111111;
        --light: #ffffff;
        --gray-light: #f5f5f5;
        --gray-medium: #cccccc;
        --gray-dark: #666666;
        --success: #4caf50;
        --warning: #ff9800;
        --error: #f44336;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --chatbot-primary: #1a1a1a;
        --chatbot-secondary: #333333;
        --chatbot-accent: #555555;
        --chatbot-bg: rgba(0, 0, 0, 0.9);
        --glass-bg: rgba(255, 255, 255, 0.05);
        --glass-border: rgba(255, 255, 255, 0.1);
        --glow-color: rgba(255, 255, 255, 0.5);
        --glow-intensity: 0 0 15px rgba(255, 255, 255, 0.3);
      }

      /* Light Theme Variables */
      [data-theme="light"] {
        --primary: #ffffff;
        --secondary: #f0f0f0;
        --accent: #e0e0e0;
        --dark: #333333;
        --light: #000000;
        --gray-light: #333333;
        --gray-medium: #666666;
        --gray-dark: #999999;
        --chatbot-primary: #f0f0f0;
        --chatbot-secondary: #e0e0e0;
        --chatbot-accent: #d0d0d0;
        --chatbot-bg: rgba(255, 255, 255, 0.95);
        --glass-bg: rgba(0, 0, 0, 0.05);
        --glass-border: rgba(0, 0, 0, 0.1);
        --glow-color: rgba(0, 0, 0, 0.5);
        --glow-intensity: 0 0 15px rgba(0, 0, 0, 0.3);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Roboto", sans-serif;
        background: linear-gradient(135deg, var(--dark), var(--secondary));
        color: var(--light);
        min-height: 100vh;
        line-height: 1.6;
        position: relative;
        overflow-x: hidden;
        transition: var(--transition);
      }

      /* Light Theme Body */
      [data-theme="light"] body {
        background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
      }

      .container {
        max-width: 1400px;
        width: 100%;
        margin: 0 auto;
        padding: 0 15px;
      }

      /* Header Styles */
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        margin-bottom: 20px;
        position: sticky;
        top: 0;
        z-index: 1000;
        transition: var(--transition);
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(15px);
        border-radius: 15px;
        padding: 12px 15px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      }

      /* Light Theme Header */
      [data-theme="light"] header {
        background: rgba(255, 255, 255, 0.8);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      header.scrolled {
        background: rgba(0, 0, 0, 0.95);
        backdrop-filter: blur(20px);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
      }

      /* Light Theme Scrolled Header */
      [data-theme="light"] header.scrolled {
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-icon {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        transition: var(--transition);
      }

      /* Light Theme Logo Icon */
      [data-theme="light"] .logo-icon {
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .logo-icon:hover {
        transform: rotate(10deg) scale(1.1);
        box-shadow: var(--glow-intensity);
      }

      .logo-text {
        font-family: "Montserrat", sans-serif;
        font-weight: 700;
      }

      .logo-text h1 {
        font-size: 1.2rem;
        background: linear-gradient(to right, #fff, var(--gray-medium));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        letter-spacing: -0.5px;
      }

      /* Light Theme Logo Text */
      [data-theme="light"] .logo-text h1 {
        background: linear-gradient(to right, #000, var(--gray-medium));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .logo-text p {
        font-size: 0.7rem;
        color: rgba(255, 255, 255, 0.7);
        margin-top: 2px;
      }

      /* Light Theme Logo Subtitle */
      [data-theme="light"] .logo-text p {
        color: rgba(0, 0, 0, 0.7);
      }

      nav {
        display: flex;
        align-items: center;
      }

      .menu-toggle {
        display: flex;
        background: none;
        border: none;
        color: white;
        font-size: 1.3rem;
        cursor: pointer;
        transition: var(--transition);
        position: relative;
        width: 28px;
        height: 28px;
      }

      /* Light Theme Menu Toggle */
      [data-theme="light"] .menu-toggle {
        color: black;
      }

      .menu-toggle span {
        display: block;
        position: absolute;
        height: 3px;
        width: 100%;
        background: white;
        border-radius: 3px;
        opacity: 1;
        left: 0;
        transform: rotate(0deg);
        transition: 0.25s ease-in-out;
      }

      /* Light Theme Menu Toggle Span */
      [data-theme="light"] .menu-toggle span {
        background: black;
      }

      .menu-toggle span:nth-child(1) {
        top: 4px;
      }

      .menu-toggle span:nth-child(2) {
        top: 12px;
      }

      .menu-toggle span:nth-child(3) {
        top: 20px;
      }

      .menu-toggle.open span:nth-child(1) {
        top: 12px;
        transform: rotate(135deg);
      }

      .menu-toggle.open span:nth-child(2) {
        opacity: 0;
        left: -60px;
      }

      .menu-toggle.open span:nth-child(3) {
        top: 12px;
        transform: rotate(-135deg);
      }

      .menu-toggle:hover {
        transform: scale(1.1);
      }

      nav ul {
        display: none;
      }

      /* Mobile Menu */
      .mobile-menu {
        position: fixed;
        top: 0;
        right: -300px;
        width: 280px;
        height: 100vh;
        background: rgba(26, 32, 46, 0.98);
        backdrop-filter: blur(10px);
        z-index: 9999;
        transition: right 0.3s ease;
        padding: 70px 15px 15px;
        overflow-y: auto;
        box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
      }

      /* Light Theme Mobile Menu */
      [data-theme="light"] .mobile-menu {
        background: rgba(255, 255, 255, 0.98);
        box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
      }

      .mobile-menu.active {
        right: 0;
      }

      .mobile-menu-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Mobile Menu Header */
      [data-theme="light"] .mobile-menu-header {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .mobile-menu-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--gray-medium);
      }

      .close-mobile-menu {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.7);
        font-size: 1.3rem;
        cursor: pointer;
        transition: var(--transition);
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
      }

      /* Light Theme Close Mobile Menu */
      [data-theme="light"] .close-mobile-menu {
        color: rgba(0, 0, 0, 0.7);
      }

      .close-mobile-menu:hover {
        color: white;
        background: rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Close Mobile Menu Hover */
      [data-theme="light"] .close-mobile-menu:hover {
        color: black;
        background: rgba(0, 0, 0, 0.1);
      }

      .mobile-menu ul {
        display: flex;
        flex-direction: column;
        gap: 5px;
        list-style: none;
      }

      .mobile-menu li {
        margin-bottom: 5px;
      }

      .mobile-menu a {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 15px;
        color: rgba(255, 255, 255, 0.85);
        text-decoration: none;
        font-weight: 500;
        font-size: 0.9rem;
        border-radius: 10px;
        transition: var(--transition);
      }

      /* Light Theme Mobile Menu Links */
      [data-theme="light"] .mobile-menu a {
        color: rgba(0, 0, 0, 0.85);
      }

      .mobile-menu a:hover {
        background: rgba(255, 255, 255, 0.1);
        color: white;
      }

      /* Light Theme Mobile Menu Links Hover */
      [data-theme="light"] .mobile-menu a:hover {
        background: rgba(0, 0, 0, 0.1);
        color: black;
      }

      .mobile-menu a i {
        width: 20px;
        text-align: center;
      }

      .mobile-menu-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 9998;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
      }

      .mobile-menu-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      /* Hero Section */
      .hero {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 40px;
        align-items: center;
      }

      .hero-content {
        flex: 1;
        padding: 10px 0;
        animation: fadeInUp 0.8s ease-out;
        text-align: center;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .hero h2 {
        font-family: "Montserrat", sans-serif;
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 15px;
        line-height: 1.2;
      }

      .hero h2 span {
        background: linear-gradient(
          to right,
          var(--gray-medium),
          var(--gray-light)
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      /* Light Theme Hero Title */
      [data-theme="light"] .hero h2 span {
        background: linear-gradient(to right, #333, #000);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .hero p {
        font-size: 1rem;
        max-width: 100%;
        margin-bottom: 20px;
        color: rgba(255, 255, 255, 0.9);
      }

      /* Light Theme Hero Text */
      [data-theme="light"] .hero p {
        color: rgba(0, 0, 0, 0.9);
      }

      .stats {
        display: flex;
        gap: 10px;
        margin-top: 20px;
        flex-wrap: wrap;
        justify-content: center;
      }

      .stat-item {
        background: rgba(255, 255, 255, 0.08);
        padding: 15px;
        border-radius: 12px;
        text-align: center;
        flex: 1;
        min-width: 100px;
        backdrop-filter: blur(5px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
        cursor: pointer;
      }

      /* Light Theme Stat Item */
      [data-theme="light"] .stat-item {
        background: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .stat-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        background: rgba(255, 255, 255, 0.12);
      }

      /* Light Theme Stat Item Hover */
      [data-theme="light"] .stat-item:hover {
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        background: rgba(0, 0, 0, 0.08);
      }

      .stat-item .number {
        font-family: "Montserrat", sans-serif;
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 5px;
        background: linear-gradient(to right, #fff, var(--gray-medium));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      /* Light Theme Stat Number */
      [data-theme="light"] .stat-item .number {
        background: linear-gradient(to right, #000, var(--gray-medium));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .stat-item .label {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Stat Label */
      [data-theme="light"] .stat-item .label {
        color: rgba(0, 0, 0, 0.7);
      }

      .hero-image {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: fadeIn 1s ease-out 0.3s both;
        width: 100%;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .dashboard-img {
        width: 100%;
        max-width: 400px;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 15px;
        padding: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
      }

      /* Light Theme Dashboard Image */
      [data-theme="light"] .dashboard-img {
        background: rgba(255, 255, 255, 0.6);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .dashboard-img:hover {
        transform: scale(1.02);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
      }

      /* Light Theme Dashboard Image Hover */
      [data-theme="light"] .dashboard-img:hover {
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      }

      /* Main Content */
      .content-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 40px;
      }

      .card {
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
      }

      /* Light Theme Card */
      [data-theme="light"] .card {
        background: rgba(255, 255, 255, 0.6);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        border-color: rgba(255, 255, 255, 0.2);
      }

      /* Light Theme Card Hover */
      [data-theme="light"] .card:hover {
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        border-color: rgba(0, 0, 0, 0.2);
      }

      .form-container {
        flex: 1;
      }

      .results-container {
        flex: 1;
      }

      .card h3 {
        font-family: "Montserrat", sans-serif;
        font-size: 1.3rem;
        margin-bottom: 15px;
        color: var(--gray-medium);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .card h3 i {
        font-size: 1.2rem;
      }

      .form-group {
        margin-bottom: 15px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.85);
        font-size: 0.9rem;
      }

      /* Light Theme Label */
      [data-theme="light"] label {
        color: rgba(0, 0, 0, 0.85);
      }

      .file-input-container {
        position: relative;
      }

      .file-input-container input {
        width: 100%;
        padding: 12px;
        background: rgba(50, 50, 50, 0.5);
        border: 2px dashed rgba(200, 200, 200, 0.3);
        border-radius: 10px;
        color: #fff;
        font-size: 0.9rem;
        outline: none;
        transition: var(--transition);
      }

      /* Light Theme File Input */
      [data-theme="light"] .file-input-container input {
        background: rgba(200, 200, 200, 0.5);
        border: 2px dashed rgba(50, 50, 50, 0.3);
        color: #000;
      }

      .file-input-container input:focus {
        border-color: var(--gray-medium);
        box-shadow: 0 0 0 3px rgba(200, 200, 200, 0.2);
        background: rgba(50, 50, 50, 0.7);
      }

      /* Light Theme File Input Focus */
      [data-theme="light"] .file-input-container input:focus {
        border-color: var(--gray-medium);
        box-shadow: 0 0 0 3px rgba(50, 50, 50, 0.2);
        background: rgba(200, 200, 200, 0.7);
      }

      .file-input-container::after {
        content: "Browse";
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        background: var(--gray-medium);
        color: var(--dark);
        padding: 6px 12px;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.8rem;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Light Theme Browse Button */
      [data-theme="light"] .file-input-container::after {
        background: var(--gray-medium);
        color: var(--light);
      }

      .file-input-container:hover::after {
        background: var(--gray-dark);
      }

      button {
        width: 100%;
        padding: 14px;
        background: linear-gradient(
          135deg,
          var(--gray-medium),
          var(--gray-dark)
        );
        border: none;
        border-radius: 10px;
        color: var(--light);
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        box-shadow: 0 4px 15px rgba(100, 100, 100, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        font-family: "Montserrat", sans-serif;
        position: relative;
        overflow: hidden;
      }

      /* Light Theme Button */
      [data-theme="light"] button {
        background: linear-gradient(135deg, #666, #333);
        color: var(--light);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      button:hover::before {
        left: 100%;
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(100, 100, 100, 0.4);
      }

      /* Light Theme Button Hover */
      [data-theme="light"] button:hover {
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      button:active {
        transform: translateY(-1px);
      }

      button i {
        font-size: 1.1rem;
      }

      .info-box {
        background: rgba(50, 50, 50, 0.4);
        border-left: 4px solid var(--gray-medium);
        padding: 15px;
        border-radius: 0 10px 10px 0;
        margin-top: 20px;
      }

      /* Light Theme Info Box */
      [data-theme="light"] .info-box {
        background: rgba(200, 200, 200, 0.4);
        border-left: 4px solid var(--gray-medium);
      }

      .info-box h4 {
        font-size: 1.1rem;
        margin-bottom: 10px;
        color: var(--gray-medium);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .info-box ul {
        padding-left: 20px;
      }

      .info-box li {
        margin-bottom: 8px;
        position: relative;
        padding-left: 20px;
        color: rgba(255, 255, 255, 0.85);
        font-size: 0.9rem;
      }

      /* Light Theme Info Box List Items */
      [data-theme="light"] .info-box li {
        color: rgba(0, 0, 0, 0.85);
      }

      .info-box li:before {
        content: "â€¢";
        color: var(--gray-medium);
        font-size: 1.2rem;
        position: absolute;
        left: 0;
        top: -5px;
      }

      .results-content {
        background: rgba(50, 50, 50, 0.5);
        border-radius: 15px;
        padding: 20px;
        min-height: 300px;
        display: flex;
        flex-direction: column;
        border: 1px dashed rgba(200, 200, 200, 0.2);
      }

      /* Light Theme Results Content */
      [data-theme="light"] .results-content {
        background: rgba(200, 200, 200, 0.5);
        border: 1px dashed rgba(50, 50, 50, 0.2);
      }

      .results-placeholder {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        flex: 1;
        padding: 20px;
      }

      .results-placeholder i {
        font-size: 3rem;
        color: rgba(200, 200, 200, 0.2);
        margin-bottom: 15px;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 0.2;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.3;
        }
      }

      .results-text {
        color: rgba(255, 255, 255, 0.85);
        max-width: 100%;
        line-height: 1.5;
        font-size: 0.9rem;
      }

      /* Light Theme Results Text */
      [data-theme="light"] .results-text {
        color: rgba(0, 0, 0, 0.85);
      }

      .progress-container {
        width: 100%;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        height: 10px;
        margin: 15px 0;
        overflow: hidden;
        display: none;
      }

      /* Light Theme Progress Container */
      [data-theme="light"] .progress-container {
        background: rgba(0, 0, 0, 0.1);
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--gray-medium), var(--primary));
        width: 0%;
        transition: width 0.5s ease;
        position: relative;
        overflow: hidden;
      }

      .progress-bar::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      /* Download Button */
      .download-section {
        margin-top: 20px;
        text-align: center;
      }

      .download-btn {
        background: linear-gradient(
          135deg,
          var(--gray-medium),
          var(--gray-dark)
        );
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 30px;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 4px 15px rgba(100, 100, 100, 0.3);
        position: relative;
        overflow: hidden;
      }

      /* Light Theme Download Button */
      [data-theme="light"] .download-btn {
        background: linear-gradient(135deg, #666, #333);
        color: white;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .download-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .download-btn:hover::before {
        left: 100%;
      }

      .download-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(100, 100, 100, 0.4);
      }

      /* Light Theme Download Button Hover */
      [data-theme="light"] .download-btn:hover {
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      .download-btn:active {
        transform: translateY(-1px);
      }

      .download-btn i {
        font-size: 1.1rem;
      }

      /* Download Options Dropdown */
      .download-options {
        position: relative;
        display: inline-block;
      }

      .download-dropdown {
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(30, 30, 30, 0.95);
        border-radius: 10px;
        padding: 10px 0;
        min-width: 180px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s, visibility 0.3s;
        margin-top: 10px;
      }

      /* Light Theme Download Dropdown */
      [data-theme="light"] .download-dropdown {
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      }

      .download-options.active .download-dropdown {
        opacity: 1;
        visibility: visible;
      }

      .download-option {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 20px;
        color: rgba(255, 255, 255, 0.9);
        text-decoration: none;
        font-size: 0.9rem;
        transition: background 0.2s;
      }

      /* Light Theme Download Option */
      [data-theme="light"] .download-option {
        color: rgba(0, 0, 0, 0.9);
      }

      .download-option:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Download Option Hover */
      [data-theme="light"] .download-option:hover {
        background: rgba(0, 0, 0, 0.1);
      }

      .download-option i {
        width: 20px;
        text-align: center;
      }

      /* Location Button Styles */
      .location-section {
        margin-top: 20px;
        text-align: center;
      }

      .location-btn {
        background: linear-gradient(
          135deg,
          var(--gray-medium),
          var(--gray-dark)
        );
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 30px;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 4px 15px rgba(100, 100, 100, 0.3);
        position: relative;
        overflow: hidden;
      }

      /* Light Theme Location Button */
      [data-theme="light"] .location-btn {
        background: linear-gradient(135deg, #666, #333);
        color: white;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .location-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .location-btn:hover::before {
        left: 100%;
      }

      .location-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(100, 100, 100, 0.4);
      }

      /* Light Theme Location Button Hover */
      [data-theme="light"] .location-btn:hover {
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      .location-btn:active {
        transform: translateY(-1px);
      }

      .location-btn i {
        font-size: 1.1rem;
      }

      /* Location Modal */
      .location-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 10000;
        justify-content: center;
        align-items: center;
      }

      .location-modal.active {
        display: flex;
      }

      .location-content {
        background: rgba(30, 30, 30, 0.95);
        border-radius: 15px;
        padding: 30px;
        width: 90%;
        max-width: 800px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Location Content */
      [data-theme="light"] .location-content {
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .location-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Location Header */
      [data-theme="light"] .location-header {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .location-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.5rem;
        color: var(--gray-medium);
      }

      .location-close {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.7);
        font-size: 1.5rem;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Light Theme Location Close */
      [data-theme="light"] .location-close {
        color: rgba(0, 0, 0, 0.7);
      }

      .location-close:hover {
        color: white;
      }

      /* Light Theme Location Close Hover */
      [data-theme="light"] .location-close:hover {
        color: black;
      }

      .location-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .location-card {
        background: rgba(50, 50, 50, 0.3);
        border-radius: 10px;
        padding: 15px;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Light Theme Location Card */
      [data-theme="light"] .location-card {
        background: rgba(200, 200, 200, 0.3);
      }

      .location-card:hover {
        transform: translateY(-5px);
        background: rgba(50, 50, 50, 0.5);
      }

      /* Light Theme Location Card Hover */
      [data-theme="light"] .location-card:hover {
        background: rgba(200, 200, 200, 0.5);
      }

      .location-name {
        font-weight: 600;
        margin-bottom: 10px;
        color: var(--gray-medium);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .location-stats {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .location-stat {
        display: flex;
        justify-content: space-between;
        font-size: 0.9rem;
      }

      .location-stat-label {
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Location Stat Label */
      [data-theme="light"] .location-stat-label {
        color: rgba(0, 0, 0, 0.7);
      }

      .location-stat-value {
        font-weight: 600;
      }

      .location-transactions {
        margin-top: 20px;
      }

      .location-transactions-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.2rem;
        margin-bottom: 15px;
        color: var(--gray-medium);
      }

      .location-transactions-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      .location-transactions-table th,
      .location-transactions-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Location Transactions Table Borders */
      [data-theme="light"] .location-transactions-table th,
      [data-theme="light"] .location-transactions-table td {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .location-transactions-table th {
        font-weight: 600;
        color: var(--gray-medium);
        font-size: 0.9rem;
      }

      .location-transactions-table td {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
      }

      /* Light Theme Location Transactions Table Text */
      [data-theme="light"] .location-transactions-table td {
        color: rgba(0, 0, 0, 0.8);
      }

      .location-transactions-table tr:hover {
        background: rgba(255, 255, 255, 0.05);
      }

      /* Light Theme Location Transactions Table Row Hover */
      [data-theme="light"] .location-transactions-table tr:hover {
        background: rgba(0, 0, 0, 0.05);
      }

      .status-badge {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        display: inline-block;
      }

      .status-fraud {
        background: rgba(244, 67, 54, 0.2);
        color: var(--error);
      }

      .status-suspicious {
        background: rgba(255, 152, 0, 0.2);
        color: var(--warning);
      }

      .status-legitimate {
        background: rgba(76, 175, 80, 0.2);
        color: var(--success);
      }

      /* Charts Section */
      .charts-container {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-bottom: 15px;
      }

      .chart-wrapper {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        transition: var(--transition);
      }

      /* Light Theme Chart Wrapper */
      [data-theme="light"] .chart-wrapper {
        background: rgba(0, 0, 0, 0.05);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .chart-wrapper:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      }

      /* Light Theme Chart Wrapper Hover */
      [data-theme="light"] .chart-wrapper:hover {
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .chart-title {
        text-align: center;
        margin-bottom: 10px;
        font-weight: 600;
        color: var(--gray-medium);
        font-size: 0.9rem;
      }

      .chart-container {
        position: relative;
        height: 200px;
        width: 100%;
      }

      .summary-stat-container {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
        flex-wrap: wrap;
      }

      .summary-stat-item {
        flex: 1;
        min-width: 100px;
        text-align: center;
        padding: 12px;
        border-radius: 8px;
        transition: var(--transition);
        cursor: pointer;
      }

      .summary-stat-item:hover {
        transform: scale(1.05);
      }

      .summary-stat-item.legitimate {
        background: rgba(76, 175, 80, 0.1);
      }

      .summary-stat-item.suspicious {
        background: rgba(255, 152, 0, 0.1);
      }

      .summary-stat-item.fraud {
        background: rgba(244, 67, 54, 0.1);
      }

      .summary-stat-item .count {
        font-size: 1.4rem;
        font-weight: 700;
      }

      .summary-stat-item .count.legitimate {
        color: var(--success);
      }
      .summary-stat-item .count.suspicious {
        color: var(--warning);
      }

      .summary-stat-item .count.fraud {
        color: var(--error);
      }

      .summary-stat-item .label {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.8rem;
      }

      /* Light Theme Summary Stat Label */
      [data-theme="light"] .summary-stat-item .label {
        color: rgba(0, 0, 0, 0.8);
      }

      /* Features Section */
      .features {
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
        margin-bottom: 40px;
      }

      .feature-card {
        background: rgba(0, 0, 0, 0.6);
        border-radius: 12px;
        padding: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        gap: 15px;
        transition: var(--transition);
        cursor: pointer;
      }

      /* Light Theme Feature Card */
      [data-theme="light"] .feature-card {
        background: rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .feature-card:hover {
        transform: translateY(-5px);
        border-color: rgba(255, 255, 255, 0.2);
        background: rgba(0, 0, 0, 0.7);
      }

      /* Light Theme Feature Card Hover */
      [data-theme="light"] .feature-card:hover {
        border-color: rgba(0, 0, 0, 0.2);
        background: rgba(255, 255, 255, 0.7);
      }

      .feature-icon {
        min-width: 40px;
        height: 40px;
        background: rgba(200, 200, 200, 0.1);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.3rem;
        color: var(--gray-medium);
        transition: var(--transition);
      }

      .feature-card:hover .feature-icon {
        transform: scale(1.1);
        background: rgba(200, 200, 200, 0.2);
      }

      .feature-content h4 {
        font-family: "Montserrat", sans-serif;
        font-size: 1.1rem;
        margin-bottom: 8px;
        color: #fff;
      }

      /* Light Theme Feature Content Title */
      [data-theme="light"] .feature-content h4 {
        color: #000;
      }

      .feature-content p {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
      }

      /* Light Theme Feature Content Text */
      [data-theme="light"] .feature-content p {
        color: rgba(0, 0, 0, 0.8);
      }

      /* Footer */
      footer {
        background: rgba(0, 0, 0, 0.8);
        border-radius: 15px;
        padding: 25px 15px;
        text-align: center;
        margin-top: 15px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Footer */
      [data-theme="light"] footer {
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .footer-content {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 20px;
        text-align: center;
      }

      .footer-section {
        flex: 1;
      }

      .footer-section h4 {
        font-family: "Montserrat", sans-serif;
        font-size: 1.1rem;
        margin-bottom: 15px;
        color: var(--gray-medium);
      }

      .footer-section p {
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 10px;
        font-size: 0.9rem;
      }

      /* Light Theme Footer Text */
      [data-theme="light"] .footer-section p {
        color: rgba(0, 0, 0, 0.7);
      }

      .social-links {
        display: flex;
        gap: 12px;
        margin-top: 15px;
        justify-content: center;
      }

      .social-links a {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 36px;
        height: 36px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        color: #fff;
        font-size: 1.1rem;
        transition: var(--transition);
      }

      /* Light Theme Social Links */
      [data-theme="light"] .social-links a {
        background: rgba(0, 0, 0, 0.1);
        color: #000;
      }

      .social-links a:hover {
        background: var(--gray-medium);
        color: var(--dark);
        transform: translateY(-3px);
      }

      .copyright {
        padding-top: 15px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.6);
        font-size: 0.8rem;
      }

      /* Light Theme Copyright */
      [data-theme="light"] .copyright {
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        color: rgba(0, 0, 0, 0.6);
      }

      /* Dashboard Page Styles */
      .dashboard-page {
        display: none;
        min-height: 100vh;
        padding: 20px 0;
      }

      .dashboard-page.active {
        display: block;
      }

      .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
        gap: 15px;
      }

      .dashboard-title {
        font-family: "Montserrat", sans-serif;
        font-size: 2rem;
        color: var(--gray-medium);
      }

      .dashboard-controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .dashboard-btn {
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        color: white;
        font-size: 0.9rem;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      /* Light Theme Dashboard Button */
      [data-theme="light"] .dashboard-btn {
        background: rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.2);
        color: black;
      }

      .dashboard-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }

      /* Light Theme Dashboard Button Hover */
      [data-theme="light"] .dashboard-btn:hover {
        background: rgba(0, 0, 0, 0.2);
      }

      .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .dashboard-card {
        background: rgba(0, 0, 0, 0.6);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
      }

      /* Light Theme Dashboard Card */
      [data-theme="light"] .dashboard-card {
        background: rgba(255, 255, 255, 0.6);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .dashboard-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
      }

      /* Light Theme Dashboard Card Hover */
      [data-theme="light"] .dashboard-card:hover {
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
      }

      .dashboard-card h4 {
        font-family: "Montserrat", sans-serif;
        font-size: 1.2rem;
        margin-bottom: 15px;
        color: var(--gray-medium);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .metric-value {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 5px;
        background: linear-gradient(to right, #fff, var(--gray-medium));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      /* Light Theme Metric Value */
      [data-theme="light"] .metric-value {
        background: linear-gradient(to right, #000, var(--gray-medium));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .metric-label {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Metric Label */
      [data-theme="light"] .metric-label {
        color: rgba(0, 0, 0, 0.7);
      }

      .metric-change {
        font-size: 0.8rem;
        margin-top: 10px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .metric-change.positive {
        color: var(--success);
      }

      .metric-change.negative {
        color: var(--error);
      }

      .dashboard-table-container {
        background: rgba(0, 0, 0, 0.6);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 30px;
        overflow-x: auto;
      }

      /* Light Theme Dashboard Table Container */
      [data-theme="light"] .dashboard-table-container {
        background: rgba(255, 255, 255, 0.6);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .dashboard-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      .dashboard-table th,
      .dashboard-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Table Borders */
      [data-theme="light"] .dashboard-table th,
      [data-theme="light"] .dashboard-table td {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .dashboard-table th {
        font-weight: 600;
        color: var(--gray-medium);
        font-size: 0.9rem;
      }

      .dashboard-table td {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
      }

      /* Light Theme Table Text */
      [data-theme="light"] .dashboard-table td {
        color: rgba(0, 0, 0, 0.8);
      }

      .dashboard-table tr:hover {
        background: rgba(255, 255, 255, 0.05);
      }

      /* Light Theme Table Row Hover */
      [data-theme="light"] .dashboard-table tr:hover {
        background: rgba(0, 0, 0, 0.05);
      }

      .status-badge {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        display: inline-block;
      }

      .status-fraud {
        background: rgba(244, 67, 54, 0.2);
        color: var(--error);
      }

      .status-suspicious {
        background: rgba(255, 152, 0, 0.2);
        color: var(--warning);
      }

      .status-legitimate {
        background: rgba(76, 175, 80, 0.2);
        color: var(--success);
      }

      .fraud-types-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .fraud-type-card {
        background: rgba(50, 50, 50, 0.3);
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        transition: var(--transition);
        cursor: pointer;
      }

      /* Light Theme Fraud Type Card */
      [data-theme="light"] .fraud-type-card {
        background: rgba(200, 200, 200, 0.3);
      }

      .fraud-type-card:hover {
        transform: translateY(-3px);
        background: rgba(50, 50, 50, 0.5);
      }

      /* Light Theme Fraud Type Card Hover */
      [data-theme="light"] .fraud-type-card:hover {
        background: rgba(200, 200, 200, 0.5);
      }

      .fraud-type-icon {
        font-size: 2.5rem;
        margin-bottom: 10px;
        color: var(--gray-medium);
      }

      .fraud-type-name {
        font-weight: 600;
        margin-bottom: 5px;
        color: #fff;
      }

      /* Light Theme Fraud Type Name */
      [data-theme="light"] .fraud-type-name {
        color: #000;
      }

      .fraud-type-count {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Fraud Type Count */
      [data-theme="light"] .fraud-type-count {
        color: rgba(0, 0, 0, 0.7);
      }

      /* Real-time Alert */
      .realtime-alert {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(244, 67, 54, 0.9);
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        z-index: 10000;
        display: none;
        animation: slideInRight 0.3s ease-out;
        max-width: 350px;
      }

      @keyframes slideInRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      .realtime-alert.show {
        display: block;
      }

      .realtime-alert-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }

      .realtime-alert-title {
        font-weight: 600;
        font-size: 1rem;
      }

      .realtime-alert-close {
        background: none;
        border: none;
        color: white;
        font-size: 1.2rem;
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.2s;
      }

      .realtime-alert-close:hover {
        opacity: 1;
      }

      .realtime-alert-content {
        font-size: 0.9rem;
        line-height: 1.4;
      }

      /* Notification Toast */
      .notification-toast {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 12px 24px;
        border-radius: 30px;
        font-weight: 500;
        z-index: 3000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        animation: fadeInUp 0.3s ease-out;
        display: none;
      }

      /* Light Theme Notification Toast */
      [data-theme="light"] .notification-toast {
        background: rgba(255, 255, 255, 0.8);
        color: black;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      /* Result Items */
      .result-item {
        background: rgba(50, 50, 50, 0.3);
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 10px;
        transition: var(--transition);
        cursor: pointer;
      }

      /* Light Theme Result Item */
      [data-theme="light"] .result-item {
        background: rgba(200, 200, 200, 0.3);
      }

      .result-item:hover {
        transform: translateX(5px);
        background: rgba(50, 50, 50, 0.5);
      }

      /* Light Theme Result Item Hover */
      [data-theme="light"] .result-item:hover {
        background: rgba(200, 200, 200, 0.5);
      }

      .result-item.fraud {
        border-left: 4px solid var(--error);
      }

      .result-item.suspicious {
        border-left: 4px solid var(--warning);
      }

      .result-item.legitimate {
        border-left: 4px solid var(--success);
      }

      .result-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        flex-wrap: wrap;
        gap: 5px;
      }

      .result-id {
        font-weight: bold;
        font-size: 0.9rem;
      }

      .result-status {
        padding: 2px 8px;
        border-radius: 15px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .status-fraud {
        background: rgba(244, 67, 54, 0.2);
        color: var(--error);
      }

      .status-suspicious {
        background: rgba(255, 152, 0, 0.2);
        color: var(--warning);
      }

      .status-legitimate {
        background: rgba(76, 175, 80, 0.2);
        color: var(--success);
      }

      .result-details {
        display: flex;
        justify-content: space-between;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.8);
        flex-wrap: wrap;
        gap: 5px;
      }

      /* Light Theme Result Details */
      [data-theme="light"] .result-details {
        color: rgba(0, 0, 0, 0.8);
      }

      .result-amount {
        font-weight: 600;
      }

      /* View Dashboard Button */
      .view-dashboard-btn {
        background: linear-gradient(135deg, var(--success), #45a049);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: 8px;
        margin-top: 15px;
        box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
      }

      .view-dashboard-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
      }

      /* Case Management System Styles */
      .case-management-page {
        display: none;
        min-height: 100vh;
        padding: 20px 0;
      }

      .case-management-page.active {
        display: block;
      }

      .case-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
        gap: 15px;
      }

      .case-title {
        font-family: "Montserrat", sans-serif;
        font-size: 2rem;
        color: var(--gray-medium);
      }

      .case-controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .case-btn {
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        color: white;
        font-size: 0.9rem;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      /* Light Theme Case Button */
      [data-theme="light"] .case-btn {
        background: rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.2);
        color: black;
      }

      .case-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }

      /* Light Theme Case Button Hover */
      [data-theme="light"] .case-btn:hover {
        background: rgba(0, 0, 0, 0.2);
      }

      .case-filters {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .filter-group {
        display: flex;
        flex-direction: column;
        gap: 5px;
        min-width: 150px;
      }

      .filter-group label {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Filter Label */
      [data-theme="light"] .filter-group label {
        color: rgba(0, 0, 0, 0.7);
      }

      .filter-group select,
      .filter-group input {
        padding: 8px 12px;
        background: rgba(50, 50, 50, 0.5);
        border: 1px solid rgba(200, 200, 200, 0.2);
        border-radius: 6px;
        color: white;
        font-size: 0.9rem;
        outline: none;
        transition: var(--transition);
      }

      /* Light Theme Filter Input */
      [data-theme="light"] .filter-group select,
      [data-theme="light"] .filter-group input {
        background: rgba(200, 200, 200, 0.5);
        border: 1px solid rgba(50, 50, 50, 0.2);
        color: black;
      }

      .filter-group select:focus,
      .filter-group input:focus {
        border-color: var(--gray-medium);
        box-shadow: 0 0 0 3px rgba(200, 200, 200, 0.1);
      }

      .case-stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
      }

      .case-stat-card {
        background: rgba(0, 0, 0, 0.6);
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: var(--transition);
      }

      /* Light Theme Case Stat Card */
      [data-theme="light"] .case-stat-card {
        background: rgba(255, 255, 255, 0.6);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .case-stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
      }

      /* Light Theme Case Stat Card Hover */
      [data-theme="light"] .case-stat-card:hover {
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .case-stat-title {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      /* Light Theme Case Stat Title */
      [data-theme="light"] .case-stat-title {
        color: rgba(0, 0, 0, 0.7);
      }

      .case-stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--gray-medium);
      }

      .case-table-container {
        background: rgba(0, 0, 0, 0.6);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 30px;
        overflow-x: auto;
      }

      /* Light Theme Case Table Container */
      [data-theme="light"] .case-table-container {
        background: rgba(255, 255, 255, 0.6);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .case-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      .case-table th,
      .case-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Case Table Borders */
      [data-theme="light"] .case-table th,
      [data-theme="light"] .case-table td {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .case-table th {
        font-weight: 600;
        color: var(--gray-medium);
        font-size: 0.9rem;
      }

      .case-table td {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
      }

      /* Light Theme Case Table Text */
      [data-theme="light"] .case-table td {
        color: rgba(0, 0, 0, 0.8);
      }

      .case-table tr:hover {
        background: rgba(255, 255, 255, 0.05);
      }

      /* Light Theme Case Table Row Hover */
      [data-theme="light"] .case-table tr:hover {
        background: rgba(0, 0, 0, 0.05);
      }

      .case-priority {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .priority-high {
        background: rgba(244, 67, 54, 0.2);
        color: var(--error);
      }

      .priority-medium {
        background: rgba(255, 152, 0, 0.2);
        color: var(--warning);
      }

      .priority-low {
        background: rgba(76, 175, 80, 0.2);
        color: var(--success);
      }

      .case-status {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .status-new {
        background: rgba(33, 150, 243, 0.2);
        color: #2196f3;
      }

      .status-investigating {
        background: rgba(255, 152, 0, 0.2);
        color: var(--warning);
      }

      .status-resolved {
        background: rgba(76, 175, 80, 0.2);
        color: var(--success);
      }

      .status-closed {
        background: rgba(158, 158, 158, 0.2);
        color: #9e9e9e;
      }

      .case-actions {
        display: flex;
        gap: 8px;
      }

      .action-btn {
        padding: 6px 10px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 4px;
        color: white;
        font-size: 0.8rem;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Light Theme Action Button */
      [data-theme="light"] .action-btn {
        background: rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.2);
        color: black;
      }

      .action-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      /* Light Theme Action Button Hover */
      [data-theme="light"] .action-btn:hover {
        background: rgba(0, 0, 0, 0.2);
      }

      /* Case Detail Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 10000;
        overflow-y: auto;
      }

      .modal.active {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background: rgba(30, 30, 30, 0.95);
        border-radius: 15px;
        padding: 30px;
        width: 90%;
        max-width: 800px;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Modal Content */
      [data-theme="light"] .modal-content {
        background: rgba(255, 255, 255, 0.95);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(0, 0, 0, 0.1);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Modal Header */
      [data-theme="light"] .modal-header {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .modal-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.5rem;
        color: var(--gray-medium);
      }

      .modal-close {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.7);
        font-size: 1.5rem;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Light Theme Modal Close */
      [data-theme="light"] .modal-close {
        color: rgba(0, 0, 0, 0.7);
      }

      .modal-close:hover {
        color: white;
      }

      /* Light Theme Modal Close Hover */
      [data-theme="light"] .modal-close:hover {
        color: black;
      }

      .modal-body {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .case-detail-section {
        background: rgba(50, 50, 50, 0.3);
        border-radius: 10px;
        padding: 20px;
      }

      /* Light Theme Case Detail Section */
      [data-theme="light"] .case-detail-section {
        background: rgba(200, 200, 200, 0.3);
      }

      .section-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.1rem;
        margin-bottom: 15px;
        color: var(--gray-medium);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .detail-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
      }

      .detail-item {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .detail-label {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Detail Label */
      [data-theme="light"] .detail-label {
        color: rgba(0, 0, 0, 0.7);
      }

      .detail-value {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.9);
      }

      /* Light Theme Detail Value */
      [data-theme="light"] .detail-value {
        color: rgba(0, 0, 0, 0.9);
      }

      .timeline {
        position: relative;
        margin-left: 20px;
      }

      .timeline::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 2px;
        background: rgba(255, 255, 255, 0.2);
      }

      /* Light Theme Timeline */
      [data-theme="light"] .timeline::before {
        background: rgba(0, 0, 0, 0.2);
      }

      .timeline-item {
        position: relative;
        padding-left: 30px;
        margin-bottom: 20px;
      }

      .timeline-item::before {
        content: "";
        position: absolute;
        top: 5px;
        left: -9px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: var(--gray-medium);
      }

      .timeline-date {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 5px;
      }

      /* Light Theme Timeline Date */
      [data-theme="light"] .timeline-date {
        color: rgba(0, 0, 0, 0.7);
      }

      .timeline-content {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.9);
      }

      /* Light Theme Timeline Content */
      [data-theme="light"] .timeline-content {
        color: rgba(0, 0, 0, 0.9);
      }

      .evidence-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .evidence-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px;
        background: rgba(50, 50, 50, 0.3);
        border-radius: 8px;
      }

      /* Light Theme Evidence Item */
      [data-theme="light"] .evidence-item {
        background: rgba(200, 200, 200, 0.3);
      }

      .evidence-icon {
        font-size: 1.2rem;
        color: var(--gray-medium);
      }

      .evidence-info {
        flex: 1;
      }

      .evidence-name {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.9);
      }

      /* Light Theme Evidence Name */
      [data-theme="light"] .evidence-name {
        color: rgba(0, 0, 0, 0.9);
      }

      .evidence-date {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Evidence Date */
      [data-theme="light"] .evidence-date {
        color: rgba(0, 0, 0, 0.7);
      }

      .notes-container {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .note-item {
        background: rgba(50, 50, 50, 0.3);
        border-radius: 8px;
        padding: 15px;
      }

      /* Light Theme Note Item */
      [data-theme="light"] .note-item {
        background: rgba(200, 200, 200, 0.3);
      }

      .note-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }

      .note-author {
        font-weight: 600;
        color: rgba(255, 255, 255, 0.9);
      }

      /* Light Theme Note Author */
      [data-theme="light"] .note-author {
        color: rgba(0, 0, 0, 0.9);
      }

      .note-date {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme Note Date */
      [data-theme="light"] .note-date {
        color: rgba(0, 0, 0, 0.7);
      }

      .note-content {
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.9);
      }

      /* Light Theme Note Content */
      [data-theme="light"] .note-content {
        color: rgba(0, 0, 0, 0.9);
      }

      .add-note-form {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .form-textarea {
        padding: 10px;
        background: rgba(50, 50, 50, 0.5);
        border: 1px solid rgba(200, 200, 200, 0.2);
        border-radius: 6px;
        color: white;
        font-size: 0.9rem;
        outline: none;
        resize: vertical;
        min-height: 100px;
      }

      /* Light Theme Form Textarea */
      [data-theme="light"] .form-textarea {
        background: rgba(200, 200, 200, 0.5);
        border: 1px solid rgba(50, 50, 50, 0.2);
        color: black;
      }

      .form-textarea:focus {
        border-color: var(--gray-medium);
        box-shadow: 0 0 0 3px rgba(200, 200, 200, 0.1);
      }

      .modal-footer {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
        margin-top: 20px;
        padding-top: 15px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Modal Footer */
      [data-theme="light"] .modal-footer {
        border-top: 1px solid rgba(0, 0, 0, 0.1);
      }

      .btn-secondary {
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 6px;
        color: white;
        font-size: 0.9rem;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Light Theme Secondary Button */
      [data-theme="light"] .btn-secondary {
        background: rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.2);
        color: black;
      }

      .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      /* Light Theme Secondary Button Hover */
      [data-theme="light"] .btn-secondary:hover {
        background: rgba(0, 0, 0, 0.2);
      }

      .btn-primary {
        padding: 10px 20px;
        background: linear-gradient(
          135deg,
          var(--gray-medium),
          var(--gray-dark)
        );
        border: none;
        border-radius: 6px;
        color: white;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(100, 100, 100, 0.3);
      }

      /* New Case Form */
      .new-case-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .form-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
      }

      .form-input {
        padding: 10px;
        background: rgba(50, 50, 50, 0.5);
        border: 1px solid rgba(200, 200, 200, 0.2);
        border-radius: 6px;
        color: white;
        font-size: 0.9rem;
        outline: none;
      }

      /* Light Theme Form Input */
      [data-theme="light"] .form-input {
        background: rgba(200, 200, 200, 0.5);
        border: 1px solid rgba(50, 50, 50, 0.2);
        color: black;
      }

      .form-input:focus {
        border-color: var(--gray-medium);
        box-shadow: 0 0 0 3px rgba(200, 200, 200, 0.1);
      }

      .form-select {
        padding: 10px;
        background: rgba(50, 50, 50, 0.5);
        border: 1px solid rgba(200, 200, 200, 0.2);
        border-radius: 6px;
        color: white;
        font-size: 0.9rem;
        outline: none;
      }

      /* Light Theme Form Select */
      [data-theme="light"] .form-select {
        background: rgba(200, 200, 200, 0.5);
        border: 1px solid rgba(50, 50, 50, 0.2);
        color: black;
      }

      .form-select:focus {
        border-color: var(--gray-medium);
        box-shadow: 0 0 0 3px rgba(200, 200, 200, 0.1);
      }

      /* Transaction Details Table */
      .transaction-details-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }

      .transaction-details-table th,
      .transaction-details-table td {
        padding: 8px 12px;
        text-align: left;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Transaction Details Table Borders */
      [data-theme="light"] .transaction-details-table th,
      [data-theme="light"] .transaction-details-table td {
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }

      .transaction-details-table th {
        font-weight: 600;
        color: var(--gray-medium);
        font-size: 0.85rem;
      }

      .transaction-details-table td {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.85rem;
      }

      /* Light Theme Transaction Details Table Text */
      [data-theme="light"] .transaction-details-table td {
        color: rgba(0, 0, 0, 0.8);
      }

      /* Responsive Design */
      @media (min-width: 768px) {
        .container {
          padding: 0 20px;
        }

        header {
          padding: 15px 20px;
        }

        .logo-icon {
          width: 50px;
          height: 50px;
          font-size: 22px;
        }

        .logo-text h1 {
          font-size: 1.5rem;
        }

        .logo-text p {
          font-size: 0.8rem;
        }

        nav ul {
          display: flex;
          gap: 15px;
          list-style: none;
        }

        nav a {
          color: rgba(255, 255, 255, 0.85);
          text-decoration: none;
          font-weight: 500;
          font-size: 0.9rem;
          transition: var(--transition);
          display: flex;
          align-items: center;
          gap: 6px;
          position: relative;
          padding: 6px 10px;
          border-radius: 6px;
        }

        /* Light Theme Navigation Links */
        [data-theme="light"] nav a {
          color: rgba(0, 0, 0, 0.85);
        }

        nav a::after {
          content: "";
          position: absolute;
          bottom: 0;
          left: 50%;
          width: 0;
          height: 2px;
          background: var(--gray-medium);
          transition: var(--transition);
          transform: translateX(-50%);
        }

        nav a:hover {
          color: var(--gray-medium);
          background: rgba(255, 255, 255, 0.1);
        }

        /* Light Theme Navigation Links Hover */
        [data-theme="light"] nav a:hover {
          background: rgba(0, 0, 0, 0.1);
        }

        nav a:hover::after {
          width: 80%;
        }

        .menu-toggle {
          display: none;
        }

        .hero {
          flex-direction: row;
          gap: 30px;
        }

        .hero-content {
          text-align: left;
        }

        .hero h2 {
          font-size: 2.2rem;
        }

        .hero p {
          font-size: 1.1rem;
          max-width: 600px;
        }

        .stats {
          justify-content: flex-start;
        }

        .stat-item {
          min-width: 120px;
        }

        .stat-item .number {
          font-size: 1.8rem;
        }

        .content-container {
          flex-direction: row;
          gap: 25px;
        }

        .card h3 {
          font-size: 1.4rem;
        }

        .features {
          grid-template-columns: repeat(2, 1fr);
        }

        .footer-content {
          flex-direction: row;
          text-align: left;
        }

        .footer-section {
          min-width: 200px;
        }

        .charts-container {
          flex-direction: row;
        }

        .chart-wrapper {
          flex: 1;
        }

        .dashboard-grid {
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
      }

      @media (min-width: 992px) {
        .features {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      /* Authentication Modals */
      .auth-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 10000;
        justify-content: center;
        align-items: center;
      }

      .auth-modal.active {
        display: flex;
      }

      .auth-content {
        background: rgba(30, 30, 30, 0.95);
        border-radius: 15px;
        padding: 30px;
        width: 90%;
        max-width: 400px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: var(--light);
      }

      /* Light Theme Auth Content */
      [data-theme="light"] .auth-content {
        background: rgba(255, 255, 255, 0.95);
        color: var(--dark);
      }

      .auth-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .auth-title {
        font-family: "Montserrat", sans-serif;
        font-size: 1.5rem;
        color: var(--gray-medium);
      }

      .auth-close {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.7);
        font-size: 1.5rem;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Light Theme Auth Close */
      [data-theme="light"] .auth-close {
        color: rgba(0, 0, 0, 0.7);
      }

      .auth-close:hover {
        color: white;
      }

      /* Light Theme Auth Close Hover */
      [data-theme="light"] .auth-close:hover {
        color: black;
      }
/* 3D Network Visualization */
#3d-network-container {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(255, 255, 255, 0.1);
}
[data-theme="light"] #3d-network-container {
  background: rgba(255, 255, 255, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.three-tooltip {
  position: absolute;
  background: rgba(0, 0, 0, 0.85);
  color: white;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 0.85rem;
  pointer-events: none;
  z-index: 2000;
  white-space: nowrap;
  display: none;
}
[data-theme="light"] .three-tooltip {
  background: rgba(255, 255, 255, 0.9);
  color: black;
  border: 1px solid rgba(0, 0, 0, 0.1);
}
      .auth-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .auth-switch {
        text-align: center;
        margin-top: 15px;
        font-size: 0.9rem;
      }

      .auth-switch a {
        color: var(--gray-medium);
        text-decoration: none;
        font-weight: 600;
      }

      .auth-switch a:hover {
        text-decoration: underline;
      }

      /* User Profile */
      .user-profile {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 5px 10px;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.1);
        transition: var(--transition);
      }

      /* Light Theme User Profile */
      [data-theme="light"] .user-profile {
        background: rgba(0, 0, 0, 0.1);
      }

      .user-profile:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      /* Light Theme User Profile Hover */
      [data-theme="light"] .user-profile:hover {
        background: rgba(0, 0, 0, 0.2);
      }

      .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: var(--gray-medium);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--dark);
        font-weight: 600;
      }

      .user-info {
        display: flex;
        flex-direction: column;
      }

      .user-name {
        font-size: 0.9rem;
        font-weight: 600;
      }

      .user-email {
        font-size: 0.7rem;
        color: rgba(255, 255, 255, 0.7);
      }

      /* Light Theme User Email */
      [data-theme="light"] .user-email {
        color: rgba(0, 0, 0, 0.7);
      }

      .logout-btn {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
        cursor: pointer;
        transition: var(--transition);
        padding: 5px;
      }

      /* Light Theme Logout Button */
      [data-theme="light"] .logout-btn {
        color: rgba(0, 0, 0, 0.7);
      }

      .logout-btn:hover {
        color: white;
      }

      /* Light Theme Logout Button Hover */
      [data-theme="light"] .logout-btn:hover {
        color: black;
      }

      /* Enhanced Auth Styles */
      .password-strength {
        margin-top: 5px;
        height: 4px;
        border-radius: 2px;
        background: rgba(255, 255, 255, 0.1);
        overflow: hidden;
      }

      .password-strength-bar {
        height: 100%;
        transition: width 0.3s ease, background-color 0.3s ease;
      }

      .strength-weak {
        background: var(--error);
        width: 33%;
      }

      .strength-medium {
        background: var(--warning);
        width: 66%;
      }

      .strength-strong {
        background: var(--success);
        width: 100%;
      }

      .password-requirements {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.6);
        margin-top: 5px;
      }

      /* Light Theme Password Requirements */
      [data-theme="light"] .password-requirements {
        color: rgba(0, 0, 0, 0.6);
      }

      .requirement {
        display: flex;
        align-items: center;
        gap: 5px;
        margin-bottom: 2px;
      }

      .requirement i {
        font-size: 0.7rem;
        width: 12px;
        text-align: center;
        color: var(--error);
      }

      .requirement.met i {
        color: var(--success);
      }

      .form-error {
        color: var(--error);
        font-size: 0.8rem;
        margin-top: 5px;
        display: none;
      }

      .form-error.show {
        display: block;
      }

      .input-group {
        position: relative;
      }

      .input-icon {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: var(--transition);
      }

      .input-icon:hover {
        color: rgba(255, 255, 255, 0.8);
      }

      .input-icon.show-password {
        color: var(--gray-medium);
      }

      .remember-me {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 10px;
      }

      /* Light Theme Remember Me */
      [data-theme="light"] .remember-me {
        color: rgba(0, 0, 0, 0.8);
      }

      .remember-me input[type="checkbox"] {
        width: auto;
        margin: 0;
      }

      .auth-loading {
        display: none;
        text-align: center;
        padding: 20px;
      }

      .auth-loading.show {
        display: block;
      }

      .spinner {
        border: 2px solid rgba(255, 255, 255, 0.1);
        border-top: 2px solid var(--gray-medium);
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .auth-success {
        display: none;
        text-align: center;
        padding: 20px;
      }

      .auth-success.show {
        display: block;
      }

      .success-icon {
        font-size: 3rem;
        color: var(--success);
        margin-bottom: 10px;
      }

      .forgot-password {
        text-align: right;
        margin-top: 5px;
      }

      .forgot-password a {
        color: var(--gray-medium);
        text-decoration: none;
        font-size: 0.8rem;
      }

      .forgot-password a:hover {
        text-decoration: underline;
      }

      .social-login {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Light Theme Social Login */
      [data-theme="light"] .social-login {
        border-top: 1px solid rgba(0, 0, 0, 0.1);
      }

      .social-login-title {
        text-align: center;
        font-size: 0.9rem;
        color: rgba(255, 255, 255, 0.6);
        margin-bottom: 15px;
      }

      /* Light Theme Social Login Title */
      [data-theme="light"] .social-login-title {
        color: rgba(0, 0, 0, 0.6);
      }

      .social-buttons {
        display: flex;
        gap: 10px;
      }

      .social-btn {
        flex: 1;
        padding: 10px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.05);
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        text-align: center;
        font-size: 0.9rem;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
      }

      .social-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
      }

      .social-btn.google {
        border-color: #4285f4;
        color: #4285f4;
      }

      .social-btn.github {
        border-color: #333;
        color: #333;
      }

      .social-btn.microsoft {
        border-color: #00a4ef;
        color: #00a4ef;
      }
    </style>
  </head>
  <body>
    <!-- Home Page -->
    <div id="home-page" class="page-content">
      <header>
        <div class="logo">
          <div class="logo-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div class="logo-text">
            <h1>Fraudshield Pro</h1>
            <p>Advanced Fraud Detection</p>
          </div>
        </div>
        <nav>
          <button class="menu-toggle" id="menu-toggle">
            <span></span>
            <span></span>
            <span></span>
          </button>
          <ul>
            <li>
              <a href="#home"><i class="fas fa-home"></i> Home</a>
            </li>
            <li>
              <a href="#dashboard" id="dashboard-link"
                ><i class="fas fa-tachometer-alt"></i> Dashboard</a
              >
            </li>
            <li>
              <a href="#case-management" id="case-management-link"
                ><i class="fas fa-briefcase"></i> Case Management</a
              >
            </li>
            <li>
              <a href="#how-it-works"
                ><i class="fas fa-cogs"></i> How It Works</a
              >
            </li>
            <li>
              <a href="#analytics"
                ><i class="fas fa-chart-line"></i> Analytics</a
              >
            </li>
            <li>
              <a href="#contact"><i class="fas fa-envelope"></i> Contact</a>
            </li>
            <li>
              <a href="#" id="settings-btn"
                ><i class="fas fa-cog"></i> Settings</a
              >
            </li>
            <li id="user-menu" style="display: none">
              <div class="user-profile">
                <div class="user-avatar" id="user-avatar">U</div>
                <div class="user-info">
                  <div class="user-name" id="user-name">User</div>
                  <div class="user-email" id="user-email">user@example.com</div>
                </div>
                <button class="logout-btn" id="logout-btn">
                  <i class="fas fa-sign-out-alt"></i>
                </button>
              </div>
            </li>
          </ul>
        </nav>
      </header>

      <!-- Mobile Menu -->
      <div class="mobile-menu-overlay" id="mobile-menu-overlay"></div>
      <div class="mobile-menu" id="mobile-menu">
        <div class="mobile-menu-header">
          <div class="mobile-menu-title">Menu</div>
          <button class="close-mobile-menu" id="close-mobile-menu">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <ul>
          <li>
            <a href="#home"><i class="fas fa-home"></i> Home</a>
          </li>
          <li>
            <a href="#dashboard" id="mobile-dashboard-link"
              ><i class="fas fa-tachometer-alt"></i> Dashboard</a
            >
          </li>
          <li>
            <a href="#case-management" id="mobile-case-management-link"
              ><i class="fas fa-briefcase"></i> Case Management</a
            >
          </li>
          <li>
            <a href="#how-it-works"><i class="fas fa-cogs"></i> How It Works</a>
          </li>
          <li>
            <a href="#analytics"><i class="fas fa-chart-line"></i> Analytics</a>
          </li>
          <li>
            <a href="#contact"><i class="fas fa-envelope"></i> Contact</a>
          </li>
          <li>
            <a href="#" id="mobile-settings-btn"
              ><i class="fas fa-cog"></i> Settings</a
            >
          </li>
          <li id="mobile-user-menu" style="display: none">
            <div class="user-profile">
              <div class="user-avatar" id="mobile-user-avatar">U</div>
              <div class="user-info">
                <div class="user-name" id="mobile-user-name">User</div>
                <div class="user-email" id="mobile-user-email">
                  user@example.com
                </div>
              </div>
              <button class="logout-btn" id="mobile-logout-btn">
                <i class="fas fa-sign-out-alt"></i>
              </button>
            </div>
          </li>
        </ul>
      </div>

      <div class="container">
        <section class="hero" id="home">
          <div class="hero-content">
            <h2>
              Protect Your Business with <span>Advanced Fraud Detection</span>
            </h2>
            <p>
              Our cutting-edge AI technology analyzes transactions in real-time
              to identify and prevent fraudulent activities before they impact
              your business. Financial fraud costs businesses billions annually,
              with sophisticated tactics evolving constantly. Fraudshield Pro
              stays ahead of these threats through continuous learning
              algorithms and pattern recognition.
            </p>
            <div class="stats">
              <div class="stat-item">
                <div class="number">99.8%</div>
                <div class="label">Accuracy</div>
              </div>
              <div class="stat-item">
                <div class="number">0.3s</div>
                <div class="label">Detection</div>
              </div>
              <div class="stat-item">
                <div class="number">2M+</div>
                <div class="label">Daily</div>
              </div>
            </div>
          </div>
          <div class="hero-image">
            <div class="dashboard-img">
              <img
                src="https://picsum.photos/seed/fraudshield/400/250.jpg"
                alt="Fraud Detection Dashboard"
                style="width: 100%; border-radius: 10px"
              />
            </div>
          </div>
        </section>

        <div class="content-container">
          <div class="card form-container">
            <h3><i class="fas fa-upload"></i> Upload Data</h3>
            <form id="upload-form">
              <div class="form-group">
                <label for="file-upload">Select File</label>
                <div class="file-input-container">
                  <input
                    type="file"
                    id="file-upload"
                    accept=".csv, .xlsx, .json"
                  />
                </div>
              </div>
              <button type="submit">
                <i class="fas fa-search"></i> Analyze
              </button>
            </form>
            <div class="info-box">
              <h4><i class="fas fa-info-circle"></i> Supported Formats</h4>
              <ul>
                <li>CSV files with transaction data</li>
                <li>Excel spreadsheets (.xlsx, .xls)</li>
                <li>JSON data with proper structure</li>
                <li>Max size: 10MB per file</li>
              </ul>
            </div>
          </div>
          <div class="card results-container">
            <h3><i class="fas fa-chart-bar"></i> Analysis Results</h3>
            <div class="results-content">
              <div class="results-placeholder" id="results-placeholder">
                <i class="fas fa-file-upload"></i>
                <p class="results-text">
                  Upload your transaction data to begin the fraud detection
                  analysis. Our system will examine patterns, anomalies, and
                  suspicious activities across multiple dimensions.
                </p>
              </div>
              <div class="progress-container" id="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
              </div>
              <div id="analysis-results" style="display: none; width: 100%">
                <div class="summary-stat-container">
                  <div class="summary-stat-item legitimate">
                    <div class="count legitimate" id="legitimate-count">0</div>
                    <div class="label">Legitimate</div>
                  </div>
                  <div class="summary-stat-item suspicious">
                    <div class="count suspicious" id="suspicious-count">0</div>
                    <div class="label">Suspicious</div>
                  </div>
                  <div class="summary-stat-item fraud">
                    <div class="count fraud" id="fraud-count">0</div>
                    <div class="label">Fraud</div>
                  </div>
                </div>
                <div class="download-section">
                  <div class="download-options" id="download-options">
                    <button class="download-btn" id="download-btn">
                      <i class="fas fa-download"></i> Download Report
                    </button>
                    <div class="download-dropdown">
                      <a href="#" class="download-option" data-format="pdf">
                        <i class="fas fa-file-pdf"></i> PDF
                      </a>
                      <a href="#" class="download-option" data-format="excel">
                        <i class="fas fa-file-excel"></i> Excel
                      </a>
                      <a href="#" class="download-option" data-format="word">
                        <i class="fas fa-file-word"></i> Word
                      </a>
                      <a href="#" class="download-option" data-format="csv">
                        <i class="fas fa-file-csv"></i> CSV
                      </a>
                    </div>
                  </div>
                </div>
                <div class="location-section">
                  <button class="location-btn" id="location-btn">
                    <i class="fas fa-map-marker-alt"></i> View Locations
                  </button>
                </div>
                <div class="charts-container">
                  <div class="chart-wrapper">
                    <div class="chart-title">Transaction Categories</div>
                    <div class="chart-container">
                      <canvas id="category-chart"></canvas>
                    </div>
                  </div>
                  <div class="chart-wrapper">
                    <div class="chart-title">Risk Distribution</div>
                    <div class="chart-container">
                      <canvas id="risk-chart"></canvas>
                    </div>
                  </div>
                </div>
                <div id="results-list" style="margin-top: 15px"></div>
                <div style="text-align: center; margin-top: 20px">
                  <button class="view-dashboard-btn" id="view-dashboard-btn">
                    <i class="fas fa-tachometer-alt"></i> View Full Dashboard
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <section class="features" id="analytics">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-tachometer-alt"></i>
            </div>
            <div class="feature-content">
              <h4>Real-time Processing</h4>
              <p>
                Analyze thousands of transactions per second with minimal
                latency
              </p>
            </div>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <div class="feature-content">
              <h4>Advanced Security</h4>
              <p>
                Bank-level encryption and compliance with financial regulations
              </p>
            </div>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-chart-pie"></i>
            </div>
            <div class="feature-content">
              <h4>Analytics</h4>
              <p>
                Detailed visualizations of fraud patterns and trends over time
              </p>
            </div>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-robot"></i>
            </div>
            <div class="feature-content">
              <h4>Machine Learning</h4>
              <p>System learns and improves from new data and fraud patterns</p>
            </div>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-bell"></i>
            </div>
            <div class="feature-content">
              <h4>Instant Alerts</h4>
              <p>
                Real-time notifications when suspicious activity is detected
              </p>
            </div>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-history"></i>
            </div>
            <div class="feature-content">
              <h4>Historical Analysis</h4>
              <p>
                Track fraud trends and patterns across multiple time periods
              </p>
            </div>
          </div>
        </section>
      </div>

      <footer id="contact">
        <div class="container">
          <div class="footer-content">
            <div class="footer-section">
              <h4>About</h4>
              <p>
                We provide cutting-edge fraud detection solutions to protect
                businesses from financial threats.
              </p>
              <div class="social-links">
                <a href="#"><i class="fab fa-facebook-f"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-linkedin-in"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
              </div>
            </div>
            <div class="footer-section">
              <h4>Quick Links</h4>
              <p>
                <a href="#" style="color: inherit; text-decoration: none"
                  >Privacy Policy</a
                >
              </p>
              <p>
                <a href="#" style="color: inherit; text-decoration: none"
                  >Terms of Service</a
                >
              </p>
              <p>
                <a href="#" style="color: inherit; text-decoration: none"
                  >API Docs</a
                >
              </p>
              <p>
                <a href="#" style="color: inherit; text-decoration: none"
                  >Support</a
                >
              </p>
            </div>
            <div class="footer-section">
              <h4>Contact</h4>
              <p><i class="fas fa-envelope"></i> info@fraudshieldpro.com</p>
              <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
              <p><i class="fas fa-map-marker-alt"></i> San Francisco, CA</p>
            </div>
          </div>
          <div class="copyright">
            <p>&copy; 2023 Fraudshield Pro. All rights reserved.</p>
          </div>
        </div>
      </footer>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboard-page" class="dashboard-page">
      <div class="container">
        <div class="dashboard-header">
          <h2 class="dashboard-title">Fraud Detection Dashboard</h2>
          <div class="dashboard-controls">
            <button class="dashboard-btn" id="refresh-dashboard">
              <i class="fas fa-sync-alt"></i> Refresh
            </button>
            <div class="download-options" id="dashboard-export-options">
              <button class="dashboard-btn" id="export-dashboard">
                <i class="fas fa-download"></i> Export
              </button>
              <div class="download-dropdown">
                <a
                  href="#"
                  class="download-option"
                  data-format="pdf"
                  data-source="dashboard"
                >
                  <i class="fas fa-file-pdf"></i> PDF
                </a>
                <a
                  href="#"
                  class="download-option"
                  data-format="excel"
                  data-source="dashboard"
                >
                  <i class="fas fa-file-excel"></i> Excel
                </a>
                <a
                  href="#"
                  class="download-option"
                  data-format="word"
                  data-source="dashboard"
                >
                  <i class="fas fa-file-word"></i> Word
                </a>
                <a
                  href="#"
                  class="download-option"
                  data-format="csv"
                  data-source="dashboard"
                >
                  <i class="fas fa-file-csv"></i> CSV
                </a>
              </div>
            </div>
            <button class="dashboard-btn" id="back-to-home">
              <i class="fas fa-arrow-left"></i> Back to Home
            </button>
          </div>
        </div>

        <div class="dashboard-grid">
          <div class="dashboard-card">
            <h4><i class="fas fa-chart-line"></i> Total Transactions</h4>
            <div class="metric-value" id="total-transactions">0</div>
            <div class="metric-label">Last 30 days</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i>
              <span id="total-change">0%</span> from last month
            </div>
          </div>
          <div class="dashboard-card">
            <h4><i class="fas fa-exclamation-triangle"></i> Fraud Detected</h4>
            <div class="metric-value" id="fraud-detected">0</div>
            <div class="metric-label">Last 30 days</div>
            <div class="metric-change negative">
              <i class="fas fa-arrow-up"></i>
              <span id="fraud-change">0%</span> from last month
            </div>
          </div>
          <div class="dashboard-card">
            <h4><i class="fas fa-dollar-sign"></i> Amount Saved</h4>
            <div class="metric-value" id="amount-saved">$0</div>
            <div class="metric-label">Last 30 days</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i>
              <span id="saved-change">0%</span> from last month
            </div>
          </div>
          <div class="dashboard-card">
            <h4><i class="fas fa-percentage"></i> Detection Rate</h4>
            <div class="metric-value" id="detection-rate">0%</div>
            <div class="metric-label">Accuracy rate</div>
            <div class="metric-change positive">
              <i class="fas fa-arrow-up"></i>
              <span id="rate-change">0%</span> from last month
            </div>
          </div>
        </div>

        <div class="dashboard-grid">
          <div class="dashboard-card">
            <h4><i class="fas fa-chart-area"></i> Fraud Trends</h4>
            <div class="chart-container">
              <canvas id="fraud-trends-chart"></canvas>
            </div>
          </div>
          <div class="dashboard-card">
            <h4><i class="fas fa-globe"></i> Fraud by Region</h4>
            <div class="chart-container">
              <canvas id="fraud-region-chart"></canvas>
            </div>
          </div>
        </div>

        <div class="dashboard-table-container">
          <h4><i class="fas fa-list"></i> Recent Fraud Alerts</h4>
          <table class="dashboard-table">
            <thead>
              <tr>
                <th>Transaction ID</th>
                <th>Amount</th>
                <th>Risk Score</th>
                <th>Type</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="fraud-alerts-table">
              <!-- Table rows will be populated dynamically -->
            </tbody>
          </table>
        </div>

        <div class="dashboard-card">
          <h4><i class="fas fa-tags"></i> Fraud Types Distribution</h4>
          <div class="fraud-types-container">
            <div class="fraud-type-card">
              <div class="fraud-type-icon">
                <i class="fas fa-credit-card"></i>
              </div>
              <div class="fraud-type-name">Credit Card</div>
              <div class="fraud-type-count" id="credit-card-count">0 cases</div>
            </div>
            <div class="fraud-type-card">
              <div class="fraud-type-icon">
                <i class="fas fa-university"></i>
              </div>
              <div class="fraud-type-name">Wire Transfer</div>
              <div class="fraud-type-count" id="wire-transfer-count">
                0 cases
              </div>
            </div>
            <div class="fraud-type-card">
              <div class="fraud-type-icon">
                <i class="fas fa-shopping-cart"></i>
              </div>
              <div class="fraud-type-name">Online Payment</div>
              <div class="fraud-type-count" id="online-payment-count">
                0 cases
              </div>
            </div>
            <div class="fraud-type-card">
              <div class="fraud-type-icon">
                <i class="fas fa-mobile-alt"></i>
              </div>
              <div class="fraud-type-name">Mobile Payment</div>
              <div class="fraud-type-count" id="mobile-payment-count">
                0 cases
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Case Management Page -->
    <div id="case-management-page" class="case-management-page">
      <div class="container">
        <div class="case-header">
          <h2 class="case-title">Case Management System</h2>
          <div class="case-controls">
            <button class="case-btn" id="new-case-btn">
              <i class="fas fa-plus"></i> New Case
            </button>
            <div class="download-options" id="cases-export-options">
              <button class="case-btn" id="export-cases-btn">
                <i class="fas fa-download"></i> Export
              </button>
              <div class="download-dropdown">
                <a
                  href="#"
                  class="download-option"
                  data-format="pdf"
                  data-source="cases"
                >
                  <i class="fas fa-file-pdf"></i> PDF
                </a>
                <a
                  href="#"
                  class="download-option"
                  data-format="excel"
                  data-source="cases"
                >
                  <i class="fas fa-file-excel"></i> Excel
                </a>
                <a
                  href="#"
                  class="download-option"
                  data-format="word"
                  data-source="cases"
                >
                  <i class="fas fa-file-word"></i> Word
                </a>
                <a
                  href="#"
                  class="download-option"
                  data-format="csv"
                  data-source="cases"
                >
                  <i class="fas fa-file-csv"></i> CSV
                </a>
              </div>
            </div>
            <button class="case-btn" id="back-to-home-from-cases">
              <i class="fas fa-arrow-left"></i> Back to Home
            </button>
          </div>
        </div>

        <div class="case-filters">
          <div class="filter-group">
            <label for="status-filter">Status</label>
            <select id="status-filter">
              <option value="">All Status</option>
              <option value="new">New</option>
              <option value="investigating">Investigating</option>
              <option value="resolved">Resolved</option>
              <option value="closed">Closed</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="priority-filter">Priority</label>
            <select id="priority-filter">
              <option value="">All Priorities</option>
              <option value="high">High</option>
              <option value="medium">Medium</option>
              <option value="low">Low</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="assigned-filter">Assigned To</label>
            <select id="assigned-filter">
              <option value="">All Team Members</option>
              <option value="john">John Smith</option>
              <option value="sarah">Sarah Johnson</option>
              <option value="mike">Mike Davis</option>
              <option value="emily">Emily Wilson</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="search-filter">Search</label>
            <input
              type="text"
              id="search-filter"
              placeholder="Case ID or Transaction ID"
            />
          </div>
        </div>

        <div class="case-stats-container">
          <div class="case-stat-card">
            <div class="case-stat-title">
              <i class="fas fa-folder-open"></i> Total Cases
            </div>
            <div class="case-stat-value" id="total-cases">0</div>
          </div>
          <div class="case-stat-card">
            <div class="case-stat-title">
              <i class="fas fa-clock"></i> New Cases
            </div>
            <div class="case-stat-value" id="new-cases">0</div>
          </div>
          <div class="case-stat-card">
            <div class="case-stat-title">
              <i class="fas fa-search"></i> Investigating
            </div>
            <div class="case-stat-value" id="investigating-cases">0</div>
          </div>
          <div class="case-stat-card">
            <div class="case-stat-title">
              <i class="fas fa-check-circle"></i> Resolved
            </div>
            <div class="case-stat-value" id="resolved-cases">0</div>
          </div>
        </div>

        <div class="case-table-container">
          <h4><i class="fas fa-list"></i> Fraud Cases</h4>
          <table class="case-table">
            <thead>
              <tr>
                <th>Case ID</th>
                <th>Transaction ID</th>
                <th>Date</th>
                <th>Priority</th>
                <th>Status</th>
                <th>Assigned To</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="cases-table">
              <!-- Table rows will be populated dynamically -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Case Detail Modal -->
    <div class="modal" id="case-detail-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="modal-case-title">Case Details</h3>
          <button class="modal-close" id="close-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-info-circle"></i> Case Information
            </h4>
            <div class="detail-grid">
              <div class="detail-item">
                <div class="detail-label">Case ID</div>
                <div class="detail-value" id="detail-case-id">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Transaction ID</div>
                <div class="detail-value" id="detail-transaction-id">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Date Created</div>
                <div class="detail-value" id="detail-date">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Priority</div>
                <div class="detail-value" id="detail-priority">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Status</div>
                <div class="detail-value" id="detail-status">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Assigned To</div>
                <div class="detail-value" id="detail-assigned">-</div>
              </div>
            </div>
          </div>

          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-file-invoice-dollar"></i> Transaction Details
            </h4>
            <div id="transaction-details-container">
              <!-- Transaction details will be populated dynamically -->
            </div>
          </div>

          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-history"></i> Investigation Workflow
            </h4>
            <div class="timeline" id="case-timeline">
              <!-- Timeline items will be populated dynamically -->
            </div>
          </div>

          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-folder-open"></i> Evidence Collection
            </h4>
            <div class="evidence-list" id="evidence-list">
              <!-- Evidence items will be populated dynamically -->
            </div>
          </div>

          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-sticky-note"></i> Team Notes
            </h4>
            <div class="notes-container" id="notes-container">
              <!-- Notes will be populated dynamically -->
            </div>
            <div class="add-note-form">
              <textarea
                class="form-textarea"
                id="new-note"
                placeholder="Add a new note..."
              ></textarea>
              <button class="btn-primary" id="add-note-btn">
                <i class="fas fa-plus"></i> Add Note
              </button>
            </div>
          </div>

          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-check-circle"></i> Resolution Tracking
            </h4>
            <div class="detail-grid">
              <div class="detail-item">
                <div class="detail-label">Resolution Date</div>
                <div class="detail-value" id="detail-resolution-date">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Resolution Type</div>
                <div class="detail-value" id="detail-resolution-type">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Amount Recovered</div>
                <div class="detail-value" id="detail-amount-recovered">-</div>
              </div>
              <div class="detail-item">
                <div class="detail-label">Effectiveness</div>
                <div class="detail-value" id="detail-effectiveness">-</div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn-secondary" id="close-modal-btn">Close</button>
          <button class="btn-primary" id="save-case-btn">Save Changes</button>
        </div>
      </div>
    </div>

    <!-- New Case Modal -->
    <div class="modal" id="new-case-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">Create New Case</h3>
          <button class="modal-close" id="close-new-case-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form class="new-case-form" id="new-case-form">
            <div class="form-row">
              <div class="form-group">
                <label for="case-transaction-id">Transaction ID</label>
                <select class="form-select" id="case-transaction-id" required>
                  <option value="">Select a transaction</option>
                </select>
              </div>
              <div class="form-group">
                <label for="case-priority">Priority</label>
                <select class="form-select" id="case-priority" required>
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">High</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="case-type">Case Type</label>
                <select class="form-select" id="case-type" required>
                  <option value="credit-card">Credit Card Fraud</option>
                  <option value="identity-theft">Identity Theft</option>
                  <option value="phishing">Phishing</option>
                  <option value="account-takeover">Account Takeover</option>
                  <option value="payment-fraud">Payment Fraud</option>
                </select>
              </div>
              <div class="form-group">
                <label for="case-assigned">Assigned To</label>
                <select class="form-select" id="case-assigned" required>
                  <option value="john">John Smith</option>
                  <option value="sarah">Sarah Johnson</option>
                  <option value="mike">Mike Davis</option>
                  <option value="emily">Emily Wilson</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="case-description">Description</label>
              <textarea
                class="form-textarea"
                id="case-description"
                required
              ></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn-secondary" id="cancel-new-case-btn">Cancel</button>
          <button class="btn-primary" id="create-case-btn">Create Case</button>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title"><i class="fas fa-cog"></i> Settings</h3>
          <button class="modal-close" id="close-settings-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <!-- Appearance -->
          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-palette"></i> Appearance
            </h4>
            <div class="detail-grid">
              <div class="detail-item">
                <label class="detail-label">Theme</label>
                <select id="theme-select" class="form-select">
                  <option value="dark">Dark</option>
                  <option value="light">Light</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Language -->
          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-language"></i> Language
            </h4>
            <div class="detail-grid">
              <div class="detail-item">
                <label class="detail-label">Interface Language</label>
                <select id="language-select" class="form-select">
                  <option value="en">English</option>
                  <option value="es">EspaÃ±ol</option>
                  <option value="fr">FranÃ§ais</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Notifications -->
          <div class="case-detail-section">
            <h4 class="section-title">
              <i class="fas fa-bell"></i> Notifications
            </h4>
            <div class="detail-item">
              <label class="detail-label">
                <input type="checkbox" id="realtime-alerts-toggle" /> Enable
                real-time fraud alerts
              </label>
            </div>
            <div class="detail-item">
              <label class="detail-label">
                <input type="checkbox" id="browser-notifications-toggle" />
                Enable browser notifications
              </label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn-secondary" id="close-settings-btn">Close</button>
          <button class="btn-primary" id="save-settings-btn">
            Save Settings
          </button>
        </div>
      </div>
    </div>

    <!-- Enhanced Login Modal -->
    <div class="auth-modal" id="login-modal">
      <div class="auth-content">
        <div class="auth-header">
          <h3 class="auth-title">Login to Fraudshield Pro</h3>
          <button class="auth-close" id="close-login-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="auth-loading" id="login-loading">
          <div class="spinner"></div>
          <p>Authenticating...</p>
        </div>

        <div class="auth-success" id="login-success">
          <div class="success-icon">
            <i class="fas fa-check-circle"></i>
          </div>
          <h4>Login Successful!</h4>
          <p>Redirecting to your dashboard...</p>
        </div>
<!-- Desktop Nav -->
<li>
  <a href="#network-3d"><i class="fas fa-project-diagram"></i> 3D Network</a>
</li>

<!-- Mobile Nav -->
<li>
  <a href="#network-3d"><i class="fas fa-project-diagram"></i> 3D Network</a>
</li>
<!-- 3D Network Visualization Section -->
<section id="network-3d" class="card" style="display: none; height: 500px; position: relative;">
  <h3><i class="fas fa-project-diagram"></i> Fraud Transaction Network (3D)</h3>
  <div id="3d-network-container" style="width: 100%; height: calc(100% - 40px); border-radius: 12px; overflow: hidden;">
    <!-- Three.js canvas will render here -->
  </div>
</section>
        <form class="auth-form" id="login-form">
          <div class="form-group">
            <label for="login-email">Email Address</label>
            <div class="input-group">
              <input
                type="email"
                id="login-email"
                class="form-input"
                required
                placeholder="you@example.com"
              />
              <i class="fas fa-envelope input-icon"></i>
            </div>
            <div class="form-error" id="login-email-error">
              Please enter a valid email address
            </div>
          </div>

          <div class="form-group">
            <label for="login-password">Password</label>
            <div class="input-group">
              <input
                type="password"
                id="login-password"
                class="form-input"
                required
                placeholder="Enter your password"
              />
              <i class="fas fa-eye input-icon" id="toggle-login-password"></i>
            </div>
            <div class="form-error" id="login-password-error">
              Password is required
            </div>
          </div>

          <div class="remember-me">
            <input type="checkbox" id="remember-me" />
            <label for="remember-me">Remember me for 30 days</label>
          </div>

          <button type="submit" class="btn-primary" style="width: 100%">
            <i class="fas fa-sign-in-alt"></i> Login
          </button>

          <div class="forgot-password">
            <a href="#" id="forgot-password-link">Forgot your password?</a>
          </div>
        </form>

        <div class="social-login">
          <div class="social-login-title">Or continue with</div>
          <div class="social-buttons">
            <a href="#" class="social-btn google">
              <i class="fab fa-google"></i> Google
            </a>
            <a href="#" class="social-btn github">
              <i class="fab fa-github"></i> GitHub
            </a>
            <a href="#" class="social-btn microsoft">
              <i class="fab fa-microsoft"></i> Microsoft
            </a>
          </div>
        </div>

        <div class="auth-switch">
          <p>
            Don't have an account? <a href="#" id="switch-to-signup">Sign Up</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Enhanced Signup Modal -->
    <div class="auth-modal" id="signup-modal">
      <div class="auth-content">
        <div class="auth-header">
          <h3 class="auth-title">Create Account</h3>
          <button class="auth-close" id="close-signup-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="auth-loading" id="signup-loading">
          <div class="spinner"></div>
          <p>Creating your account...</p>
        </div>

        <div class="auth-success" id="signup-success">
          <div class="success-icon">
            <i class="fas fa-check-circle"></i>
          </div>
          <h4>Account Created!</h4>
          <p>Welcome to Fraudshield Pro!</p>
        </div>

        <form class="auth-form" id="signup-form">
          <div class="form-group">
            <label for="signup-name">Full Name</label>
            <div class="input-group">
              <input
                type="text"
                id="signup-name"
                class="form-input"
                required
                placeholder="John Doe"
              />
              <i class="fas fa-user input-icon"></i>
            </div>
            <div class="form-error" id="signup-name-error">
              Please enter your full name
            </div>
          </div>

          <div class="form-group">
            <label for="signup-email">Email Address</label>
            <div class="input-group">
              <input
                type="email"
                id="signup-email"
                class="form-input"
                required
                placeholder="you@example.com"
              />
              <i class="fas fa-envelope input-icon"></i>
            </div>
            <div class="form-error" id="signup-email-error">
              Please enter a valid email address
            </div>
          </div>

          <div class="form-group">
            <label for="signup-password">Password</label>
            <div class="input-group">
              <input
                type="password"
                id="signup-password"
                class="form-input"
                required
                placeholder="Create a strong password"
              />
              <i class="fas fa-eye input-icon" id="toggle-signup-password"></i>
            </div>
            <div class="password-strength" id="password-strength">
              <div class="password-strength-bar"></div>
            </div>
            <div class="password-requirements">
              <div class="requirement" id="req-length">
                <i class="fas fa-times-circle"></i> At least 8 characters
              </div>
              <div class="requirement" id="req-uppercase">
                <i class="fas fa-times-circle"></i> One uppercase letter
              </div>
              <div class="requirement" id="req-lowercase">
                <i class="fas fa-times-circle"></i> One lowercase letter
              </div>
              <div class="requirement" id="req-number">
                <i class="fas fa-times-circle"></i> One number
              </div>
              <div class="requirement" id="req-special">
                <i class="fas fa-times-circle"></i> One special character
              </div>
            </div>
            <div class="form-error" id="signup-password-error">
              Password does not meet requirements
            </div>
          </div>

          <div class="form-group">
            <label for="signup-confirm-password">Confirm Password</label>
            <div class="input-group">
              <input
                type="password"
                id="signup-confirm-password"
                class="form-input"
                required
                placeholder="Confirm your password"
              />
              <i class="fas fa-eye input-icon" id="toggle-confirm-password"></i>
            </div>
            <div class="form-error" id="signup-confirm-error">
              Passwords do not match
            </div>
          </div>

          <div class="remember-me">
            <input type="checkbox" id="agree-terms" required />
            <label for="agree-terms"
              >I agree to the Terms of Service and Privacy Policy</label
            >
          </div>

          <button type="submit" class="btn-primary" style="width: 100%">
            <i class="fas fa-user-plus"></i> Create Account
          </button>
        </form>

        <div class="social-login">
          <div class="social-login-title">Or sign up with</div>
          <div class="social-buttons">
            <a href="#" class="social-btn google">
              <i class="fab fa-google"></i> Google
            </a>
            <a href="#" class="social-btn github">
              <i class="fab fa-github"></i> GitHub
            </a>
            <a href="#" class="social-btn microsoft">
              <i class="fab fa-microsoft"></i> Microsoft
            </a>
          </div>
        </div>

        <div class="auth-switch">
          <p>
            Already have an account? <a href="#" id="switch-to-login">Login</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Real-time Fraud Alert -->
    <div class="realtime-alert" id="realtime-alert">
      <div class="realtime-alert-header">
        <span class="realtime-alert-title">
          <i class="fas fa-exclamation-triangle"></i> Real-time Fraud Alert
        </span>
        <button class="realtime-alert-close" id="close-realtime-alert">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="realtime-alert-content" id="realtime-alert-content">
        <!-- Alert content will be populated dynamically -->
      </div>
    </div>

    <!-- Notification Toast -->
    <div class="notification-toast" id="notification-toast"></div>

    <!-- Location Modal -->
    <div class="location-modal" id="location-modal">
      <div class="location-content">
        <div class="location-header">
          <h3 class="location-title">
            <i class="fas fa-map-marker-alt"></i> Transaction Locations
          </h3>
          <button class="location-close" id="close-location-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="location-grid" id="location-grid">
          <!-- Location cards will be populated dynamically -->
        </div>
        <div class="location-transactions" id="location-transactions">
          <!-- Location transactions will be populated dynamically -->
        </div>
      </div>
    </div>

    <script>
      // ===== ENHANCED AUTHENTICATION STATE =====
      let isLoggedIn = false;
      let currentUser = null;
      let authToken = null;
      const validUsers = [
        {
          email: "user@example.com",
          password: "password123",
          name: "Demo User",
          id: "user_001",
          role: "admin",
          createdAt: new Date("2023-01-01"),
        },
        {
          email: "admin@fraudshield.com",
          password: "admin123",
          name: "Admin User",
          id: "admin_001",
          role: "superadmin",
          createdAt: new Date("2023-01-01"),
        },
      ];

      // Global variables
      let uploadedData = null;
      let realtimeInterval = null;
      let casesData = [];
      let currentCaseId = null;
      let pendingDownload = null; // Store download request for after login
      let locationData = {}; // Store location data

      // Mobile menu functionality
      const menuToggle = document.getElementById("menu-toggle");
      const mobileMenu = document.getElementById("mobile-menu");
      const mobileMenuOverlay = document.getElementById("mobile-menu-overlay");
      const closeMobileMenu = document.getElementById("close-mobile-menu");

      function openMobileMenu() {
        menuToggle.classList.add("open");
        mobileMenu.classList.add("active");
        mobileMenuOverlay.classList.add("active");
        document.body.style.overflow = "hidden";
      }

      function closeMobileMenuFunc() {
        menuToggle.classList.remove("open");
        mobileMenu.classList.remove("active");
        mobileMenuOverlay.classList.remove("active");
        document.body.style.overflow = "";
      }

      menuToggle.addEventListener("click", openMobileMenu);
      closeMobileMenu.addEventListener("click", closeMobileMenuFunc);
      mobileMenuOverlay.addEventListener("click", closeMobileMenuFunc);

      // Page navigation
      const homePage = document.getElementById("home-page");
      const dashboardPage = document.getElementById("dashboard-page");
      const caseManagementPage = document.getElementById(
        "case-management-page"
      );
      const dashboardLink = document.getElementById("dashboard-link");
      const mobileDashboardLink = document.getElementById(
        "mobile-dashboard-link"
      );
      const caseManagementLink = document.getElementById(
        "case-management-link"
      );
      const mobileCaseManagementLink = document.getElementById(
        "mobile-case-management-link"
      );
      const backToHome = document.getElementById("back-to-home");
      const backToHomeFromCases = document.getElementById(
        "back-to-home-from-cases"
      );
      const viewDashboardBtn = document.getElementById("view-dashboard-btn");

      function showDashboard() {
        homePage.style.display = "none";
        caseManagementPage.classList.remove("active");
        dashboardPage.classList.add("active");
        closeMobileMenuFunc();

        // Initialize dashboard with uploaded data
        if (uploadedData) {
          initializeDashboard(uploadedData);
          startRealtimeDetection();
        }
      }

      function showCaseManagement() {
        homePage.style.display = "none";
        dashboardPage.classList.remove("active");
        caseManagementPage.classList.add("active");
        closeMobileMenuFunc();

        // Initialize case management
        initializeCaseManagement();
      }

      function showHome() {
        dashboardPage.classList.remove("active");
        caseManagementPage.classList.remove("active");
        homePage.style.display = "block";
        stopRealtimeDetection();
      }

      dashboardLink.addEventListener("click", (e) => {
        e.preventDefault();
        if (uploadedData) {
          showDashboard();
        } else {
          showNotification("Please upload data first to access the dashboard.");
        }
      });

      mobileDashboardLink.addEventListener("click", (e) => {
        e.preventDefault();
        if (uploadedData) {
          showDashboard();
        } else {
          showNotification("Please upload data first to access the dashboard.");
        }
      });

      caseManagementLink.addEventListener("click", (e) => {
        e.preventDefault();
        if (uploadedData) {
          showCaseManagement();
        } else {
          showNotification(
            "Please upload data first to access the case management system."
          );
        }
      });

      mobileCaseManagementLink.addEventListener("click", (e) => {
        e.preventDefault();
        if (uploadedData) {
          showCaseManagement();
        } else {
          showNotification(
            "Please upload data first to access the case management system."
          );
        }
      });

      backToHome.addEventListener("click", showHome);
      backToHomeFromCases.addEventListener("click", showHome);
      viewDashboardBtn.addEventListener("click", showDashboard);

      // Download options functionality
      const downloadOptions = document.querySelectorAll(".download-options");

      downloadOptions.forEach((option) => {
        const button = option.querySelector("button");
        const dropdown = option.querySelector(".download-dropdown");

        button.addEventListener("click", (e) => {
          e.preventDefault();
          e.stopPropagation();

          // Close all other dropdowns
          downloadOptions.forEach((otherOption) => {
            if (otherOption !== option) {
              otherOption.classList.remove("active");
            }
          });

          // Toggle current dropdown
          option.classList.toggle("active");
        });

        // Handle format selection
        const formatOptions = option.querySelectorAll(".download-option");
        formatOptions.forEach((formatOption) => {
          formatOption.addEventListener("click", (e) => {
            e.preventDefault();
            const format = formatOption.getAttribute("data-format");
            const source =
              formatOption.getAttribute("data-source") || "analysis";

            // Close dropdown
            option.classList.remove("active");

            // Check if user is logged in
            if (!isLoggedIn) {
              // Store download request for after login
              pendingDownload = { format, source };
              showNotification("Please log in to download reports.");
              showLoginModal();
              return;
            }

            // Process download
            downloadData(format, source);
          });
        });
      });

      // Close dropdowns when clicking outside
      document.addEventListener("click", () => {
        downloadOptions.forEach((option) => {
          option.classList.remove("active");
        });
      });

      // Location button functionality
      const locationBtn = document.getElementById("location-btn");
      const locationModal = document.getElementById("location-modal");
      const closeLocationModal = document.getElementById(
        "close-location-modal"
      );

      locationBtn.addEventListener("click", () => {
        if (!uploadedData) {
          showNotification("Please upload data first to view locations.");
          return;
        }
        populateLocationModal();
        locationModal.classList.add("active");
      });

      closeLocationModal.addEventListener("click", () => {
        locationModal.classList.remove("active");
      });

      // Populate location modal
      function populateLocationModal() {
        const locationGrid = document.getElementById("location-grid");
        const locationTransactions = document.getElementById(
          "location-transactions"
        );

        // Clear existing content
        locationGrid.innerHTML = "";
        locationTransactions.innerHTML = "";

        // Extract unique locations and calculate statistics
        const locations = {};
        uploadedData.forEach((transaction) => {
          const location = transaction.location;
          if (!locations[location]) {
            locations[location] = {
              name: location,
              totalTransactions: 0,
              fraudTransactions: 0,
              suspiciousTransactions: 0,
              legitimateTransactions: 0,
              totalAmount: 0,
              fraudAmount: 0,
              transactions: [],
            };
          }

          locations[location].totalTransactions++;
          locations[location].totalAmount += transaction.amount;
          locations[location].transactions.push(transaction);

          if (transaction.status === "fraud") {
            locations[location].fraudTransactions++;
            locations[location].fraudAmount += transaction.amount;
          } else if (transaction.status === "suspicious") {
            locations[location].suspiciousTransactions++;
          } else {
            locations[location].legitimateTransactions++;
          }
        });

        // Store location data for later use
        locationData = locations;

        // Create location cards
        Object.values(locations).forEach((location) => {
          const locationCard = document.createElement("div");
          locationCard.classList.add("location-card");
          locationCard.innerHTML = `
            <div class="location-name">
              <i class="fas fa-map-marker-alt"></i> ${location.name}
            </div>
            <div class="location-stats">
              <div class="location-stat">
                <span class="location-stat-label">Total:</span>
                <span class="location-stat-value">${
                  location.totalTransactions
                }</span>
              </div>
              <div class="location-stat">
                <span class="location-stat-label">Fraud:</span>
                <span class="location-stat-value" style="color: var(--error)">${
                  location.fraudTransactions
                }</span>
              </div>
              <div class="location-stat">
                <span class="location-stat-label">Suspicious:</span>
                <span class="location-stat-value" style="color: var(--warning)">${
                  location.suspiciousTransactions
                }</span>
              </div>
              <div class="location-stat">
                <span class="location-stat-label">Amount:</span>
                <span class="location-stat-value">$${location.totalAmount.toFixed(
                  2
                )}</span>
              </div>
            </div>
          `;

          // Add click event to show transactions for this location
          locationCard.addEventListener("click", () => {
            showLocationTransactions(location);
          });

          locationGrid.appendChild(locationCard);
        });

        // Initially show transactions for the first location
        const firstLocation = Object.values(locations)[0];
        if (firstLocation) {
          showLocationTransactions(firstLocation);
        }
      }

      // Show transactions for a specific location
      function showLocationTransactions(location) {
        const locationTransactions = document.getElementById(
          "location-transactions"
        );

        locationTransactions.innerHTML = `
          <h3 class="location-transactions-title">
            <i class="fas fa-map-marker-alt"></i> Transactions from ${
              location.name
            }
          </h3>
          <table class="location-transactions-table">
            <thead>
              <tr>
                <th>Transaction ID</th>
                <th>Amount</th>
                <th>Type</th>
                <th>Date</th>
                <th>Risk Score</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${location.transactions
                .map(
                  (transaction) => `
                <tr>
                  <td>${transaction.id}</td>
                  <td>$${transaction.amount.toFixed(2)}</td>
                  <td>${transaction.type}</td>
                  <td>${new Date(transaction.date).toLocaleDateString()}</td>
                  <td>${transaction.riskScore}%</td>
                  <td><span class="status-badge status-${transaction.status}">${
                    transaction.status.charAt(0).toUpperCase() +
                    transaction.status.slice(1)
                  }</span></td>
                </tr>
              `
                )
                .join("")}
            </tbody>
          </table>
        `;
      }

      // ===== ENHANCED DOWNLOAD FUNCTIONS =====

      // Generate sample data for testing
      function generateSampleData() {
        const sampleData = [];
        const types = [
          "Credit Card",
          "Wire Transfer",
          "Online Payment",
          "Mobile Payment",
          "Bank Transfer",
        ];
        const locations = [
          "USA",
          "UK",
          "Canada",
          "Australia",
          "Germany",
          "France",
          "Japan",
          "India",
          "Brazil",
          "Mexico",
        ];
        const devices = ["Desktop", "Mobile", "Tablet", "ATM", "POS"];

        for (let i = 0; i < 100; i++) {
          const riskScore = Math.random() * 100;
          let status = "legitimate";
          if (riskScore >= 80) status = "fraud";
          else if (riskScore >= 60) status = "suspicious";

          sampleData.push({
            id: `TXN${String(i + 1).padStart(6, "0")}`,
            amount: Math.random() * 10000 + 10,
            type: types[Math.floor(Math.random() * types.length)],
            date: new Date(
              Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000
            ).toISOString(),
            location: locations[Math.floor(Math.random() * locations.length)],
            device: devices[Math.floor(Math.random() * devices.length)],
            riskScore: Math.round(riskScore),
            status: status,
            originalData: {
              transaction_id: `TXN${String(i + 1).padStart(6, "0")}`,
              amount: (Math.random() * 10000 + 10).toFixed(2),
              merchant: `Merchant ${Math.floor(Math.random() * 100)}`,
              category: types[Math.floor(Math.random() * types.length)],
            },
          });
        }
        return sampleData;
      }

      // Download data function with proper file generation
      function downloadData(format, source) {
        if (!uploadedData) {
          // Generate sample data if no data is uploaded
          uploadedData = generateSampleData();
          showNotification("Using sample data for demonstration");
        }

        switch (format) {
          case "pdf":
            downloadAsPDF(source);
            break;
          case "excel":
            downloadAsExcel(source);
            break;
          case "word":
            downloadAsWord(source);
            break;
          case "csv":
            downloadAsCSV(source);
            break;
          default:
            showNotification("Invalid format selected.");
        }
      }

      // Download as PDF - Fixed
      function downloadAsPDF(source) {
        try {
          const { jsPDF } = window.jspdf;
          const doc = new jsPDF();

          // Add title
          doc.setFontSize(18);
          doc.text("Fraudshield Pro Report", 105, 20, { align: "center" });

          // Add date
          doc.setFontSize(12);
          doc.text(`Generated: ${new Date().toLocaleDateString()}`, 105, 30, {
            align: "center",
          });

          // Add user info if logged in
          if (isLoggedIn && currentUser) {
            doc.text(
              `Generated by: ${currentUser.name} (${currentUser.email})`,
              105,
              40,
              { align: "center" }
            );
          }

          // Add content based on source
          let yPosition = 60;

          if (source === "analysis" || source === "dashboard") {
            // Add summary statistics
            doc.setFontSize(14);
            doc.text("Summary Statistics", 20, yPosition);
            yPosition += 10;

            doc.setFontSize(12);
            const legitimate = uploadedData.filter(
              (t) => t.status === "legitimate"
            ).length;
            const suspicious = uploadedData.filter(
              (t) => t.status === "suspicious"
            ).length;
            const fraud = uploadedData.filter(
              (t) => t.status === "fraud"
            ).length;

            doc.text(`Legitimate Transactions: ${legitimate}`, 20, yPosition);
            yPosition += 7;
            doc.text(`Suspicious Transactions: ${suspicious}`, 20, yPosition);
            yPosition += 7;
            doc.text(`Fraudulent Transactions: ${fraud}`, 20, yPosition);
            yPosition += 15;

            // Add top transactions
            doc.setFontSize(14);
            doc.text("High-Risk Transactions", 20, yPosition);
            yPosition += 10;

            doc.setFontSize(10);
            const highRiskTransactions = uploadedData
              .filter((t) => t.status === "fraud" || t.status === "suspicious")
              .sort((a, b) => b.riskScore - a.riskScore)
              .slice(0, 10);

            highRiskTransactions.forEach((transaction) => {
              if (yPosition > 270) {
                doc.addPage();
                yPosition = 20;
              }

              doc.text(
                `ID: ${transaction.id} | Amount: $${transaction.amount.toFixed(
                  2
                )} | Risk: ${transaction.riskScore}%`,
                20,
                yPosition
              );
              yPosition += 7;
            });
          } else if (source === "cases") {
            // Add case summary
            doc.setFontSize(14);
            doc.text("Case Summary", 20, yPosition);
            yPosition += 10;

            doc.setFontSize(12);
            doc.text(`Total Cases: ${casesData.length}`, 20, yPosition);
            yPosition += 7;
            doc.text(
              `New Cases: ${
                casesData.filter((c) => c.status === "new").length
              }`,
              20,
              yPosition
            );
            yPosition += 7;
            doc.text(
              `Investigating: ${
                casesData.filter((c) => c.status === "investigating").length
              }`,
              20,
              yPosition
            );
            yPosition += 7;
            doc.text(
              `Resolved: ${
                casesData.filter((c) => c.status === "resolved").length
              }`,
              20,
              yPosition
            );
            yPosition += 15;

            // Add case details
            doc.setFontSize(14);
            doc.text("Case Details", 20, yPosition);
            yPosition += 10;

            doc.setFontSize(10);
            casesData.forEach((caseObj) => {
              if (yPosition > 270) {
                doc.addPage();
                yPosition = 20;
              }

              doc.text(
                `ID: ${caseObj.id} | Priority: ${caseObj.priority} | Status: ${caseObj.status}`,
                20,
                yPosition
              );
              yPosition += 7;
            });
          }

          // Save the PDF
          const fileName = `fraudshield-${source}-${
            new Date().toISOString().split("T")[0]
          }.pdf`;
          doc.save(fileName);

          showNotification(`Report downloaded as ${fileName}`);
        } catch (error) {
          console.error("PDF generation error:", error);
          showNotification("Error generating PDF report. Please try again.");
        }
      }

      // Download as Excel - Fixed
      function downloadAsExcel(source) {
        try {
          let data = [];
          let fileName = "";

          if (source === "analysis" || source === "dashboard") {
            // Prepare transaction data
            data = uploadedData.map((transaction) => ({
              "Transaction ID": transaction.id,
              Amount: transaction.amount,
              Type: transaction.type,
              Date: new Date(transaction.date).toLocaleDateString(),
              Location: transaction.location,
              Device: transaction.device,
              "Risk Score": transaction.riskScore,
              Status: transaction.status,
            }));
            fileName = `fraudshield-transactions-${
              new Date().toISOString().split("T")[0]
            }.xlsx`;
          } else if (source === "cases") {
            // Prepare case data
            data = casesData.map((caseObj) => ({
              "Case ID": caseObj.id,
              "Transaction ID": caseObj.transactionId,
              Title: caseObj.title,
              Date: new Date(caseObj.date).toLocaleDateString(),
              Priority: caseObj.priority,
              Status: caseObj.status,
              "Assigned To": caseObj.assignedTo,
              Description: caseObj.description,
            }));
            fileName = `fraudshield-cases-${
              new Date().toISOString().split("T")[0]
            }.xlsx`;
          }

          // Create workbook and worksheet
          const ws = XLSX.utils.json_to_sheet(data);
          const wb = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(
            wb,
            ws,
            source === "cases" ? "Cases" : "Transactions"
          );

          // Save the file
          XLSX.writeFile(wb, fileName);

          showNotification(`Report downloaded as ${fileName}`);
        } catch (error) {
          console.error("Excel generation error:", error);
          showNotification("Error generating Excel report. Please try again.");
        }
      }

      // Download as Word - Fixed
      function downloadAsWord(source) {
        try {
          // Create a temporary container for the content
          const tempContainer = document.createElement("div");
          tempContainer.style.position = "absolute";
          tempContainer.style.left = "-9999px";
          tempContainer.style.width = "800px";
          tempContainer.style.padding = "20px";
          tempContainer.style.fontFamily = "Arial, sans-serif";
          tempContainer.style.color = "#000";
          tempContainer.style.backgroundColor = "#fff";

          // Add title
          const title = document.createElement("h1");
          title.textContent = "Fraudshield Pro Report";
          title.style.textAlign = "center";
          title.style.marginBottom = "10px";
          tempContainer.appendChild(title);

          // Add date
          const date = document.createElement("p");
          date.textContent = `Generated: ${new Date().toLocaleDateString()}`;
          date.style.textAlign = "center";
          date.style.marginBottom = "20px";
          tempContainer.appendChild(date);

          // Add user info if logged in
          if (isLoggedIn && currentUser) {
            const userInfo = document.createElement("p");
            userInfo.textContent = `Generated by: ${currentUser.name} (${currentUser.email})`;
            userInfo.style.textAlign = "center";
            userInfo.style.marginBottom = "20px";
            tempContainer.appendChild(userInfo);
          }

          // Add content based on source
          if (source === "analysis" || source === "dashboard") {
            // Add summary statistics
            const summaryTitle = document.createElement("h2");
            summaryTitle.textContent = "Summary Statistics";
            tempContainer.appendChild(summaryTitle);

            const legitimate = uploadedData.filter(
              (t) => t.status === "legitimate"
            ).length;
            const suspicious = uploadedData.filter(
              (t) => t.status === "suspicious"
            ).length;
            const fraud = uploadedData.filter(
              (t) => t.status === "fraud"
            ).length;

            const statsList = document.createElement("ul");
            statsList.innerHTML = `
       <li>Legitimate Transactions: ${legitimate}</li>
       <li>Suspicious Transactions: ${suspicious}</li>
       <li>Fraudulent Transactions: ${fraud}</li>
      `;
            tempContainer.appendChild(statsList);

            // Add top transactions
            const transactionsTitle = document.createElement("h2");
            transactionsTitle.textContent = "High-Risk Transactions";
            transactionsTitle.style.marginTop = "20px";
            tempContainer.appendChild(transactionsTitle);

            const transactionsTable = document.createElement("table");
            transactionsTable.style.width = "100%";
            transactionsTable.style.borderCollapse = "collapse";
            transactionsTable.style.marginTop = "10px";

            // Add table header
            const headerRow = document.createElement("tr");
            headerRow.innerHTML = `
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Transaction ID</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Amount</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Type</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Risk Score</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Status</th>
      `;
            transactionsTable.appendChild(headerRow);

            // Add table rows
            const highRiskTransactions = uploadedData
              .filter((t) => t.status === "fraud" || t.status === "suspicious")
              .sort((a, b) => b.riskScore - a.riskScore)
              .slice(0, 10);

            highRiskTransactions.forEach((transaction) => {
              const row = document.createElement("tr");
              row.innerHTML = `
        <td style="border: 1px solid #ddd; padding: 8px;">${transaction.id}</td>
        <td style="border: 1px solid #ddd; padding: 8px;">$${transaction.amount.toFixed(
          2
        )}</td>
        <td style="border: 1px solid #ddd; padding: 8px;">${
          transaction.type
        }</td>
        <td style="border: 1px solid #ddd; padding: 8px;">${
          transaction.riskScore
        }%</td>
        <td style="border: 1px solid #ddd; padding: 8px;">${
          transaction.status
        }</td>
       `;
              transactionsTable.appendChild(row);
            });

            tempContainer.appendChild(transactionsTable);
          } else if (source === "cases") {
            // Add case summary
            const summaryTitle = document.createElement("h2");
            summaryTitle.textContent = "Case Summary";
            tempContainer.appendChild(summaryTitle);

            const statsList = document.createElement("ul");
            statsList.innerHTML = `
       <li>Total Cases: ${casesData.length}</li>
       <li>New Cases: ${casesData.filter((c) => c.status === "new").length}</li>
       <li>Investigating: ${
         casesData.filter((c) => c.status === "investigating").length
       }</li>
       <li>Resolved: ${
         casesData.filter((c) => c.status === "resolved").length
       }</li>
      `;
            tempContainer.appendChild(statsList);

            // Add case details
            const casesTitle = document.createElement("h2");
            casesTitle.textContent = "Case Details";
            casesTitle.style.marginTop = "20px";
            tempContainer.appendChild(casesTitle);

            const casesTable = document.createElement("table");
            casesTable.style.width = "100%";
            casesTable.style.borderCollapse = "collapse";
            casesTable.style.marginTop = "10px";

            // Add table header
            const headerRow = document.createElement("tr");
            headerRow.innerHTML = `
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Case ID</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Transaction ID</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Priority</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Status</th>
       <th style="border: 1px solid #ddd; padding: 8px; background-color: #f2f2f2;">Assigned To</th>
      `;
            casesTable.appendChild(headerRow);

            // Add table rows
            casesData.forEach((caseObj) => {
              const row = document.createElement("tr");
              row.innerHTML = `
        <td style="border: 1px solid #ddd; padding: 8px;">${caseObj.id}</td>
        <td style="border: 1px solid #ddd; padding: 8px;">${caseObj.transactionId}</td>
        <td style="border: 1px solid #ddd; padding: 8px;">${caseObj.priority}</td>
        <td style="border: 1px solid #ddd; padding: 8px;">${caseObj.status}</td>
        <td style="border: 1px solid #ddd; padding: 8px;">${caseObj.assignedTo}</td>
       `;
              casesTable.appendChild(row);
            });

            tempContainer.appendChild(casesTable);
          }

          // Add to document temporarily
          document.body.appendChild(tempContainer);

          // Use html2canvas and jsPDF to create PDF
          html2canvas(tempContainer, {
            scale: 2,
            useCORS: true,
            allowTaint: true,
          }).then((canvas) => {
            const { jsPDF } = window.jspdf;
            const imgData = canvas.toDataURL("image/png");
            const pdf = new jsPDF("p", "mm", "a4");
            const imgWidth = 210;
            const pageHeight = 295;
            const imgHeight = (canvas.height * imgWidth) / canvas.width;
            let heightLeft = imgHeight;
            let position = 0;

            pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;

            while (heightLeft >= 0) {
              position = heightLeft - imgHeight;
              pdf.addPage();
              pdf.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
              heightLeft -= pageHeight;
            }

            // Save the PDF
            const fileName = `fraudshield-${source}-${
              new Date().toISOString().split("T")[0]
            }.pdf`;
            pdf.save(fileName);

            // Remove temporary container
            document.body.removeChild(tempContainer);

            showNotification(`Report downloaded as ${fileName}`);
          });
        } catch (error) {
          console.error("Word generation error:", error);
          showNotification("Error generating Word report. Please try again.");
        }
      }

      // Download as CSV - Fixed
      function downloadAsCSV(source) {
        try {
          let csvContent = "";
          let fileName = "";

          if (source === "analysis" || source === "dashboard") {
            // Create CSV header
            csvContent =
              "Transaction ID,Amount,Type,Date,Location,Device,Risk Score,Status\n";

            // Add transaction data
            uploadedData.forEach((transaction) => {
              csvContent += `${transaction.id},${transaction.amount},${
                transaction.type
              },${new Date(transaction.date).toLocaleDateString()},${
                transaction.location
              },${transaction.device},${transaction.riskScore},${
                transaction.status
              }\n`;
            });

            fileName = `fraudshield-transactions-${
              new Date().toISOString().split("T")[0]
            }.csv`;
          } else if (source === "cases") {
            // Create CSV header
            csvContent =
              "Case ID,Transaction ID,Title,Date,Priority,Status,Assigned To,Description\n";

            // Add case data
            casesData.forEach((caseObj) => {
              csvContent += `${caseObj.id},${caseObj.transactionId},"${
                caseObj.title
              }",${new Date(caseObj.date).toLocaleDateString()},${
                caseObj.priority
              },${caseObj.status},${caseObj.assignedTo},"${
                caseObj.description
              }"\n`;
            });

            fileName = `fraudshield-cases-${
              new Date().toISOString().split("T")[0]
            }.csv`;
          }

          // Create blob and download
          const blob = new Blob([csvContent], { type: "text/csv" });
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = fileName;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          window.URL.revokeObjectURL(url);

          showNotification(`Report downloaded as ${fileName}`);
        } catch (error) {
          console.error("CSV generation error:", error);
          showNotification("Error generating CSV report. Please try again.");
        }
      }

      // File upload and processing
      const uploadForm = document.getElementById("upload-form");
      const fileInput = document.getElementById("file-upload");
      const resultsPlaceholder = document.getElementById("results-placeholder");
      const progressContainer = document.getElementById("progress-container");
      const progressBar = document.getElementById("progress-bar");
      const analysisResults = document.getElementById("analysis-results");

      // Browse button functionality
      document
        .querySelector(".file-input-container")
        .addEventListener("click", (e) => {
          if (e.target.tagName !== "INPUT") {
            fileInput.click();
          }
        });

      // Process uploaded file
      function processFile(file) {
        if (!file) return;

        // Check file size
        if (file.size > 10 * 1024 * 1024) {
          showNotification("File size exceeds 10MB limit.");
          return;
        }

        // Show progress
        resultsPlaceholder.style.display = "none";
        progressContainer.style.display = "block";
        analysisResults.style.display = "none";

        let progress = 0;
        const progressInterval = setInterval(() => {
          progress += 10;
          progressBar.style.width = `${progress}%`;

          if (progress >= 100) {
            clearInterval(progressInterval);

            // Parse the file based on its type
            const fileType = file.name.split(".").pop().toLowerCase();

            if (fileType === "csv") {
              parseCSV(file);
            } else if (fileType === "json") {
              parseJSON(file);
            } else if (fileType === "xlsx" || fileType === "xls") {
              parseExcel(file);
            }
          }
        }, 200);
      }

      // Parse CSV file
      function parseCSV(file) {
        Papa.parse(file, {
          header: true,
          complete: function (results) {
            processData(results.data);
          },
          error: function (error) {
            showNotification("Error parsing CSV file: " + error.message);
          },
        });
      }

      // Parse JSON file
      function parseJSON(file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          try {
            const data = JSON.parse(e.target.result);
            processData(Array.isArray(data) ? data : [data]);
          } catch (error) {
            showNotification("Error parsing JSON file: " + error.message);
          }
        };
        reader.readAsText(file);
      }

      // Parse Excel file
      function parseExcel(file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: "array" });
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            const jsonData = XLSX.utils.sheet_to_json(firstSheet);
            processData(jsonData);
          } catch (error) {
            showNotification("Error parsing Excel file: " + error.message);
          }
        };
        reader.readAsArrayBuffer(file);
      }

      // Process parsed data
      function processData(data) {
        // Clean and validate data
        const validData = data.filter((row) => {
          return row && Object.keys(row).length > 0;
        });

        if (validData.length === 0) {
          showNotification("No valid data found in the file.");
          return;
        }

        // Add fraud detection analysis
        const analyzedData = validData.map((row, index) => {
          const transaction = {
            id:
              row.id ||
              row.transaction_id ||
              `TXN${String(index + 1).padStart(6, "0")}`,
            amount: parseFloat(
              row.amount || row.transaction_amount || Math.random() * 10000 + 10
            ),
            type:
              row.type || row.transaction_type || getRandomTransactionType(),
            date: row.date || row.transaction_date || new Date().toISOString(),
            location:
              row.location || row.transaction_location || getRandomLocation(),
            device: row.device || row.transaction_device || getRandomDevice(),
            // Store all original data fields
            originalData: { ...row },
          };

          // Calculate fraud risk score
          transaction.riskScore = calculateRiskScore(transaction);
          transaction.status = getFraudStatus(transaction.riskScore);

          return transaction;
        });

        uploadedData = analyzedData;

        // Create cases for fraudulent and suspicious transactions
        createCasesFromTransactions(analyzedData);

        // Update home page results
        updateHomeResults(analyzedData);

        // Show success message
        showNotification(
          `Successfully analyzed ${analyzedData.length} transactions!`
        );
      }

      // Create cases from transactions
      function createCasesFromTransactions(transactions) {
        // Clear existing cases
        casesData = [];

        // Create cases for fraudulent and suspicious transactions
        transactions.forEach((transaction) => {
          if (
            transaction.status === "fraud" ||
            transaction.status === "suspicious"
          ) {
            const caseType = getCaseTypeFromTransaction(transaction);
            const priority = transaction.status === "fraud" ? "high" : "medium";

            const caseObj = {
              id: `CASE${String(casesData.length + 1).padStart(4, "0")}`,
              transactionId: transaction.id,
              title: `${caseType} - ${transaction.id}`,
              date: new Date().toISOString(),
              priority: priority,
              status: "new",
              assignedTo: "Unassigned",
              description: `Investigation of suspected ${caseType.toLowerCase()} involving transaction ${
                transaction.id
              }.`,
              transaction: transaction, // Store the full transaction object
              timeline: [
                {
                  date: new Date().toISOString(),
                  content: "Case created from fraud detection",
                },
              ],
              evidence: [
                {
                  name: "Transaction Record",
                  icon: "fa-file-alt",
                  date: new Date().toISOString(),
                  data: transaction.originalData, // Store original data as evidence
                },
              ],
              notes: [
                {
                  author: "System",
                  date: new Date().toISOString(),
                  content: `High-risk transaction detected: Amount $${transaction.amount.toFixed(
                    2
                  )}, Type: ${transaction.type}, Location: ${
                    transaction.location
                  }, Risk Score: ${transaction.riskScore}%`,
                },
              ],
              resolution: null,
            };

            casesData.push(caseObj);
          }
        });
      }

      // Get case type from transaction
      function getCaseTypeFromTransaction(transaction) {
        const type = transaction.type ? transaction.type.toLowerCase() : "";

        if (type.includes("credit") || type.includes("card")) {
          return "Credit Card Fraud";
        } else if (type.includes("wire") || type.includes("transfer")) {
          return "Wire Transfer Fraud";
        } else if (type.includes("online") || type.includes("payment")) {
          return "Online Payment Fraud";
        } else if (type.includes("mobile")) {
          return "Mobile Payment Fraud";
        } else {
          return "Payment Fraud";
        }
      }

      // Calculate risk score based on various factors
      function calculateRiskScore(transaction) {
        let score = 10; // Base score

        // Amount-based risk
        if (transaction.amount > 5000) score += 20;
        if (transaction.amount > 10000) score += 30;

        // Location-based risk
        const highRiskLocations = ["Nigeria", "Russia", "China", "North Korea"];
        if (highRiskLocations.includes(transaction.location)) score += 25;

        // Device-based risk
        if (transaction.device === "Mobile" && transaction.amount > 1000)
          score += 15;

        // Time-based risk (unusual hours)
        const hour = new Date(transaction.date).getHours();
        if (hour < 6 || hour > 22) score += 10;

        // Random factor for simulation
        score += Math.random() * 20;

        return Math.min(Math.round(score), 100);
      }

      // Get fraud status based on risk score
      function getFraudStatus(riskScore) {
        if (riskScore >= 80) return "fraud";
        if (riskScore >= 60) return "suspicious";
        return "legitimate";
      }

      // Helper functions
      function getRandomTransactionType() {
        const types = [
          "Credit Card",
          "Wire Transfer",
          "Online Payment",
          "Mobile Payment",
          "Bank Transfer",
        ];
        return types[Math.floor(Math.random() * types.length)];
      }

      function getRandomLocation() {
        const locations = [
          "USA",
          "UK",
          "Canada",
          "Australia",
          "Germany",
          "France",
          "Japan",
          "India",
          "Brazil",
          "Mexico",
        ];
        return locations[Math.floor(Math.random() * locations.length)];
      }

      function getRandomDevice() {
        const devices = ["Desktop", "Mobile", "Tablet", "ATM", "POS"];
        return devices[Math.floor(Math.random() * devices.length)];
      }

      // Update home page results
      function updateHomeResults(data) {
        const legitimate = data.filter((t) => t.status === "legitimate").length;
        const suspicious = data.filter((t) => t.status === "suspicious").length;
        const fraud = data.filter((t) => t.status === "fraud").length;

        document.getElementById("legitimate-count").textContent =
          legitimate.toLocaleString();
        document.getElementById("suspicious-count").textContent =
          suspicious.toLocaleString();
        document.getElementById("fraud-count").textContent =
          fraud.toLocaleString();

        progressContainer.style.display = "none";
        analysisResults.style.display = "block";

        // Create charts
        createHomeCharts(data);

        // Display sample results
        displaySampleResults(data);
      }

      // Create home page charts
      function createHomeCharts(data) {
        // Clear existing charts
        Chart.getChart("category-chart")?.destroy();
        Chart.getChart("risk-chart")?.destroy();

        // Category Chart
        const categoryCtx = document
          .getElementById("category-chart")
          .getContext("2d");
        new Chart(categoryCtx, {
          type: "doughnut",
          data: {
            labels: ["Legitimate", "Suspicious", "Fraud"],
            datasets: [
              {
                data: [
                  data.filter((t) => t.status === "legitimate").length,
                  data.filter((t) => t.status === "suspicious").length,
                  data.filter((t) => t.status === "fraud").length,
                ],
                backgroundColor: [
                  "rgba(76, 175, 80, 0.7)",
                  "rgba(255, 152, 0, 0.7)",
                  "rgba(244, 67, 54, 0.7)",
                ],
                borderColor: [
                  "rgba(76, 175, 80, 1)",
                  "rgba(255, 152, 0, 1)",
                  "rgba(244, 67, 54, 1)",
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "bottom",
                labels: {
                  color: "rgba(255, 255, 255, 0.7)",
                  padding: 10,
                  font: {
                    size: 11,
                  },
                },
              },
            },
          },
        });

        // Risk Chart
        const riskCtx = document.getElementById("risk-chart").getContext("2d");
        const riskRanges = {
          "Low Risk (0-40)": 0,
          "Medium Risk (41-70)": 0,
          "High Risk (71-90)": 0,
          "Very High Risk (91-100)": 0,
        };

        data.forEach((transaction) => {
          if (transaction.riskScore <= 40) riskRanges["Low Risk (0-40)"]++;
          else if (transaction.riskScore <= 70)
            riskRanges["Medium Risk (41-70)"]++;
          else if (transaction.riskScore <= 90)
            riskRanges["High Risk (71-90)"]++;
          else riskRanges["Very High Risk (91-100)"]++;
        });

        new Chart(riskCtx, {
          type: "bar",
          data: {
            labels: Object.keys(riskRanges),
            datasets: [
              {
                label: "Transactions",
                data: Object.values(riskRanges),
                backgroundColor: [
                  "rgba(76, 175, 80, 0.7)",
                  "rgba(255, 152, 0, 0.7)",
                  "rgba(255, 193, 7, 0.7)",
                  "rgba(244, 67, 54, 0.7)",
                ],
                borderColor: [
                  "rgba(76, 175, 80, 1)",
                  "rgba(255, 152, 0, 1)",
                  "rgba(255, 193, 7, 1)",
                  "rgba(244, 67, 54, 1)",
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  color: "rgba(255, 255, 255, 0.7)",
                  font: {
                    size: 10,
                  },
                },
                grid: {
                  color: "rgba(255, 255, 255, 0.1)",
                },
              },
              x: {
                ticks: {
                  color: "rgba(255, 255, 255, 0.7)",
                  font: {
                    size: 10,
                  },
                },
                grid: {
                  color: "rgba(255, 255, 255, 0.1)",
                },
              },
            },
            plugins: {
              legend: {
                display: false,
              },
            },
          },
        });
      }

      // Display sample results
      function displaySampleResults(data) {
        const resultsList = document.getElementById("results-list");
        resultsList.innerHTML = "";

        // Show top 10 highest risk transactions
        const highRiskTransactions = data
          .sort((a, b) => b.riskScore - a.riskScore)
          .slice(0, 10);

        highRiskTransactions.forEach((transaction) => {
          const resultItem = document.createElement("div");
          resultItem.classList.add("result-item", transaction.status);
          resultItem.innerHTML = `
      <div class="result-header">
       <div class="result-id">${transaction.id}</div>
       <div class="result-status status-${transaction.status}">${
            transaction.status.charAt(0).toUpperCase() +
            transaction.status.slice(1)
          }</div>
      </div>
      <div class="result-details">
       <div>Amount: <span class="result-amount">$${transaction.amount.toFixed(
         2
       )}</span></div>
       <div>Type: ${transaction.type}</div>
       <div>Risk Score: ${transaction.riskScore}%</div>
      </div>
     `;
          resultsList.appendChild(resultItem);
        });
      }

      // Initialize dashboard
      function initializeDashboard(data) {
        if (!data || data.length === 0) return;

        // Calculate metrics
        const totalTransactions = data.length;
        const fraudTransactions = data.filter(
          (t) => t.status === "fraud"
        ).length;
        const suspiciousTransactions = data.filter(
          (t) => t.status === "suspicious"
        ).length;
        const legitimateTransactions = data.filter(
          (t) => t.status === "legitimate"
        ).length;

        const totalAmount = data.reduce((sum, t) => sum + t.amount, 0);
        const fraudAmount = data
          .filter((t) => t.status === "fraud")
          .reduce((sum, t) => sum + t.amount, 0);
        const savedAmount = fraudAmount * 0.95; // Assume 95% of fraud amount saved

        const detectionRate = (
          ((fraudTransactions + suspiciousTransactions) / totalTransactions) *
          100
        ).toFixed(1);

        // Update dashboard metrics
        document.getElementById("total-transactions").textContent =
          totalTransactions.toLocaleString();
        document.getElementById("fraud-detected").textContent =
          fraudTransactions.toLocaleString();
        document.getElementById("amount-saved").textContent = `$${(
          savedAmount / 1000000
        ).toFixed(2)}M`;
        document.getElementById(
          "detection-rate"
        ).textContent = `${detectionRate}%`;

        // Update change percentages (simulated)
        document.getElementById("total-change").textContent = `${(
          Math.random() * 20 +
          5
        ).toFixed(1)}%`;
        document.getElementById("fraud-change").textContent = `${(
          Math.random() * 10 +
          2
        ).toFixed(1)}%`;
        document.getElementById("saved-change").textContent = `${(
          Math.random() * 30 +
          10
        ).toFixed(1)}%`;
        document.getElementById("rate-change").textContent = `${(
          Math.random() * 5 +
          1
        ).toFixed(1)}%`;

        // Update fraud types
        updateFraudTypes(data);

        // Update alerts table
        updateAlertsTable(data);

        // Create dashboard charts
        createDashboardCharts(data);
      }

      // Update fraud types
      function updateFraudTypes(data) {
        const fraudData = data.filter((t) => t.status === "fraud");

        const types = {
          "Credit Card": 0,
          "Wire Transfer": 0,
          "Online Payment": 0,
          "Mobile Payment": 0,
        };

        fraudData.forEach((transaction) => {
          if (types.hasOwnProperty(transaction.type)) {
            types[transaction.type]++;
          }
        });

        document.getElementById(
          "credit-card-count"
        ).textContent = `${types["Credit Card"]} cases`;
        document.getElementById(
          "wire-transfer-count"
        ).textContent = `${types["Wire Transfer"]} cases`;
        document.getElementById(
          "online-payment-count"
        ).textContent = `${types["Online Payment"]} cases`;
        document.getElementById(
          "mobile-payment-count"
        ).textContent = `${types["Mobile Payment"]} cases`;
      }

      // Update alerts table
      function updateAlertsTable(data) {
        const tableBody = document.getElementById("fraud-alerts-table");
        tableBody.innerHTML = "";

        // Show top 20 highest risk transactions
        const highRiskTransactions = data
          .filter((t) => t.status === "fraud" || t.status === "suspicious")
          .sort((a, b) => b.riskScore - a.riskScore)
          .slice(0, 20);

        highRiskTransactions.forEach((transaction) => {
          const row = document.createElement("tr");
          row.innerHTML = `
      <td>${transaction.id}</td>
      <td>$${transaction.amount.toFixed(2)}</td>
      <td>${transaction.riskScore}%</td>
      <td>${transaction.type}</td>
      <td><span class="status-badge status-${transaction.status}">${
            transaction.status.charAt(0).toUpperCase() +
            transaction.status.slice(1)
          }</span></td>
      <td><button class="dashboard-btn" onclick="reviewTransaction('${
        transaction.id
      }')">Review</button></td>
     `;
          tableBody.appendChild(row);
        });
      }

      // Create dashboard charts
      function createDashboardCharts(data) {
        // Clear existing charts
        Chart.getChart("fraud-trends-chart")?.destroy();
        Chart.getChart("fraud-region-chart")?.destroy();

        // Fraud Trends Chart
        const trendsCtx = document
          .getElementById("fraud-trends-chart")
          .getContext("2d");

        // Generate last 6 months of data
        const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun"];
        const trendsData = months.map(
          () => Math.floor(Math.random() * 50) + 20
        );

        new Chart(trendsCtx, {
          type: "line",
          data: {
            labels: months,
            datasets: [
              {
                label: "Fraud Cases",
                data: trendsData,
                borderColor: "rgba(244, 67, 54, 1)",
                backgroundColor: "rgba(244, 67, 54, 0.1)",
                tension: 0.4,
                fill: true,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false,
              },
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  color: "rgba(255, 255, 255, 0.7)",
                },
                grid: {
                  color: "rgba(255, 255, 255, 0.1)",
                },
              },
              x: {
                ticks: {
                  color: "rgba(255, 255, 255, 0.7)",
                },
                grid: {
                  color: "rgba(255, 255, 255, 0.1)",
                },
              },
            },
          },
        });

        // Fraud by Region Chart
        const regionCtx = document
          .getElementById("fraud-region-chart")
          .getContext("2d");

        const regions = {};
        data
          .filter((t) => t.status === "fraud")
          .forEach((transaction) => {
            regions[transaction.location] =
              (regions[transaction.location] || 0) + 1;
          });

        new Chart(regionCtx, {
          type: "pie",
          data: {
            labels: Object.keys(regions),
            datasets: [
              {
                data: Object.values(regions),
                backgroundColor: [
                  "rgba(54, 162, 235, 0.7)",
                  "rgba(255, 206, 86, 0.7)",
                  "rgba(75, 192, 192, 0.7)",
                  "rgba(153, 102, 255, 0.7)",
                  "rgba(255, 99, 132, 0.7)",
                ],
                borderColor: [
                  "rgba(54, 162, 235, 1)",
                  "rgba(255, 206, 86, 1)",
                  "rgba(75, 192, 192, 1)",
                  "rgba(153, 102, 255, 1)",
                  "rgba(255, 99, 132, 1)",
                ],
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "bottom",
                labels: {
                  color: "rgba(255, 255, 255, 0.7)",
                  padding: 10,
                  font: {
                    size: 11,
                  },
                },
              },
            },
          },
        });
      }

      // Initialize Case Management System
      function initializeCaseManagement() {
        // Update case statistics
        updateCaseStatistics();

        // Populate cases table
        populateCasesTable();

        // Setup event listeners for case management
        setupCaseManagementEventListeners();
      }

      // Update case statistics
      function updateCaseStatistics() {
        const totalCases = casesData.length;
        const newCases = casesData.filter((c) => c.status === "new").length;
        const investigatingCases = casesData.filter(
          (c) => c.status === "investigating"
        ).length;
        const resolvedCases = casesData.filter(
          (c) => c.status === "resolved"
        ).length;

        document.getElementById("total-cases").textContent = totalCases;
        document.getElementById("new-cases").textContent = newCases;
        document.getElementById("investigating-cases").textContent =
          investigatingCases;
        document.getElementById("resolved-cases").textContent = resolvedCases;
      }

      // Populate cases table
      function populateCasesTable() {
        const tableBody = document.getElementById("cases-table");
        tableBody.innerHTML = "";

        // Get filter values
        const statusFilter = document.getElementById("status-filter").value;
        const priorityFilter = document.getElementById("priority-filter").value;
        const assignedFilter = document.getElementById("assigned-filter").value;
        const searchFilter = document
          .getElementById("search-filter")
          .value.toLowerCase();

        // Filter cases
        let filteredCases = casesData.filter((caseObj) => {
          if (statusFilter && caseObj.status !== statusFilter) return false;
          if (priorityFilter && caseObj.priority !== priorityFilter)
            return false;
          if (
            assignedFilter &&
            caseObj.assignedTo.toLowerCase() !== assignedFilter
          )
            return false;
          if (
            searchFilter &&
            !caseObj.id.toLowerCase().includes(searchFilter) &&
            !caseObj.transactionId.toLowerCase().includes(searchFilter)
          )
            return false;
          return true;
        });

        // Sort cases by date (newest first)
        filteredCases.sort((a, b) => new Date(b.date) - new Date(a.date));

        // Populate table
        filteredCases.forEach((caseObj) => {
          const row = document.createElement("tr");
          row.innerHTML = `
      <td>${caseObj.id}</td>
      <td>${caseObj.transactionId}</td>
      <td>${new Date(caseObj.date).toLocaleDateString()}</td>
      <td><span class="case-priority priority-${caseObj.priority}">${
            caseObj.priority.charAt(0).toUpperCase() + caseObj.priority.slice(1)
          }</span></td>
      <td><span class="case-status status-${caseObj.status}">${
            caseObj.status.charAt(0).toUpperCase() + caseObj.status.slice(1)
          }</span></td>
      <td>${caseObj.assignedTo}</td>
      <td>
       <div class="case-actions">
        <button class="action-btn" onclick="viewCaseDetails('${caseObj.id}')">
         <i class="fas fa-eye"></i>
        </button>
        <button class="action-btn" onclick="editCase('${caseObj.id}')">
         <i class="fas fa-edit"></i>
        </button>
       </div>
      </td>
     `;
          tableBody.appendChild(row);
        });
      }

      // Setup event listeners for case management
      function setupCaseManagementEventListeners() {
        // Filter event listeners
        document
          .getElementById("status-filter")
          .addEventListener("change", populateCasesTable);
        document
          .getElementById("priority-filter")
          .addEventListener("change", populateCasesTable);
        document
          .getElementById("assigned-filter")
          .addEventListener("change", populateCasesTable);
        document
          .getElementById("search-filter")
          .addEventListener("input", populateCasesTable);

        // New case button
        document
          .getElementById("new-case-btn")
          .addEventListener("click", () => {
            // Populate transaction dropdown
            populateTransactionDropdown();
            document.getElementById("new-case-modal").classList.add("active");
          });

        // Close new case modal
        document
          .getElementById("close-new-case-modal")
          .addEventListener("click", () => {
            document
              .getElementById("new-case-modal")
              .classList.remove("active");
          });

        document
          .getElementById("cancel-new-case-btn")
          .addEventListener("click", () => {
            document
              .getElementById("new-case-modal")
              .classList.remove("active");
          });

        // Create case button
        document
          .getElementById("create-case-btn")
          .addEventListener("click", createNewCase);

        // Close case detail modal
        document.getElementById("close-modal").addEventListener("click", () => {
          document
            .getElementById("case-detail-modal")
            .classList.remove("active");
        });

        document
          .getElementById("close-modal-btn")
          .addEventListener("click", () => {
            document
              .getElementById("case-detail-modal")
              .classList.remove("active");
          });

        // Save case button
        document
          .getElementById("save-case-btn")
          .addEventListener("click", saveCaseChanges);

        // Add note button
        document
          .getElementById("add-note-btn")
          .addEventListener("click", addNewNote);
      }

      // Populate transaction dropdown for new case
      function populateTransactionDropdown() {
        const dropdown = document.getElementById("case-transaction-id");
        dropdown.innerHTML = '<option value="">Select a transaction</option>';

        // Add suspicious and fraudulent transactions to dropdown
        if (uploadedData) {
          const suspiciousTransactions = uploadedData.filter(
            (t) => t.status === "suspicious" || t.status === "fraud"
          );
          suspiciousTransactions.forEach((transaction) => {
            const option = document.createElement("option");
            option.value = transaction.id;
            option.textContent = `${
              transaction.id
            } - $${transaction.amount.toFixed(2)} - ${transaction.type}`;
            dropdown.appendChild(option);
          });
        }
      }

      // View case details
      function viewCaseDetails(caseId) {
        const caseObj = casesData.find((c) => c.id === caseId);
        if (!caseObj) return;

        currentCaseId = caseId;

        // Populate modal with case details
        document.getElementById(
          "modal-case-title"
        ).textContent = `Case Details - ${caseObj.id}`;
        document.getElementById("detail-case-id").textContent = caseObj.id;
        document.getElementById("detail-transaction-id").textContent =
          caseObj.transactionId;
        document.getElementById("detail-date").textContent = new Date(
          caseObj.date
        ).toLocaleDateString();
        document.getElementById(
          "detail-priority"
        ).innerHTML = `<span class="case-priority priority-${
          caseObj.priority
        }">${
          caseObj.priority.charAt(0).toUpperCase() + caseObj.priority.slice(1)
        }</span>`;
        document.getElementById(
          "detail-status"
        ).innerHTML = `<span class="case-status status-${caseObj.status}">${
          caseObj.status.charAt(0).toUpperCase() + caseObj.status.slice(1)
        }</span>`;
        document.getElementById("detail-assigned").textContent =
          caseObj.assignedTo;

        // Populate transaction details
        const transactionDetailsContainer = document.getElementById(
          "transaction-details-container"
        );
        transactionDetailsContainer.innerHTML = "";

        if (caseObj.transaction) {
          const transactionTable = document.createElement("table");
          transactionTable.className = "transaction-details-table";

          // Create table header
          const tableHeader = document.createElement("thead");
          tableHeader.innerHTML = "<tr><th>Field</th><th>Value</th></tr>";
          transactionTable.appendChild(tableHeader);

          // Create table body with all transaction fields
          const tableBody = document.createElement("tbody");

          // Add standard fields
          const standardFields = [
            { label: "Transaction ID", value: caseObj.transaction.id },
            {
              label: "Amount",
              value: `$${caseObj.transaction.amount.toFixed(2)}`,
            },
            { label: "Type", value: caseObj.transaction.type },
            {
              label: "Date",
              value: new Date(caseObj.transaction.date).toLocaleString(),
            },
            { label: "Location", value: caseObj.transaction.location },
            { label: "Device", value: caseObj.transaction.device },
            { label: "Risk Score", value: `${caseObj.transaction.riskScore}%` },
            { label: "Status", value: caseObj.transaction.status },
          ];

          standardFields.forEach((field) => {
            const row = document.createElement("tr");
            row.innerHTML = `<td>${field.label}</td><td>${field.value}</td>`;
            tableBody.appendChild(row);
          });

          // Add all original data fields from the uploaded file
          if (caseObj.transaction.originalData) {
            Object.entries(caseObj.transaction.originalData).forEach(
              ([key, value]) => {
                // Skip fields that are already in standard fields
                if (
                  !standardFields.some(
                    (f) => f.label.toLowerCase() === key.toLowerCase()
                  )
                ) {
                  const row = document.createElement("tr");
                  row.innerHTML = `<td>${key}</td><td>${value}</td>`;
                  tableBody.appendChild(row);
                }
              }
            );
          }

          transactionTable.appendChild(tableBody);
          transactionDetailsContainer.appendChild(transactionTable);
        }

        // Populate timeline
        const timelineContainer = document.getElementById("case-timeline");
        timelineContainer.innerHTML = "";

        caseObj.timeline.forEach((item) => {
          const timelineItem = document.createElement("div");
          timelineItem.classList.add("timeline-item");
          timelineItem.innerHTML = `
      <div class="timeline-date">${new Date(
        item.date
      ).toLocaleDateString()} ${new Date(item.date).toLocaleTimeString()}</div>
      <div class="timeline-content">${item.content}</div>
     `;
          timelineContainer.appendChild(timelineItem);
        });

        // Populate evidence
        const evidenceContainer = document.getElementById("evidence-list");
        evidenceContainer.innerHTML = "";

        caseObj.evidence.forEach((item) => {
          const evidenceItem = document.createElement("div");
          evidenceItem.classList.add("evidence-item");
          evidenceItem.innerHTML = `
      <div class="evidence-icon">
       <i class="fas ${item.icon}"></i>
      </div>
      <div class="evidence-info">
       <div class="evidence-name">${item.name}</div>
       <div class="evidence-date">${new Date(
         item.date
       ).toLocaleDateString()}</div>
      </div>
     `;
          evidenceContainer.appendChild(evidenceItem);
        });

        // Populate notes
        const notesContainer = document.getElementById("notes-container");
        notesContainer.innerHTML = "";

        caseObj.notes.forEach((item) => {
          const noteItem = document.createElement("div");
          noteItem.classList.add("note-item");
          noteItem.innerHTML = `
      <div class="note-header">
       <div class="note-author">${item.author}</div>
       <div class="note-date">${new Date(
         item.date
       ).toLocaleDateString()} ${new Date(item.date).toLocaleTimeString()}</div>
      </div>
      <div class="note-content">${item.content}</div>
     `;
          notesContainer.appendChild(noteItem);
        });

        // Populate resolution if available
        if (caseObj.resolution) {
          document.getElementById("detail-resolution-date").textContent =
            new Date(caseObj.resolution.date).toLocaleDateString();
          document.getElementById("detail-resolution-type").textContent =
            caseObj.resolution.type;
          document.getElementById("detail-amount-recovered").textContent =
            caseObj.resolution.amountRecovered;
          document.getElementById("detail-effectiveness").textContent =
            caseObj.resolution.effectiveness;
        } else {
          document.getElementById("detail-resolution-date").textContent =
            "Not resolved yet";
          document.getElementById("detail-resolution-type").textContent =
            "Not resolved yet";
          document.getElementById("detail-amount-recovered").textContent =
            "Not recovered yet";
          document.getElementById("detail-effectiveness").textContent =
            "Not applicable";
        }

        // Show modal
        document.getElementById("case-detail-modal").classList.add("active");
      }

      // Edit case
      function editCase(caseId) {
        viewCaseDetails(caseId);
        // In a real application, this would enable editing mode
        showNotification("Edit mode would be enabled in a full implementation");
      }

      // Create new case
      function createNewCase() {
        const transactionId = document.getElementById(
          "case-transaction-id"
        ).value;
        const priority = document.getElementById("case-priority").value;
        const type = document.getElementById("case-type").value;
        const assigned = document.getElementById("case-assigned").value;
        const description = document.getElementById("case-description").value;

        if (!transactionId || !description) {
          showNotification("Please fill in all required fields");
          return;
        }

        // Find the transaction
        const transaction = uploadedData.find((t) => t.id === transactionId);
        if (!transaction) {
          showNotification("Invalid transaction ID");
          return;
        }

        // Create new case object
        const newCase = {
          id: `CASE${String(casesData.length + 1).padStart(4, "0")}`,
          transactionId: transactionId,
          title: `${type} - ${transactionId}`,
          date: new Date().toISOString(),
          priority: priority,
          status: "new",
          assignedTo: assigned,
          description: description,
          transaction: transaction, // Store the full transaction object
          timeline: [
            {
              date: new Date().toISOString(),
              content: "Case created manually",
            },
          ],
          evidence: [
            {
              name: "Transaction Record",
              icon: "fa-file-alt",
              date: new Date().toISOString(),
              data: transaction.originalData, // Store original data as evidence
            },
          ],
          notes: [
            {
              author: "Current User",
              date: new Date().toISOString(),
              content: `Case created for transaction ${transactionId} with risk score ${transaction.riskScore}%.`,
            },
          ],
          resolution: null,
        };

        // Add to cases data
        casesData.push(newCase);

        // Update UI
        updateCaseStatistics();
        populateCasesTable();

        // Close modal
        document.getElementById("new-case-modal").classList.remove("active");

        // Reset form
        document.getElementById("new-case-form").reset();

        // Show notification
        showNotification(`Case ${newCase.id} created successfully`);
      }

      // Save case changes
      function saveCaseChanges() {
        if (!currentCaseId) return;

        // In a real application, this would save changes to the case
        showNotification(`Case ${currentCaseId} updated successfully`);

        // Close modal
        document.getElementById("case-detail-modal").classList.remove("active");
      }

      // Add new note
      function addNewNote() {
        if (!currentCaseId) return;

        const noteText = document.getElementById("new-note").value;
        if (!noteText) {
          showNotification("Please enter a note");
          return;
        }

        // Find the case
        const caseObj = casesData.find((c) => c.id === currentCaseId);
        if (!caseObj) return;

        // Add new note
        const newNote = {
          author: "Current User", // In a real app, this would be the logged-in user
          date: new Date().toISOString(),
          content: noteText,
        };

        caseObj.notes.push(newNote);

        // Update UI
        viewCaseDetails(currentCaseId);

        // Clear textarea
        document.getElementById("new-note").value = "";

        // Show notification
        showNotification("Note added successfully");
      }

      // Real-time fraud detection
      function startRealtimeDetection() {
        // Clear existing interval
        if (realtimeInterval) {
          clearInterval(realtimeInterval);
        }

        // Start new interval
        realtimeInterval = setInterval(() => {
          if (uploadedData && Math.random() < 0.3) {
            // 30% chance of new fraud
            generateRealtimeFraud();
          }
        }, 5000); // Check every 5 seconds
      }

      function stopRealtimeDetection() {
        if (realtimeInterval) {
          clearInterval(realtimeInterval);
          realtimeInterval = null;
        }
      }

      function generateRealtimeFraud() {
        // Generate a new fraudulent transaction
        const newFraud = {
          id: `TXN${String(Date.now()).slice(-6)}`,
          amount: Math.random() * 15000 + 1000,
          type: getRandomTransactionType(),
          date: new Date().toISOString(),
          location: getRandomLocation(),
          device: getRandomDevice(),
          riskScore: Math.floor(Math.random() * 20 + 80),
          status: "fraud",
          originalData: {}, // Empty original data for generated transactions
        };

        // Add to uploaded data
        uploadedData.unshift(newFraud);

        // Create a case for the new fraud
        createCaseFromFraud(newFraud);

        // Show real-time alert
        showRealtimeAlert(newFraud);

        // Update dashboard if visible
        if (dashboardPage.classList.contains("active")) {
          initializeDashboard(uploadedData);
        }
      }

      // Create a case from a fraud transaction
      function createCaseFromFraud(transaction) {
        const caseType = getCaseTypeFromTransaction(transaction);
        const priority = transaction.status === "fraud" ? "high" : "medium";

        const newCase = {
          id: `CASE${String(casesData.length + 1).padStart(4, "0")}`,
          transactionId: transaction.id,
          title: `${caseType} - ${transaction.id}`,
          date: new Date().toISOString(),
          priority: priority,
          status: "new",
          assignedTo: "Unassigned",
          description: `Automatically generated case for high-risk transaction ${transaction.id} with risk score ${transaction.riskScore}%.`,
          transaction: transaction, // Store the full transaction object
          timeline: [
            {
              date: new Date().toISOString(),
              content: "Case automatically created from fraud detection",
            },
          ],
          evidence: [
            {
              name: "Transaction Record",
              icon: "fa-file-alt",
              date: new Date().toISOString(),
              data: transaction.originalData, // Store original data as evidence
            },
          ],
          notes: [
            {
              author: "System",
              date: new Date().toISOString(),
              content: `High-risk transaction detected: Amount $${transaction.amount.toFixed(
                2
              )}, Type: ${transaction.type}, Location: ${
                transaction.location
              }, Risk Score: ${transaction.riskScore}%`,
            },
          ],
          resolution: null,
        };

        casesData.unshift(newCase);

        // Update case management if visible
        if (caseManagementPage.classList.contains("active")) {
          updateCaseStatistics();
          populateCasesTable();
        }
      }

      function showRealtimeAlert(transaction) {
        const alert = document.getElementById("realtime-alert");
        const content = document.getElementById("realtime-alert-content");

        content.innerHTML = `
     <strong>New Fraud Detected!</strong><br>
     Transaction ID: ${transaction.id}<br>
     Amount: $${transaction.amount.toFixed(2)}<br>
     Type: ${transaction.type}<br>
     Location: ${transaction.location}<br>
     Risk Score: ${transaction.riskScore}%
    `;

        alert.classList.add("show");

        // Auto-hide after 10 seconds
        setTimeout(() => {
          alert.classList.remove("show");
        }, 10000);
      }

      // Close real-time alert
      document
        .getElementById("close-realtime-alert")
        .addEventListener("click", () => {
          document.getElementById("realtime-alert").classList.remove("show");
        });

      // Refresh dashboard
      document
        .getElementById("refresh-dashboard")
        .addEventListener("click", () => {
          if (uploadedData) {
            initializeDashboard(uploadedData);
            showNotification("Dashboard refreshed successfully!");
          }
        });

      // Form submission
      uploadForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const file = fileInput.files[0];
        if (file) {
          processFile(file);
        } else {
          showNotification("Please select a file to upload.");
        }
      });

      // File input change
      fileInput.addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (file) {
          processFile(file);
        }
      });

      // Review transaction function
      function reviewTransaction(transactionId) {
        const transaction = uploadedData.find((t) => t.id === transactionId);
        if (transaction) {
          showNotification(
            `Reviewing transaction ${transactionId} - Risk Score: ${transaction.riskScore}%`
          );
        }
      }

      // Show notification
      function showNotification(message) {
        const notification = document.createElement("div");
        notification.className = "notification-toast";
        notification.textContent = message;
        notification.style.display = "block";

        document.body.appendChild(notification);

        setTimeout(() => {
          notification.style.animation = "fadeOutDown 0.3s ease-out";
          setTimeout(() => {
            document.body.removeChild(notification);
          }, 300);
        }, 3000);
      }

      // Header scroll effect
      window.addEventListener("scroll", () => {
        const header = document.querySelector("header");
        if (window.scrollY > 50) {
          header.classList.add("scrolled");
        } else {
          header.classList.remove("scrolled");
        }
      });

      // Smooth scrolling
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          if (
            this.getAttribute("href") !== "#dashboard" &&
            this.getAttribute("href") !== "#case-management"
          ) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute("href"));
            if (target) {
              target.scrollIntoView({
                behavior: "smooth",
                block: "start",
              });
            }
          }
        });
      });

      // Add fadeOutDown animation
      const style = document.createElement("style");
      style.textContent = `
    @keyframes fadeOutDown {
     from {
      opacity: 1;
      transform: translate(-50%, 0);
     }
     to {
      opacity: 0;
      transform: translate(-50%, 20px);
     }
    }
   `;
      document.head.appendChild(style);

      // ===== ENHANCED AUTHENTICATION FUNCTIONS =====

      // Password strength checker
      function checkPasswordStrength(password) {
        const requirements = {
          length: password.length >= 8,
          uppercase: /[A-Z]/.test(password),
          lowercase: /[a-z]/.test(password),
          number: /[0-9]/.test(password),
          special: /[!@#$%^&*(),.?":{}|<>]/.test(password),
        };

        const metRequirements =
          Object.values(requirements).filter(Boolean).length;
        const totalRequirements = Object.keys(requirements).length;

        let strength = 0;
        if (metRequirements === totalRequirements) {
          strength = 100;
        } else if (metRequirements >= 4) {
          strength = 66;
        } else if (metRequirements >= 3) {
          strength = 33;
        }

        return { strength, requirements };
      }

      // Update password strength UI
      function updatePasswordStrength(password) {
        const { strength, requirements } = checkPasswordStrength(password);
        const strengthBar = document.querySelector(".password-strength-bar");

        // Update strength bar
        strengthBar.className = "password-strength-bar";
        if (strength === 100) {
          strengthBar.classList.add("strength-strong");
        } else if (strength >= 66) {
          strengthBar.classList.add("strength-medium");
        } else if (strength > 0) {
          strengthBar.classList.add("strength-weak");
        }

        // Update requirements
        document
          .getElementById("req-length")
          .classList.toggle("met", requirements.length);
        document
          .getElementById("req-uppercase")
          .classList.toggle("met", requirements.uppercase);
        document
          .getElementById("req-lowercase")
          .classList.toggle("met", requirements.lowercase);
        document
          .getElementById("req-number")
          .classList.toggle("met", requirements.number);
        document
          .getElementById("req-special")
          .classList.toggle("met", requirements.special);

        // Update icons
        document.querySelectorAll(".requirement i").forEach((icon) => {
          if (icon.parentElement.classList.contains("met")) {
            icon.className = "fas fa-check-circle";
          } else {
            icon.className = "fas fa-times-circle";
          }
        });

        return strength >= 66;
      }

      // Validate email
      function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }

      // Show Login Modal
      function showLoginModal() {
        document.getElementById("login-modal").classList.add("active");
        document.getElementById("login-loading").classList.remove("show");
        document.getElementById("login-success").classList.remove("show");
        document.getElementById("login-form").style.display = "block";
      }

      // Show Signup Modal
      function showSignupModal() {
        document.getElementById("signup-modal").classList.add("active");
        document.getElementById("signup-loading").classList.remove("show");
        document.getElementById("signup-success").classList.remove("show");
        document.getElementById("signup-form").style.display = "block";
      }

      // Close Auth Modals
      function closeAuthModals() {
        document.getElementById("login-modal").classList.remove("active");
        document.getElementById("signup-modal").classList.remove("active");
      }

      // Handle Login with enhanced validation
      document
        .getElementById("login-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const email = document.getElementById("login-email").value.trim();
          const password = document.getElementById("login-password").value;
          const rememberMe = document.getElementById("remember-me").checked;

          // Reset errors
          document.querySelectorAll(".form-error").forEach((error) => {
            error.classList.remove("show");
          });

          // Validate email
          if (!email) {
            document.getElementById("login-email-error").textContent =
              "Email is required";
            document.getElementById("login-email-error").classList.add("show");
            return;
          }

          if (!validateEmail(email)) {
            document.getElementById("login-email-error").textContent =
              "Please enter a valid email address";
            document.getElementById("login-email-error").classList.add("show");
            return;
          }

          // Validate password
          if (!password) {
            document.getElementById("login-password-error").textContent =
              "Password is required";
            document
              .getElementById("login-password-error")
              .classList.add("show");
            return;
          }

          // Show loading
          document.getElementById("login-form").style.display = "none";
          document.getElementById("login-loading").classList.add("show");

          // Simulate API call
          setTimeout(() => {
            const user = validUsers.find(
              (u) => u.email === email && u.password === password
            );

            if (user) {
              // Generate auth token
              authToken = btoa(
                JSON.stringify({
                  id: user.id,
                  email: user.email,
                  timestamp: Date.now(),
                })
              );

              // Store session
              if (rememberMe) {
                localStorage.setItem("authToken", authToken);
                localStorage.setItem("currentUser", JSON.stringify(user));
              } else {
                sessionStorage.setItem("authToken", authToken);
                sessionStorage.setItem("currentUser", JSON.stringify(user));
              }

              isLoggedIn = true;
              currentUser = user;
              updateUserUI();

              // Show success
              document.getElementById("login-loading").classList.remove("show");
              document.getElementById("login-success").classList.add("show");

              setTimeout(() => {
                closeAuthModals();
                showNotification(`Welcome back, ${user.name}!`);

                // Process pending download if any
                if (pendingDownload) {
                  const { format, source } = pendingDownload;
                  setTimeout(() => {
                    downloadData(format, source);
                    pendingDownload = null;
                  }, 500);
                }
              }, 1500);
            } else {
              // Show error
              document.getElementById("login-loading").classList.remove("show");
              document.getElementById("login-form").style.display = "block";
              document.getElementById("login-password-error").textContent =
                "Invalid email or password";
              document
                .getElementById("login-password-error")
                .classList.add("show");
            }
          }, 1500);
        });

      // Handle Signup with enhanced validation
      document
        .getElementById("signup-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const name = document.getElementById("signup-name").value.trim();
          const email = document.getElementById("signup-email").value.trim();
          const password = document.getElementById("signup-password").value;
          const confirmPassword = document.getElementById(
            "signup-confirm-password"
          ).value;
          const agreeTerms = document.getElementById("agree-terms").checked;

          // Reset errors
          document.querySelectorAll(".form-error").forEach((error) => {
            error.classList.remove("show");
          });

          // Validate name
          if (!name) {
            document.getElementById("signup-name-error").textContent =
              "Full name is required";
            document.getElementById("signup-name-error").classList.add("show");
            return;
          }

          if (name.length < 2) {
            document.getElementById("signup-name-error").textContent =
              "Name must be at least 2 characters";
            document.getElementById("signup-name-error").classList.add("show");
            return;
          }

          // Validate email
          if (!email) {
            document.getElementById("signup-email-error").textContent =
              "Email is required";
            document.getElementById("signup-email-error").classList.add("show");
            return;
          }

          if (!validateEmail(email)) {
            document.getElementById("signup-email-error").textContent =
              "Please enter a valid email address";
            document.getElementById("signup-email-error").classList.add("show");
            return;
          }

          // Check if email already exists
          if (validUsers.some((u) => u.email === email)) {
            document.getElementById("signup-email-error").textContent =
              "Email already registered";
            document.getElementById("signup-email-error").classList.add("show");
            return;
          }

          // Validate password
          if (!password) {
            document.getElementById("signup-password-error").textContent =
              "Password is required";
            document
              .getElementById("signup-password-error")
              .classList.add("show");
            return;
          }

          const isPasswordStrong = updatePasswordStrength(password);
          if (!isPasswordStrong) {
            document.getElementById("signup-password-error").textContent =
              "Password does not meet requirements";
            document
              .getElementById("signup-password-error")
              .classList.add("show");
            return;
          }

          // Validate confirm password
          if (!confirmPassword) {
            document.getElementById("signup-confirm-error").textContent =
              "Please confirm your password";
            document
              .getElementById("signup-confirm-error")
              .classList.add("show");
            return;
          }

          if (password !== confirmPassword) {
            document.getElementById("signup-confirm-error").textContent =
              "Passwords do not match";
            document
              .getElementById("signup-confirm-error")
              .classList.add("show");
            return;
          }

          // Validate terms
          if (!agreeTerms) {
            showNotification(
              "Please agree to the Terms of Service and Privacy Policy"
            );
            return;
          }

          // Show loading
          document.getElementById("signup-form").style.display = "none";
          document.getElementById("signup-loading").classList.add("show");

          // Simulate API call
          setTimeout(() => {
            const newUser = {
              email,
              password,
              name,
              id: `user_${Date.now()}`,
              role: "user",
              createdAt: new Date(),
            };

            validUsers.push(newUser);

            // Generate auth token
            authToken = btoa(
              JSON.stringify({
                id: newUser.id,
                email: newUser.email,
                timestamp: Date.now(),
              })
            );

            // Store session
            localStorage.setItem("authToken", authToken);
            localStorage.setItem("currentUser", JSON.stringify(newUser));

            isLoggedIn = true;
            currentUser = newUser;
            updateUserUI();

            // Show success
            document.getElementById("signup-loading").classList.remove("show");
            document.getElementById("signup-success").classList.add("show");

            setTimeout(() => {
              closeAuthModals();
              showNotification(
                "Account created successfully! Welcome to Fraudshield Pro!"
              );

              // Process pending download if any
              if (pendingDownload) {
                const { format, source } = pendingDownload;
                setTimeout(() => {
                  downloadData(format, source);
                  pendingDownload = null;
                }, 500);
              }
            }, 1500);
          }, 1500);
        });

      // Password visibility toggle
      document
        .getElementById("toggle-login-password")
        .addEventListener("click", () => {
          const passwordInput = document.getElementById("login-password");
          const icon = document.getElementById("toggle-login-password");

          if (passwordInput.type === "password") {
            passwordInput.type = "text";
            icon.classList.add("show-password");
            icon.classList.remove("fa-eye");
            icon.classList.add("fa-eye-slash");
          } else {
            passwordInput.type = "password";
            icon.classList.remove("show-password");
            icon.classList.remove("fa-eye-slash");
            icon.classList.add("fa-eye");
          }
        });

      document
        .getElementById("toggle-signup-password")
        .addEventListener("click", () => {
          const passwordInput = document.getElementById("signup-password");
          const icon = document.getElementById("toggle-signup-password");

          if (passwordInput.type === "password") {
            passwordInput.type = "text";
            icon.classList.add("show-password");
            icon.classList.remove("fa-eye");
            icon.classList.add("fa-eye-slash");
          } else {
            passwordInput.type = "password";
            icon.classList.remove("show-password");
            icon.classList.remove("fa-eye-slash");
            icon.classList.add("fa-eye");
          }
        });

      document
        .getElementById("toggle-confirm-password")
        .addEventListener("click", () => {
          const passwordInput = document.getElementById(
            "signup-confirm-password"
          );
          const icon = document.getElementById("toggle-confirm-password");

          if (passwordInput.type === "password") {
            passwordInput.type = "text";
            icon.classList.add("show-password");
            icon.classList.remove("fa-eye");
            icon.classList.add("fa-eye-slash");
          } else {
            passwordInput.type = "password";
            icon.classList.remove("show-password");
            icon.classList.remove("fa-eye-slash");
            icon.classList.add("fa-eye");
          }
        });

      // Real-time password strength checking
      document
        .getElementById("signup-password")
        .addEventListener("input", (e) => {
          updatePasswordStrength(e.target.value);
        });

      // Switch modals
      document
        .getElementById("switch-to-signup")
        .addEventListener("click", (e) => {
          e.preventDefault();
          closeAuthModals();
          showSignupModal();
        });

      document
        .getElementById("switch-to-login")
        .addEventListener("click", (e) => {
          e.preventDefault();
          closeAuthModals();
          showLoginModal();
        });

      // Close buttons
      document
        .getElementById("close-login-modal")
        .addEventListener("click", closeAuthModals);
      document
        .getElementById("close-signup-modal")
        .addEventListener("click", closeAuthModals);

      // Forgot password
      document
        .getElementById("forgot-password-link")
        .addEventListener("click", (e) => {
          e.preventDefault();
          showNotification(
            "Password reset functionality would be implemented in a production environment"
          );
        });

      // Social login handlers
      document.querySelectorAll(".social-btn").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          const provider = btn.classList[1];
          showNotification(
            `${
              provider.charAt(0).toUpperCase() + provider.slice(1)
            } login would be implemented in a production environment`
          );
        });
      });

      // Logout
      document.getElementById("logout-btn").addEventListener("click", () => {
        // Clear session
        localStorage.removeItem("authToken");
        localStorage.removeItem("currentUser");
        sessionStorage.removeItem("authToken");
        sessionStorage.removeItem("currentUser");

        isLoggedIn = false;
        currentUser = null;
        authToken = null;
        updateUserUI();
        showNotification("You have been logged out.");
      });

      document
        .getElementById("mobile-logout-btn")
        .addEventListener("click", () => {
          // Clear session
          localStorage.removeItem("authToken");
          localStorage.removeItem("currentUser");
          sessionStorage.removeItem("authToken");
          sessionStorage.removeItem("currentUser");

          isLoggedIn = false;
          currentUser = null;
          authToken = null;
          updateUserUI();
          showNotification("You have been logged out.");
          closeMobileMenuFunc();
        });

      // Update UI based on authentication state
      function updateUserUI() {
        const userMenu = document.getElementById("user-menu");
        const mobileUserMenu = document.getElementById("mobile-user-menu");

        if (isLoggedIn && currentUser) {
          // Show user profile
          userMenu.style.display = "block";
          mobileUserMenu.style.display = "block";

          // Update user info
          document.getElementById("user-name").textContent = currentUser.name;
          document.getElementById("user-email").textContent = currentUser.email;
          document.getElementById("mobile-user-name").textContent =
            currentUser.name;
          document.getElementById("mobile-user-email").textContent =
            currentUser.email;

          // Update avatar with first letter of name
          const avatarLetter = currentUser.name.charAt(0).toUpperCase();
          document.getElementById("user-avatar").textContent = avatarLetter;
          document.getElementById("mobile-user-avatar").textContent =
            avatarLetter;
        } else {
          // Hide user profile
          userMenu.style.display = "none";
          mobileUserMenu.style.display = "none";
        }
      }

      // Check for existing session on page load
      function checkExistingSession() {
        const storedToken =
          localStorage.getItem("authToken") ||
          sessionStorage.getItem("authToken");
        const storedUser =
          localStorage.getItem("currentUser") ||
          sessionStorage.getItem("currentUser");

        if (storedToken && storedUser) {
          try {
            authToken = storedToken;
            currentUser = JSON.parse(storedUser);
            isLoggedIn = true;
            updateUserUI();
          } catch (e) {
            console.error("Invalid session data");
          }
        }
      }

      // ===== SETTINGS FUNCTIONALITY =====
      let appSettings = {
        theme: "dark",
        language: "en",
        realtimeAlerts: true,
        browserNotifications: false,
      };

      // Load settings from localStorage
      function loadAppSettings() {
        const saved = localStorage.getItem("fraudshield-settings");
        if (saved) {
          try {
            appSettings = { ...appSettings, ...JSON.parse(saved) };
          } catch (e) {
            console.warn("Failed to parse settings");
          }
        }

        // Apply theme
        if (appSettings.theme === "light") {
          document.documentElement.setAttribute("data-theme", "light");
        } else {
          document.documentElement.removeAttribute("data-theme");
        }

        // Apply real-time alerts
        if (appSettings.realtimeAlerts && uploadedData) {
          startRealtimeDetection();
        } else {
          stopRealtimeDetection();
        }
      }

      // Save settings to localStorage
      function saveAppSettings() {
        localStorage.setItem(
          "fraudshield-settings",
          JSON.stringify(appSettings)
        );
        showNotification("Settings saved successfully!");
      }

      // Open Settings Modal
      function openSettingsModal() {
        document.getElementById("theme-select").value = appSettings.theme;
        document.getElementById("language-select").value = appSettings.language;
        document.getElementById("realtime-alerts-toggle").checked =
          appSettings.realtimeAlerts;
        document.getElementById("browser-notifications-toggle").checked =
          appSettings.browserNotifications;

        document.getElementById("settings-modal").classList.add("active");
      }

      // Close Settings Modal
      function closeSettingsModal() {
        document.getElementById("settings-modal").classList.remove("active");
      }

      // Save Settings
      function handleSaveSettings() {
        appSettings.theme = document.getElementById("theme-select").value;
        appSettings.language = document.getElementById("language-select").value;
        appSettings.realtimeAlerts = document.getElementById(
          "realtime-alerts-toggle"
        ).checked;
        appSettings.browserNotifications = document.getElementById(
          "browser-notifications-toggle"
        ).checked;

        // Apply theme
        if (appSettings.theme === "light") {
          document.documentElement.setAttribute("data-theme", "light");
        } else {
          document.documentElement.removeAttribute("data-theme");
        }

        // Handle real-time detection
        if (appSettings.realtimeAlerts && uploadedData) {
          startRealtimeDetection();
        } else {
          stopRealtimeDetection();
        }

        // Request browser notification permission
        if (appSettings.browserNotifications) {
          if (Notification.permission === "default") {
            Notification.requestPermission();
          }
        }

        saveAppSettings();
        closeSettingsModal();
      }

      // Attach event listeners
      document.getElementById("settings-btn").addEventListener("click", (e) => {
        e.preventDefault();
        openSettingsModal();
      });

      document
        .getElementById("mobile-settings-btn")
        .addEventListener("click", (e) => {
          e.preventDefault();
          openSettingsModal();
          closeMobileMenuFunc();
        });

      document
        .getElementById("close-settings-modal")
        .addEventListener("click", closeSettingsModal);
      document
        .getElementById("close-settings-btn")
        .addEventListener("click", closeSettingsModal);
      document
        .getElementById("save-settings-btn")
        .addEventListener("click", handleSaveSettings);

      // Initialize settings on page load
      loadAppSettings();

      // Check for existing session on page load
      checkExistingSession();
    </script>
    <!-- Jarvis AI Assistant Button (Bottom Right) -->
    <div id="jarvis-btn" class="jarvis-btn">
      <i class="fas fa-robot"></i>
    </div>

    <!-- Jarvis Modal -->
    <div id="jarvis-modal" class="jarvis-modal">
      <div class="jarvis-content">
        <div class="jarvis-header">
          <h3><i class="fas fa-brain"></i> Jarvis AI</h3>
          <button id="close-jarvis" class="jarvis-close">&times;</button>
        </div>
        <div class="jarvis-options">
          <button id="chat-ai-mode" class="jarvis-option">
            <i class="fas fa-comments"></i> Chat AI
          </button>
          <button id="voice-ai-mode" class="jarvis-option active">
            <i class="fas fa-microphone"></i> Voice AI
          </button>
        </div>

        <!-- Chat AI Interface -->
        <div
          id="chat-ai-interface"
          class="jarvis-interface"
          style="display: none"
        >
          <div class="chat-messages" id="chat-messages">
            <div class="message bot">Hello! How can I assist you today?</div>
          </div>
          <div class="chat-input">
            <input
              type="text"
              id="chat-input"
              placeholder="Type your message..."
            />
            <button id="send-chat"><i class="fas fa-paper-plane"></i></button>
          </div>
        </div>

        <!-- Voice AI Interface -->
        <div id="voice-ai-interface" class="jarvis-interface">
          <div class="jarvis-wave">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
          </div>
          <div class="jarvis-status" id="jarvis-status">
            Say "Hi Jarvis" to begin
          </div>
          <div class="jarvis-controls">
            <button id="start-listen" class="jarvis-btn-primary">
              Start Listening
            </button>
            <button id="stop-listen" class="jarvis-btn-secondary" disabled>
              Stop
            </button>
          </div>
          <div class="jarvis-transcript" id="jarvis-transcript">
            Awaiting voice...
          </div>
        </div>
      </div>
    </div>

    <style>
      /* Jarvis AI Styles - Bottom Right */
      .jarvis-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: var(--glass-bg);
        color: var(--light);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 9999;
        box-shadow: var(--glow-intensity), 0 4px 20px rgba(0, 0, 0, 0.25);
        border: 1px solid var(--glass-border);
        transition: all 0.3s ease;
      }
      .jarvis-btn:hover {
        transform: scale(1.15);
        background: rgba(255, 255, 255, 0.12);
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
      }
      [data-theme="light"] .jarvis-btn:hover {
        background: rgba(0, 0, 0, 0.08);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      }

      .jarvis-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        backdrop-filter: blur(0);
      }

      .jarvis-content {
        background: var(--chatbot-bg);
        border-radius: 20px;
        padding: 25px;
        width: 92%;
        max-width: 400px;
        border: 1px solid var(--glass-border);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.35);
        color: var(--light);
        font-family: "Inter", sans-serif;
        animation: modalPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      @keyframes modalPop {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .jarvis-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .jarvis-header h3 {
        font-weight: 700;
        font-size: 1.2rem;
        color: var(--gray-medium);
      }

      .jarvis-close {
        background: none;
        border: none;
        color: var(--light);
        font-size: 1.8rem;
        cursor: pointer;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background 0.2s;
      }
      .jarvis-close:hover {
        background: rgba(255, 255, 255, 0.1);
      }
      [data-theme="light"] .jarvis-close {
        color: var(--dark);
      }
      [data-theme="light"] .jarvis-close:hover {
        background: rgba(0, 0, 0, 0.1);
      }

      .jarvis-options {
        display: flex;
        gap: 12px;
        margin-bottom: 20px;
      }
      .jarvis-option {
        flex: 1;
        padding: 14px;
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: 12px;
        color: var(--light);
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: all 0.25s ease;
      }
      .jarvis-option:hover {
        background: rgba(255, 255, 255, 0.12);
        transform: translateY(-2px);
      }
      .jarvis-option.active {
        background: linear-gradient(
          135deg,
          var(--gray-medium),
          var(--gray-dark)
        );
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }
      [data-theme="light"] .jarvis-option {
        color: var(--dark);
      }

      .jarvis-interface {
        text-align: center;
      }

      .jarvis-wave {
        display: flex;
        justify-content: center;
        gap: 3px;
        height: 40px;
        margin: 0 auto 18px;
        width: 150px;
      }
      .jarvis-wave .bar {
        width: 6px;
        background: var(--gray-medium);
        border-radius: 3px;
        animation: pulseWave 1.2s infinite ease-in-out;
        animation-delay: calc(0.1s * var(--i));
      }
      .jarvis-wave .bar:nth-child(1) {
        --i: 1;
        height: 20%;
      }
      .jarvis-wave .bar:nth-child(2) {
        --i: 2;
        height: 40%;
      }
      .jarvis-wave .bar:nth-child(3) {
        --i: 3;
        height: 60%;
      }
      .jarvis-wave .bar:nth-child(4) {
        --i: 4;
        height: 40%;
      }
      .jarvis-wave .bar:nth-child(5) {
        --i: 5;
        height: 20%;
      }

      @keyframes pulseWave {
        0%,
        100% {
          transform: scaleY(1);
        }
        50% {
          transform: scaleY(1.4);
        }
      }

      .jarvis-status {
        margin-bottom: 16px;
        font-size: 1rem;
        color: var(--gray-medium);
        min-height: 22px;
      }

      .jarvis-controls {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-bottom: 18px;
      }
      .jarvis-btn-primary,
      .jarvis-btn-secondary {
        padding: 10px 20px;
        border-radius: 10px;
        font-weight: 600;
        font-size: 0.9rem;
        cursor: pointer;
        border: none;
        transition: all 0.25s ease;
      }
      .jarvis-btn-primary {
        background: linear-gradient(
          135deg,
          var(--gray-medium),
          var(--gray-dark)
        );
        color: white;
      }
      .jarvis-btn-secondary {
        background: var(--glass-bg);
        color: var(--light);
        border: 1px solid var(--glass-border);
      }
      [data-theme="light"] .jarvis-btn-secondary {
        color: var(--dark);
      }
      .jarvis-btn-primary:hover,
      .jarvis-btn-secondary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }
      .jarvis-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      .jarvis-transcript {
        margin-top: 14px;
        padding: 12px;
        background: var(--glass-bg);
        border-radius: 10px;
        min-height: 40px;
        font-size: 0.9rem;
        color: var(--light);
        border: 1px solid var(--glass-border);
      }
      [data-theme="light"] .jarvis-transcript {
        color: var(--dark);
      }

      /* Chat AI Styles */
      .chat-messages {
        height: 200px;
        overflow-y: auto;
        padding: 10px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        margin-bottom: 15px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .message {
        padding: 8px 12px;
        border-radius: 12px;
        max-width: 80%;
        font-size: 0.9rem;
        line-height: 1.4;
      }
      .message.user {
        background: rgba(76, 175, 80, 0.2);
        align-self: flex-end;
        color: var(--success);
      }
      .message.bot {
        background: rgba(255, 152, 0, 0.2);
        align-self: flex-start;
        color: var(--warning);
      }
      .chat-input {
        display: flex;
        gap: 8px;
      }
      .chat-input input {
        flex: 1;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid var(--glass-border);
        background: var(--glass-bg);
        color: var(--light);
      }
      [data-theme="light"] .chat-input input {
        color: var(--dark);
      }
      .chat-input button {
        padding: 10px 14px;
        background: var(--gray-medium);
        color: var(--dark);
        border: none;
        border-radius: 8px;
        cursor: pointer;
      }
    </style>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // DOM Elements
        const jarvisBtn = document.getElementById("jarvis-btn");
        const modal = document.getElementById("jarvis-modal");
        const closeBtn = document.getElementById("close-jarvis");
        const chatModeBtn = document.getElementById("chat-ai-mode");
        const voiceModeBtn = document.getElementById("voice-ai-mode");
        const chatInterface = document.getElementById("chat-ai-interface");
        const voiceInterface = document.getElementById("voice-ai-interface");
        const chatInput = document.getElementById("chat-input");
        const sendChatBtn = document.getElementById("send-chat");
        const chatMessages = document.getElementById("chat-messages");
        const startListenBtn = document.getElementById("start-listen");
        const stopListenBtn = document.getElementById("stop-listen");
        const statusEl = document.getElementById("jarvis-status");
        const transcriptEl = document.getElementById("jarvis-transcript");

        let recognition;
        let synth = window.speechSynthesis;
        let awaitingDownloadChoice = false;
        let awaitingFileUpload = false;

        // Open Modal
        jarvisBtn.addEventListener("click", () => {
          modal.style.display = "flex";
        });

        // Close Modal
        const closeModal = () => {
          modal.style.display = "none";
          if (recognition) recognition.stop();
          awaitingDownloadChoice = false;
          awaitingFileUpload = false;
        };
        closeBtn.addEventListener("click", closeModal);

        // Switch Modes
        chatModeBtn.addEventListener("click", () => {
          chatModeBtn.classList.add("active");
          voiceModeBtn.classList.remove("active");
          chatInterface.style.display = "block";
          voiceInterface.style.display = "none";
        });
        voiceModeBtn.addEventListener("click", () => {
          voiceModeBtn.classList.add("active");
          chatModeBtn.classList.remove("active");
          voiceInterface.style.display = "block";
          chatInterface.style.display = "none";
        });

        // Chat AI Send
        sendChatBtn.addEventListener("click", sendMessage);
        chatInput.addEventListener("keypress", (e) => {
          if (e.key === "Enter") sendMessage();
        });

        function sendMessage() {
          const msg = chatInput.value.trim();
          if (!msg) return;
          addMessage(msg, "user");
          chatInput.value = "";

          const userMsg = msg.toLowerCase().trim();
          let response =
            "I'm not sure how to help with that. Try asking about fraud detection, file analysis, dashboard, or case management.";

          // --- 100+ Project-Specific Q&A Pairs ---
          const qaPairs = [
            // Basic Chat & Greetings
            {
              q: ["hi", "hello", "hey", "jarvis", "yo", "howdy"],
              a: "Hello! I'm Jarvis, your Fraudshield Pro assistant. How can I help you detect fraud today?",
            },
            {
              q: ["bye", "goodbye", "see you", "exit", "quit", "later"],
              a: "Goodbye! Stay vigilant against fraud. I'm here whenever you need me.",
            },
            {
              q: ["thanks", "thank you", "thx", "cheers", "appreciate it"],
              a: "You're welcome! Protecting your business is what I'm here for.",
            },
            {
              q: ["okay", "ok", "alright", "got it", "sure", "fine"],
              a: "Understood! Let me know if you need further assistance.",
            },
            {
              q: ["yes", "yeah", "yep", "yup", "absolutely"],
              a: "Great! What would you like to do next?",
            },
            {
              q: ["no", "nope", "nah", "not really"],
              a: "No problem! Feel free to ask anything else.",
            },
            {
              q: ["help", "assist", "support", "what can you do"],
              a: "I can help you upload files, analyze transactions, view the dashboard, download reports, or manage fraud cases. Just ask!",
            },
            {
              q: ["who are you", "what is this", "introduce yourself"],
              a: "I'm Jarvis, the AI assistant for Fraudshield Pro â€” your advanced fraud detection and case management system.",
            },
            {
              q: ["how are you", "how's it going"],
              a: "I'm functioning optimally! Ready to help you fight fraud. How can I assist you?",
            },
            {
              q: ["what can you do", "features", "capabilities"],
              a: "I can analyze transaction files, detect fraud, generate reports, navigate to your dashboard, and help manage fraud cases. Try saying 'upload file' or 'show dashboard'!",
            },
            {
              q: ["cool", "nice", "awesome", "sweet"],
              a: "Glad you think so! Let's keep your business safe from fraud.",
            },
            {
              q: ["really", "seriously", "are you sure"],
              a: "Yes, absolutely! Fraudshield Pro uses advanced AI to detect fraud with 99.8% accuracy.",
            },
            {
              q: ["wow", "amazing", "impressive"],
              a: "Thank you! Our team works hard to stay ahead of evolving fraud tactics.",
            },
            {
              q: ["sorry", "my bad", "oops"],
              a: "No worries! Fraud detection is complex â€” that's why I'm here to help.",
            },
            {
              q: ["please", "could you", "would you mind"],
              a: "Of course! Just tell me what you need.",
            },

            // File Upload & Analysis
            {
              q: ["upload file", "upload data", "analyze file", "submit file"],
              a: "Click the 'Upload Data' section on the home page, select your CSV, Excel, or JSON file, and click 'Analyze' to begin fraud detection.",
            },
            {
              q: [
                "supported formats",
                "file types",
                "what files",
                "acceptable formats",
              ],
              a: "I support CSV, Excel (.xlsx, .xls), and JSON files. Maximum size: 10MB.",
            },
            {
              q: [
                "how to analyze",
                "start analysis",
                "detect fraud",
                "run detection",
              ],
              a: "Upload a file using the form, then click 'Analyze'. I'll scan every transaction for anomalies and fraud patterns.",
            },
            {
              q: ["analysis time", "how long", "processing time"],
              a: "Analysis is near-instant! Most files are processed in under 5 seconds.",
            },
            {
              q: ["what is analyzed", "detection criteria", "fraud factors"],
              a: "I check transaction amount, location, device, time, and behavioral patterns to calculate a risk score for each transaction.",
            },
            {
              q: ["sample file", "example data", "template"],
              a: "You can use any standard transaction file with columns like 'id', 'amount', 'type', 'date', 'location', and 'device'.",
            },
            {
              q: ["large file", "big file", "over 10mb"],
              a: "Files must be under 10MB. For larger datasets, please split them into smaller chunks.",
            },
            {
              q: ["empty file", "no data", "blank file"],
              a: "Make sure your file contains valid transaction data with proper headers.",
            },
            {
              q: ["corrupted file", "invalid file", "error reading"],
              a: "Ensure your file isn't corrupted and matches one of our supported formats (CSV, Excel, JSON).",
            },
            {
              q: ["reanalyze", "run again", "redo analysis"],
              a: "Just upload the same file again or a new one to run a fresh analysis.",
            },

            // Dashboard
            {
              q: [
                "open dashboard",
                "show dashboard",
                "go to dashboard",
                "view dashboard",
              ],
              a: "Click the 'View Full Dashboard' button after analysis, or use the top navigation menu.",
            },
            {
              q: ["dashboard metrics", "what is shown", "dashboard info"],
              a: "Your dashboard shows total transactions, fraud detected, amount saved, detection rate, fraud trends, and recent alerts.",
            },
            {
              q: ["refresh dashboard", "update data", "reload"],
              a: "Click the 'Refresh' button on the dashboard to reload the latest data.",
            },
            {
              q: ["fraud trends", "risk chart", "trend analysis"],
              a: "The dashboard includes visual charts for fraud trends over time and fraud distribution by region.",
            },
            {
              q: ["transaction details", "view transactions", "see all"],
              a: "After analysis, scroll down to see high-risk transactions. Click 'View Full Dashboard' for the complete list.",
            },
            {
              q: ["metrics meaning", "what does this mean"],
              a: "Total Transactions = all analyzed, Fraud Detected = confirmed fraud, Amount Saved = estimated prevented losses, Detection Rate = % of suspicious/fraud transactions.",
            },
            {
              q: ["real time", "live data", "current status"],
              a: "Yes! The dashboard updates in real-time as new fraud is detected.",
            },
            {
              q: ["export dashboard", "save dashboard", "download dashboard"],
              a: "Use the 'Export' button on the dashboard to download as PDF, Excel, Word, or CSV.",
            },
            {
              q: ["customize dashboard", "change view", "modify layout"],
              a: "Dashboard customization is coming soon! For now, all key metrics are displayed by default.",
            },
            {
              q: ["historical data", "past reports", "previous analysis"],
              a: "Currently, we show the latest analysis. Historical data storage will be available in future updates.",
            },

            // Download Reports
            {
              q: [
                "download report",
                "export data",
                "save results",
                "get report",
              ],
              a: "After analysis, click the 'Download Report' button and choose your format: PDF, Excel, Word, or CSV.",
            },
            {
              q: ["pdf report", "download pdf", "pdf format"],
              a: "Click 'Download Report' â†’ 'PDF' to get a comprehensive fraud analysis report with executive summary and recommendations.",
            },
            {
              q: ["excel report", "download excel", "xlsx"],
              a: "Choose 'Excel' to download a multi-sheet workbook with summary, transactions, risk analysis, and geographic data.",
            },
            {
              q: ["csv report", "download csv", "comma separated"],
              a: "Select 'CSV' for a raw data export of all analyzed transactions with risk scores and fraud status.",
            },
            {
              q: ["word report", "download word", "docx"],
              a: "Pick 'Word' to generate a formatted document with charts and analysis (converted to PDF for download).",
            },
            {
              q: ["which format", "best format", "recommend format"],
              a: "For executives: PDF. For analysts: Excel. For developers: CSV. For documentation: Word.",
            },
            {
              q: ["report contents", "what's in report"],
              a: "Reports include executive summary, detailed statistics, high-risk transactions, geographic analysis, and actionable recommendations.",
            },
            {
              q: ["custom report", "specific data", "tailored report"],
              a: "Custom reports aren't available yet, but our comprehensive reports include all key fraud detection insights.",
            },
            {
              q: ["email report", "send report", "share report"],
              a: "Reports are downloaded locally. You can email them manually after download.",
            },
            {
              q: ["report size", "file size", "how big"],
              a: "Report size depends on your data. Typical reports are 1-5MB for PDF/Word, smaller for CSV/Excel.",
            },

            // Case Management
            {
              q: ["case management", "fraud cases", "investigate fraud"],
              a: "Go to 'Case Management' in the top menu to review, assign, and resolve fraud cases automatically generated from high-risk transactions.",
            },
            {
              q: ["new case", "create case", "manual case"],
              a: "In Case Management, click 'New Case' to manually create a case for any suspicious transaction.",
            },
            {
              q: ["view case", "case details", "see case"],
              a: "Click the 'eye' icon next to any case in the table to see full details, evidence, timeline, and notes.",
            },
            {
              q: ["assign case", "change assignee", "reassign"],
              a: "Edit a case to assign it to a team member like John, Sarah, Mike, or Emily.",
            },
            {
              q: ["case status", "update status", "change status"],
              a: "Cases can be New, Investigating, Resolved, or Closed. Update status when you make progress.",
            },
            {
              q: ["case priority", "high priority", "urgent"],
              a: "Fraud cases are automatically set to High priority. Suspicious cases are Medium priority.",
            },
            {
              q: ["case evidence", "proof", "documentation"],
              a: "Each case includes transaction records, risk analysis, and system-generated evidence.",
            },
            {
              q: ["add note", "comment", "update case"],
              a: "In the case details view, use the 'Add Note' section to document your investigation progress.",
            },
            {
              q: ["close case", "resolve case", "finish case"],
              a: "Change the case status to 'Resolved' or 'Closed' when your investigation is complete.",
            },
            {
              q: ["case filters", "search cases", "find case"],
              a: "Use the filters at the top of Case Management to search by status, priority, assignee, or case ID.",
            },

            // Security & Accuracy
            {
              q: ["accuracy", "how accurate", "detection rate"],
              a: "Fraudshield Pro has a 99.8% detection accuracy based on real-world transaction data and machine learning models.",
            },
            {
              q: ["security", "is it secure", "data protection"],
              a: "All data is encrypted in transit and at rest. We comply with financial industry security standards.",
            },
            {
              q: ["privacy", "data storage", "do you save data"],
              a: "Your uploaded files are processed in memory and not stored permanently. Reports are generated on-demand.",
            },
            {
              q: ["real-time alerts", "notifications", "fraud warnings"],
              a: "Yes! You'll see real-time fraud alerts in the top-right corner when new high-risk transactions are detected.",
            },
            {
              q: ["machine learning", "how it works", "ai model"],
              a: "Our AI learns from millions of transactions to identify evolving fraud patterns. It improves with every analysis.",
            },
            {
              q: ["false positives", "wrong detection", "legitimate flagged"],
              a: "Our system minimizes false positives through multi-factor analysis. Suspicious transactions are flagged for review, not automatically blocked.",
            },
            {
              q: ["compliance", "regulations", "standards"],
              a: "Fraudshield Pro complies with PCI DSS, GDPR, and other financial industry regulations.",
            },
            {
              q: ["data encryption", "encryption method"],
              a: "We use AES-256 encryption for data at rest and TLS 1.3 for data in transit.",
            },
            {
              q: ["audit trail", "activity log", "tracking"],
              a: "All case management activities are logged with timestamps and user information for audit purposes.",
            },
            {
              q: ["backup", "data recovery", "disaster recovery"],
              a: "Our infrastructure includes automated backups and disaster recovery protocols.",
            },

            // Troubleshooting
            {
              q: ["error uploading", "file not working", "upload failed"],
              a: "Ensure your file is under 10MB and in CSV, Excel, or JSON format. Check that it contains valid transaction data.",
            },
            {
              q: ["no results", "empty analysis", "nothing shown"],
              a: "If no results appear, your file may be empty or lack required fields like 'amount' or 'date'. Try our sample data format.",
            },
            {
              q: ["login required", "why login", "authentication"],
              a: "Login is required to access advanced features like dashboard, case management, and report downloads for security.",
            },
            {
              q: ["reset analysis", "clear data", "start over"],
              a: "Refresh the page to start a new analysis. Your previous data isn't saved after logout.",
            },
            {
              q: ["browser support", "compatibility", "works on"],
              a: "Fraudshield Pro works best on Chrome, Firefox, Edge, and Safari (latest versions).",
            },
            {
              q: ["slow performance", "lagging", "taking time"],
              a: "Analysis is usually instant. If it's slow, check your internet connection or try a smaller file.",
            },
            {
              q: ["chart not loading", "visualization issue"],
              a: "Charts require JavaScript. Ensure it's enabled in your browser.",
            },
            {
              q: ["download not working", "export failed"],
              a: "Make sure you're logged in and have analyzed data. If issues persist, try a different browser.",
            },
            {
              q: ["mobile view", "phone support", "tablet"],
              a: "The platform is fully responsive and works on all mobile devices.",
            },
            {
              q: ["contact support", "help desk", "technical help"],
              a: "Contact support at info@fraudshieldpro.com or use the Contact section in the footer.",
            },

            // Project-Specific Terms
            {
              q: ["legitimate", "suspicious", "fraud", "risk levels"],
              a: "Transactions are classified as: Legitimate (low risk), Suspicious (medium risk), or Fraud (high risk) based on their risk score.",
            },
            {
              q: ["risk score", "what is risk", "score meaning"],
              a: "Each transaction gets a 0-100% risk score. â‰¥80% = Fraud, 60-79% = Suspicious, <60% = Legitimate.",
            },
            {
              q: ["amount saved", "fraud prevented", "loss prevention"],
              a: "This estimates how much money you've saved by detecting fraud early (assumes 95% of fraud amount is recoverable).",
            },
            {
              q: ["detection rate", "success rate", "effectiveness"],
              a: "This shows the percentage of transactions flagged as suspicious or fraudulent out of your total analyzed.",
            },
            {
              q: ["fraud types", "categories", "fraud classification"],
              a: "We detect Credit Card Fraud, Wire Transfer Fraud, Online Payment Fraud, and Mobile Payment Fraud.",
            },
            {
              q: ["transaction id", "unique identifier"],
              a: "Each transaction should have a unique ID for tracking and case management.",
            },
            {
              q: ["geographic analysis", "location data", "regional fraud"],
              a: "We analyze transaction locations to identify high-risk regions and patterns.",
            },
            {
              q: ["device fingerprinting", "device analysis"],
              a: "We track device types and patterns to detect unusual behavior.",
            },
            {
              q: ["time analysis", "temporal patterns"],
              a: "Transactions outside normal business hours are flagged for additional review.",
            },
            {
              q: ["behavioral analysis", "user patterns"],
              a: "We compare transactions against historical user behavior to detect anomalies.",
            },

            // Team & Assignees
            {
              q: ["john", "john smith", "assign to john"],
              a: "John Smith is our senior fraud analyst specializing in credit card fraud cases.",
            },
            {
              q: ["sarah", "sarah johnson", "assign to sarah"],
              a: "Sarah Johnson handles wire transfer and international fraud cases.",
            },
            {
              q: ["mike", "mike davis", "assign to mike"],
              a: "Mike Davis focuses on online payment and e-commerce fraud investigations.",
            },
            {
              q: ["emily", "emily wilson", "assign to emily"],
              a: "Emily Wilson manages mobile payment fraud and emerging threat analysis.",
            },
            {
              q: ["team members", "analysts", "who works here"],
              a: "Our fraud team includes John, Sarah, Mike, and Emily â€” each specializing in different fraud types.",
            },
            {
              q: ["unassigned", "no assignee", "available cases"],
              a: "Unassigned cases are available for any team member to pick up.",
            },
            {
              q: ["workload", "case load", "how many cases"],
              a: "Each analyst typically handles 15-20 active cases at a time.",
            },
            {
              q: ["escalation", "urgent cases", "priority handling"],
              a: "High-priority fraud cases are escalated immediately to senior analysts.",
            },
            {
              q: ["collaboration", "team notes", "shared info"],
              a: "All case notes and evidence are shared across the team for collaboration.",
            },
            {
              q: ["expertise", "specialization", "skills"],
              a: "Our team has over 50 years combined experience in financial fraud prevention.",
            },

            // Business Impact
            {
              q: ["roi", "return on investment", "cost savings"],
              a: "Clients typically see 5-10x ROI through prevented fraud losses and reduced manual review time.",
            },
            {
              q: ["time saved", "efficiency", "automation"],
              a: "Fraudshield Pro reduces fraud investigation time by 80% through automated detection and case creation.",
            },
            {
              q: ["scalability", "handles volume", "large business"],
              a: "Our system scales to handle millions of transactions daily for enterprise clients.",
            },
            {
              q: ["integration", "api", "connect to systems"],
              a: "We offer REST APIs for integration with your existing payment and CRM systems.",
            },
            {
              q: ["customization", "tailored solution", "specific needs"],
              a: "Enterprise plans include custom rule configuration and dedicated support.",
            },
            {
              q: ["training", "onboarding", "learn to use"],
              a: "We provide comprehensive onboarding and training for all new clients.",
            },
            {
              q: ["updates", "new features", "improvements"],
              a: "The platform receives monthly updates with new fraud detection capabilities.",
            },
            {
              q: ["pricing", "cost", "subscription"],
              a: "Pricing is based on transaction volume. Contact sales for a custom quote.",
            },
            {
              q: ["trial", "demo", "test drive"],
              a: "We offer a 14-day free trial with full access to all features.",
            },
            {
              q: ["testimonial", "reviews", "client feedback"],
              a: "95% of clients report significant reduction in fraud losses within the first month.",
            },
          ];

          // Match user message to Q&A
          for (const pair of qaPairs) {
            if (pair.q.some((keyword) => userMsg.includes(keyword))) {
              response = pair.a;
              break;
            }
          }

          // Add bot response after short delay
          setTimeout(() => {
            addMessage(response, "bot");
          }, 500);
        }

        function addMessage(text, sender) {
          const msgDiv = document.createElement("div");
          msgDiv.classList.add("message", sender);
          msgDiv.textContent = text;
          chatMessages.appendChild(msgDiv);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Initialize SpeechRecognition
        if (
          "webkitSpeechRecognition" in window ||
          "SpeechRecognition" in window
        ) {
          const SpeechRecognition =
            window.SpeechRecognition || window.webkitSpeechRecognition;
          recognition = new SpeechRecognition();
          recognition.continuous = false;
          recognition.interimResults = false;
          recognition.lang = "en-US";

          recognition.onstart = () => {
            statusEl.textContent = "Listening...";
            startListenBtn.disabled = true;
            stopListenBtn.disabled = false;
          };

          recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            transcriptEl.textContent = `"${transcript}"`;
            handleVoiceCommand(transcript.toLowerCase());
          };

          recognition.onerror = (event) => {
            statusEl.textContent = "Error. Try again.";
            speak("Sorry, I had trouble hearing you.");
            resetListening();
          };

          recognition.onend = () => {
            if (!awaitingDownloadChoice && !awaitingFileUpload)
              resetListening();
          };
        } else {
          statusEl.textContent = "Speech not supported.";
          startListenBtn.disabled = true;
        }

        function resetListening() {
          startListenBtn.disabled = false;
          stopListenBtn.disabled = true;
          if (!awaitingDownloadChoice && !awaitingFileUpload)
            statusEl.textContent = "Ready for command.";
        }

        // Start/Stop
        startListenBtn.addEventListener("click", () => {
          if (recognition) recognition.start();
        });
        stopListenBtn.addEventListener("click", () => {
          if (recognition) recognition.stop();
          awaitingDownloadChoice = false;
          awaitingFileUpload = false;
          resetListening();
        });

        // Speak
        function speak(text) {
          if (synth.speaking) synth.cancel();
          const utter = new SpeechSynthesisUtterance(text);
          utter.rate = 1;
          utter.pitch = 1;
          utter.volume = 1;
          utter.lang = "en-US";
          synth.speak(utter);
        }

        // Handle Commands
        function handleVoiceCommand(cmd) {
          // Handle download choice
          if (awaitingDownloadChoice) {
            if (cmd.includes("pdf")) {
              speak("Downloading PDF report.");
              document.getElementById("download-btn").click();
              const pdfOption = document.querySelector(
                '.download-option[data-format="pdf"]'
              );
              if (pdfOption) pdfOption.click();
              awaitingDownloadChoice = false;
            } else if (cmd.includes("excel")) {
              speak("Downloading Excel report.");
              document.getElementById("download-btn").click();
              const excelOption = document.querySelector(
                '.download-option[data-format="excel"]'
              );
              if (excelOption) excelOption.click();
              awaitingDownloadChoice = false;
            } else if (cmd.includes("word")) {
              speak("Downloading Word report.");
              document.getElementById("download-btn").click();
              const wordOption = document.querySelector(
                '.download-option[data-format="word"]'
              );
              if (wordOption) wordOption.click();
              awaitingDownloadChoice = false;
            } else if (cmd.includes("csv")) {
              speak("Downloading CSV report.");
              document.getElementById("download-btn").click();
              const csvOption = document.querySelector(
                '.download-option[data-format="csv"]'
              );
              if (csvOption) csvOption.click();
              awaitingDownloadChoice = false;
            } else {
              speak("Please say PDF, Excel, Word, or CSV.");
              return;
            }
            resetListening();
            return;
          }

          // Handle file upload trigger
          if (awaitingFileUpload) {
            // This state is used only to prevent other commands during upload
            return;
          }

          // Main command handling
          if (
            cmd.includes("open") &&
            (cmd.includes("browser") || cmd.includes("upload"))
          ) {
            speak("Okay, I will open upload data automatically.");
            // Trigger file input click
            const fileInput = document.getElementById("file-upload");
            if (fileInput) {
              fileInput.click();
              awaitingFileUpload = true;
              statusEl.textContent = "Please select a file...";

              // Listen for file selection
              const handleFileSelect = () => {
                if (fileInput.files.length > 0) {
                  const file = fileInput.files[0];
                  // Submit the form to analyze
                  const uploadForm = document.getElementById("upload-form");
                  if (uploadForm) {
                    uploadForm.dispatchEvent(
                      new Event("submit", { cancelable: true, bubbles: true })
                    );
                    speak(
                      "File uploaded and analysis started. Results will appear shortly."
                    );
                  }
                  awaitingFileUpload = false;
                  fileInput.removeEventListener("change", handleFileSelect);
                } else {
                  speak("No file selected. Please try again.");
                  awaitingFileUpload = false;
                  fileInput.removeEventListener("change", handleFileSelect);
                }
                resetListening();
              };
              fileInput.addEventListener("change", handleFileSelect);
            } else {
              speak("Upload section not found.");
              awaitingFileUpload = false;
            }
          } else if (cmd.includes("download") && cmd.includes("file")) {
            speak("Which format would you like? PDF, Excel, Word, or CSV?");
            document.getElementById("download-btn").click();
            awaitingDownloadChoice = true;
            statusEl.textContent = "Say: PDF, Excel, Word, or CSV";
          } else if (cmd.includes("hi jarvis") || cmd.includes("hello")) {
            speak("Hello! How can I help you?");
          } else {
            speak(
              "Command not recognized. Try: open browser, or download the file."
            );
          }
        }
      });
      // ===== 3D NETWORK VISUALIZATION ENGINE =====
let scene, camera, renderer, controls, raycaster, mouse;
let nodes = [], links = [];
let nodeMeshes = new Map();
let hoveredNode = null;

function init3DNetwork() {
  const container = document.getElementById('3d-network-container');
  if (!container || !uploadedData) return;

  // Clear previous scene if exists
  if (renderer) renderer.dispose();
  while (container.firstChild) {
    container.removeChild(container.firstChild);
  }

  // Scene setup
  scene = new THREE.Scene();
  scene.background = new THREE.Color(appSettings.theme === 'light' ? 0xf0f0f0 : 0x0a0a0a);
  scene.fog = new THREE.Fog(appSettings.theme === 'light' ? 0xf0f0f0 : 0x0a0a0a, 200, 400);

  // Camera
  camera = new THREE.PerspectiveCamera(60, container.clientWidth / container.clientHeight, 1, 1000);
  camera.position.set(0, 0, 300);

  // Renderer
  renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
  renderer.setSize(container.clientWidth, container.clientHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  container.appendChild(renderer.domElement);

  // Controls
  controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  controls.dampingFactor = 0.05;

  // Lighting
  const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
  scene.add(ambientLight);
  const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
  directionalLight.position.set(100, 100, 100);
  scene.add(directionalLight);

  // Raycaster for interaction
  raycaster = new THREE.Raycaster();
  mouse = new THREE.Vector2();

  // Build graph
  buildNetworkGraph();

  // Handle resize
  window.addEventListener('resize', onWindowResize3D);

  // Handle mouse move for hover
  container.addEventListener('mousemove', onMouseMove3D);
  container.addEventListener('click', onClick3D);

  // Start animation loop
  animate3D();
}

function onWindowResize3D() {
  if (!renderer || !camera) return;
  const container = renderer.domElement.parentElement;
  camera.aspect = container.clientWidth / container.clientHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(container.clientWidth, container.clientHeight);
}

function onMouseMove3D(event) {
  const container = event.currentTarget;
  const rect = container.getBoundingClientRect();
  mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
  mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

  raycaster.setFromCamera(mouse, camera);
  const intersects = raycaster.intersectObjects(Array.from(nodeMeshes.values()));

  const tooltip = document.getElementById('three-tooltip');
  if (intersects.length > 0) {
    const obj = intersects[0].object;
    const nodeId = obj.userData.id;
    const transaction = uploadedData.find(t => t.id === nodeId);
    if (transaction) {
      tooltip.style.display = 'block';
      tooltip.innerHTML = `
        <strong>${transaction.id}</strong><br/>
        Amount: $${transaction.amount.toFixed(2)}<br/>
        Type: ${transaction.type}<br/>
        Risk: ${transaction.riskScore}%<br/>
        Status: ${transaction.status}
      `;
      tooltip.style.left = (event.clientX + 10) + 'px';
      tooltip.style.top = (event.clientY + 10) + 'px';
    }
    if (hoveredNode !== obj) {
      if (hoveredNode) hoveredNode.scale.set(1, 1, 1);
      obj.scale.set(1.5, 1.5, 1.5);
      hoveredNode = obj;
    }
  } else {
    tooltip.style.display = 'none';
    if (hoveredNode) {
      hoveredNode.scale.set(1, 1, 1);
      hoveredNode = null;
    }
  }
}

function onClick3D(event) {
  const container = event.currentTarget;
  const rect = container.getBoundingClientRect();
  mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
  mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

  raycaster.setFromCamera(mouse, camera);
  const intersects = raycaster.intersectObjects(Array.from(nodeMeshes.values()));
  if (intersects.length > 0) {
    const obj = intersects[0].object;
    const nodeId = obj.userData.id;
    reviewTransaction(nodeId); // Reuse existing function
  }
}

function buildNetworkGraph() {
  // Clear old data
  nodes = [];
  links = [];
  nodeMeshes.clear();
  scene.remove(...scene.children.filter(child => child.isMesh));

  if (!uploadedData || uploadedData.length === 0) return;

  // Create nodes
  const nodeGroup = new THREE.Group();
  uploadedData.forEach((tx, i) => {
    const geometry = new THREE.SphereGeometry(5, 16, 16);
    let material;
    if (tx.status === 'fraud') material = new THREE.MeshStandardMaterial({ color: 0xf44336 });
    else if (tx.status === 'suspicious') material = new THREE.MeshStandardMaterial({ color: 0xff9800 });
    else material = new THREE.MeshStandardMaterial({ color: 0x4caf50 });

    const mesh = new THREE.Mesh(geometry, material);
    // Position in 3D space (simple grid for now; could use force layout)
    const angle = (i / uploadedData.length) * Math.PI * 2;
    const radius = 80 + (tx.amount / 1000); // Scale by amount
    mesh.position.x = Math.cos(angle) * radius;
    mesh.position.z = Math.sin(angle) * radius;
    mesh.position.y = (tx.riskScore - 50) * 2; // Height = risk

    mesh.userData = { id: tx.id };
    mesh.castShadow = true;
    mesh.receiveShadow = true;
    nodeMeshes.set(tx.id, mesh);
    nodeGroup.add(mesh);
  });

  // Optional: Add links between related transactions (same location/device)
  const linkGroup = new THREE.Group();
  for (let i = 0; i < uploadedData.length; i++) {
    for (let j = i + 1; j < uploadedData.length; j++) {
      const a = uploadedData[i];
      const b = uploadedData[j];
      // Simple relation: same location or device
      if (a.location === b.location || a.device === b.device) {
        const material = new THREE.LineBasicMaterial({
          color: appSettings.theme === 'light' ? 0x666666 : 0xaaaaaa,
          transparent: true,
          opacity: 0.3
        });
        const points = [
          nodeMeshes.get(a.id).position.clone(),
          nodeMeshes.get(b.id).position.clone()
        ];
        const geometry = new THREE.BufferGeometry().setFromPoints(points);
        const line = new THREE.Line(geometry, material);
        linkGroup.add(line);
      }
    }
  }

  scene.add(nodeGroup);
  scene.add(linkGroup);
}

function animate3D() {
  requestAnimationFrame(animate3D);
  if (controls) controls.update();
  if (renderer && scene && camera) renderer.render(scene, camera);
}

// Show 3D section when nav link clicked
document.querySelectorAll('a[href="#network-3d"]').forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    if (!uploadedData) {
      showNotification("Please upload data first to view the 3D network.");
      return;
    }
    document.querySelectorAll('.card').forEach(card => {
      if (card.id === 'network-3d') {
        card.style.display = 'block';
        setTimeout(() => init3DNetwork(), 100);
      } else {
        card.style.display = 'none';
      }
    });
    closeMobileMenuFunc();
  });
});

// Rebuild 3D view when theme changes
const originalHandleSaveSettings = handleSaveSettings;
handleSaveSettings = function() {
  originalHandleSaveSettings();
  if (document.getElementById('network-3d').style.display === 'block') {
    setTimeout(() => init3DNetwork(), 100);
  }
};
    </script>
    <div class="three-tooltip" id="three-tooltip"></div>
  </body>
</html>
